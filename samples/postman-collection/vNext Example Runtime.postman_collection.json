{
	"info": {
		"_postman_id": "f503af8a-0a1b-4849-9330-e972cca00a10",
		"name": "vNext Example Runtime",
		"description": "Complete collection for testing Workflow SubFlows, SubProcesses and Main Flow integrations based on examples/sub-flows HTTP files",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "316535"
	},
	"item": [
		{
			"name": "e-commerce",
			"item": [
				{
					"name": "Definitions",
					"item": [
						{
							"name": "Flows",
							"item": [
								{
									"name": "1 - Start - e-Commerce",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"ecommerce\",\n  \"flow\": \"sys-flows\",\n  \"domain\": \"{{domain}}\",\n  \"version\": \"1.0.0\",\n  \"tags\": [\n    \"ecommerce\",\n    \"shopping\",\n    \"dummyjson\",\n    \"demo\"\n  ],\n  \"attributes\": {\n    \"type\": \"F\",\n    \"timeout\": null,\n    \"labels\": [\n      {\n        \"language\": \"en-US\",\n        \"label\": \"E-commerce Shopping Workflow\"\n      },\n      {\n        \"language\": \"tr-TR\",\n        \"label\": \"E-ticaret Alışveriş İş Akışı\"\n      }\n    ],\n    \"functions\": [],\n    \"features\": [],\n    \"extensions\": [],\n    \"sharedTransitions\": [],\n    \"startTransition\": {\n      \"key\": \"start-shopping\",\n      \"target\": \"authentication\",\n      \"triggerType\": 0,\n      \"versionStrategy\": \"Minor\",\n      \"labels\": [\n        {\n          \"language\": \"en-US\",\n          \"label\": \"Start Shopping\"\n        },\n        {\n          \"language\": \"tr-TR\",\n          \"label\": \"Alışverişe Başla\"\n        }\n      ],\n      \"schema\": null,\n      \"rule\": null,\n      \"timer\": null,\n      \"view\": null,\n      \"onExecutionTasks\": []\n    },\n    \"states\": [\n      {\n        \"key\": \"authentication\",\n        \"stateType\": 1,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"User Authentication\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Kullanıcı Kimlik Doğrulama\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"auth-login\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/AuthLoginMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKcHVibGljIGNsYXNzIEF1dGhMb2dpbk1hcHBpbmcgOiBJTWFwcGluZwp7CiAgICBwdWJsaWMgVGFzazxTY3JpcHRSZXNwb25zZT4gSW5wdXRIYW5kbGVyKFdvcmtmbG93VGFzayB0YXNrLCBTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgdmFyIGh0dHBUYXNrID0gdGFzayBhcyBIdHRwVGFzazsKICAgICAgICBodHRwVGFzay5TZXRCb2R5KGNvbnRleHQuQm9keSk7CiAgICAgICAgdmFyIGhlYWRlcnMgPSBuZXcgRGljdGlvbmFyeTxzdHJpbmcsIHN0cmluZz8+CiAgICAgICAgewogICAgICAgICAgICBbIlgtUmVxdWVzdC1JZCJdID0gY29udGV4dC5IZWFkZXJzWyJ4LXJlcXVlc3QtaWQiXSwKICAgICAgICAgICAgWyJYLURldmljZS1JZCJdID0gY29udGV4dC5IZWFkZXJzWyJ4LWRldmljZS1pZCJdCiAgICAgICAgfTsKICAgICAgICBodHRwVGFzay5TZXRIZWFkZXJzKGhlYWRlcnMpOwogICAgICAgIHJldHVybiBUYXNrLkZyb21SZXN1bHQobmV3IFNjcmlwdFJlc3BvbnNlCiAgICAgICAgewogICAgICAgICAgICBEYXRhID0gY29udGV4dC5JbnN0YW5jZS5EYXRhLAogICAgICAgICAgICBIZWFkZXJzID0gbnVsbAogICAgICAgIH0pOwogICAgfQoKICAgIHB1YmxpYyBhc3luYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBPdXRwdXRIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICAvLyBTdG9yZSBhdXRoZW50aWNhdGlvbiB0b2tlbiBmb3IgZnV0dXJlIHJlcXVlc3RzCiAgICAgICAgdmFyIHJlc3BvbnNlID0gbmV3IFNjcmlwdFJlc3BvbnNlKCk7CiAgICAgICAgdmFyIHN0YXR1c0NvZGUgPSBjb250ZXh0LkJvZHkuc3RhdHVzQ29kZSA/PyA1MDA7CgogICAgICAgIGlmIChzdGF0dXNDb2RlID09IDIwMCkKICAgICAgICB7CiAgICAgICAgICAgIHJlc3BvbnNlLkRhdGEgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbG9naW4gPSBuZXcKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBjdXJyZW50TG9naW4gPSBjb250ZXh0LkJvZHkuZGF0YQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChzdGF0dXNDb2RlID09IDQwNCkKICAgICAgICB7CiAgICAgICAgICAgIC8vIE5vdCBmb3VuZCAtIGhhbmRsZSBzcGVjaWZpY2FsbHkKICAgICAgICAgICAgcmVzcG9uc2UuRGF0YSA9IG5ldwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBsb2dpbiA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBlcnJvciA9ICJSZXNvdXJjZSBub3QgZm91bmQiLAogICAgICAgICAgICAgICAgICAgIHNob3VsZFJldHJ5ID0gZmFsc2UKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgLy8gU2VydmVyIGVycm9yIC0gbWlnaHQgd2FudCB0byByZXRyeQogICAgICAgICAgICByZXNwb25zZS5EYXRhID0gbmV3CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGxvZ2luID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGVycm9yID0gIlNlcnZlciBlcnJvciBvY2N1cnJlZCIsCiAgICAgICAgICAgICAgICAgICAgc2hvdWxkUmV0cnkgPSB0cnVlLAogICAgICAgICAgICAgICAgICAgIHJldHJ5QWZ0ZXIgPSAzMCAvLyBzZWNvbmRzCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmVzcG9uc2U7CiAgICB9Cn0=\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"auth-success\",\n            \"target\": \"product-browsing\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Authentication Successful\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Kimlik Doğrulama Başarılı\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/AuthSuccessRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBBdXRoU3VjY2Vzc1J1bGUgOiBJQ29uZGl0aW9uTWFwcGluZwp7CiAgICBwdWJsaWMgYXN5bmMgVGFzazxib29sPiBIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICByZXR1cm4gY29udGV4dC5JbnN0YW5jZS5EYXRhLmxvZ2luLnN1Y2Nlc3MgPT0gdHJ1ZTsKICAgIH0KfQ==\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"auth-failed\",\n            \"target\": \"authentication\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Authentication Failed - Retry\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Kimlik Doğrulama Başarısız - Tekrar Dene\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/AuthFailedRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBBdXRoRmFpbGVkUnVsZSA6IElDb25kaXRpb25NYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHJldHVybiBjb250ZXh0Lkluc3RhbmNlLkRhdGEubG9naW4uc3VjY2VzcyA9PSBmYWxzZTsKICAgIH0KfQ==\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"product-browsing\",\n        \"stateType\": 2,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Product Browsing\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Ürün Gezinme\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"select-product\",\n            \"target\": \"cart-management\",\n            \"triggerType\": 0,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Select Product\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Ürün Seç\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": null,\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"continue-browsing\",\n            \"target\": \"product-browsing\",\n            \"triggerType\": 0,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Continue Browsing\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Gezinmeye Devam Et\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": null,\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"cart-management\",\n        \"stateType\": 2,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Cart Management\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Sepet Yönetimi\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"add-to-cart\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/AddToCartMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtOwp1c2luZyBTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYzsKdXNpbmcgU3lzdGVtLkxpbnE7CnVzaW5nIFN5c3RlbS5UaHJlYWRpbmcuVGFza3M7CnVzaW5nIEJCVC5Xb3JrZmxvdy5TY3JpcHRpbmc7CnVzaW5nIEJCVC5Xb3JrZmxvdy5EZWZpbml0aW9uczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZy5GdW5jdGlvbnM7CgpwdWJsaWMgY2xhc3MgQWRkVG9DYXJ0TWFwcGluZyA6IFNjcmlwdEJhc2UsIElNYXBwaW5nCnsKICAgIHB1YmxpYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBJbnB1dEhhbmRsZXIoV29ya2Zsb3dUYXNrIHRhc2ssIFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICB2YXIgaHR0cFRhc2sgPSB0YXNrIGFzIEh0dHBUYXNrOwogICAgICAgIGlmIChodHRwVGFzayA9PSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFeGNlcHRpb24oIlRhc2sgbXVzdCBiZSBvZiB0eXBlIEh0dHBUYXNrIik7CiAgICAgICAgICAgIAogICAgICAgIHZhciBoZWFkZXJzID0gbmV3IERpY3Rpb25hcnk8c3RyaW5nLCBzdHJpbmc/PgogICAgICAgIHsKICAgICAgICAgICAgWyJBdXRob3JpemF0aW9uIl0gPSAkIkJlcmVhciB7Y29udGV4dC5JbnN0YW5jZS5EYXRhPy5sb2dpbj8uY3VycmVudExvZ2luPy5hY2Nlc3NUb2tlbn0iCiAgICAgICAgfTsKICAgICAgICBodHRwVGFzay5TZXRIZWFkZXJzKGhlYWRlcnMpOwogICAgICAgIAogICAgICAgIC8vIENoZWNrIGlmIGNhcnQgYWxyZWFkeSBleGlzdHMgaW4gY29udGV4dC5JbnN0YW5jZS5EYXRhLCBpZiBub3QgY3JlYXRlIGl0CiAgICAgICAgTGlzdDxQcm9kdWN0RHRvPiBleGlzdGluZ1Byb2R1Y3RzID0gbmV3IExpc3Q8UHJvZHVjdER0bz4oKTsKICAgICAgICB2YXIgaXNBZGRkZWQgPSB0cnVlOwogICAgICAgIGlmIChIYXNQcm9wZXJ0eShjb250ZXh0Lkluc3RhbmNlLkRhdGEsICJjYXJkIikpCiAgICAgICAgewogICAgICAgICAgICB2YXIgY2FyZERhdGEgPSBHZXRQcm9wZXJ0eVZhbHVlKGNvbnRleHQuSW5zdGFuY2UuRGF0YSwgImNhcmQiKTsKICAgICAgICAgICAgaWYgKEhhc1Byb3BlcnR5KGNhcmREYXRhLCAicHJvZHVjdHMiKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaXNBZGRkZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIC8vIENvbnZlcnQgZXhpc3RpbmcgcHJvZHVjdHMgdG8gUHJvZHVjdER0byBsaXN0CiAgICAgICAgICAgICAgICB2YXIgcHJvZHVjdHNEYXRhID0gR2V0UHJvcGVydHlWYWx1ZShjYXJkRGF0YSwgInByb2R1Y3RzIik7CiAgICAgICAgICAgICAgICBpZiAocHJvZHVjdHNEYXRhIGlzIElFbnVtZXJhYmxlPGR5bmFtaWM+IHByb2R1Y3RzKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKHZhciBwcm9kdWN0IGluIHByb2R1Y3RzKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdQcm9kdWN0cy5BZGQobmV3IFByb2R1Y3REdG8oKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IENvbnZlcnQuVG9JbnQzMihwcm9kdWN0Py5pZCA/PyAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5ID0gQ29udmVydC5Ub0ludDMyKHByb2R1Y3Q/LnF1YW50aXR5ID8/IDEpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGlzQWRkZGVkKQogICAgICAgIHsKICAgICAgICAgICAgaHR0cFRhc2suVXJsID0gaHR0cFRhc2suVXJsLlJlcGxhY2UoIntDQVJEX0FERF9PUl9VUERBVEVfUEFUSH0iLCAiY2FydHMvYWRkIik7CiAgICAgICAgICAgIGh0dHBUYXNrLk1ldGhvZCA9ICJQT1NUIjsKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgLy8gV0FSTjogSXQgd2lsbCBzaW11bGF0ZSBhIFBPU1QgcmVxdWVzdCBhbmQgd2lsbCByZXR1cm4gdGhlIG5ldyBjcmVhdGVkIGNhcnQgd2l0aCBhIG5ldyBpZCAKICAgICAgICAgICAgLy8gaHR0cFRhc2suVXJsID0gaHR0cFRhc2suVXJsLlJlcGxhY2UoIntDQVJEX0FERF9PUl9VUERBVEVfUEFUSH0iLCAkImNhcnRzL3tjb250ZXh0Lkluc3RhbmNlLkRhdGE/LmNhcmQ/LmlkfSIpOwogICAgICAgICAgICBodHRwVGFzay5VcmwgPSBodHRwVGFzay5VcmwuUmVwbGFjZSgie0NBUkRfQUREX09SX1VQREFURV9QQVRIfSIsICQiY2FydHMvMTAiKTsKICAgICAgICAgICAgaHR0cFRhc2suTWV0aG9kID0gIlBVVCI7ICAgIAogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBBZGQgdGhlIG5ldyBwcm9kdWN0IHRvIHRoZSBjYXJ0CiAgICAgICAgdmFyIG5ld1Byb2R1Y3QgPSBuZXcgUHJvZHVjdER0bygpCiAgICAgICAgewogICAgICAgICAgICBpZCA9IENvbnZlcnQuVG9JbnQzMihjb250ZXh0LkJvZHk/LmlkID8/IDApLAogICAgICAgICAgICBxdWFudGl0eSA9IDEKICAgICAgICB9OwogICAgICAgIAogICAgICAgIC8vIENoZWNrIGlmIHByb2R1Y3QgYWxyZWFkeSBleGlzdHMgaW4gY2FydCwgaWYgc28gdXBkYXRlIHF1YW50aXR5CiAgICAgICAgdmFyIGV4aXN0aW5nUHJvZHVjdCA9IGV4aXN0aW5nUHJvZHVjdHMuRmlyc3RPckRlZmF1bHQocCA9PiBwLmlkID09IG5ld1Byb2R1Y3QuaWQpOwogICAgICAgIGlmIChleGlzdGluZ1Byb2R1Y3QgIT0gbnVsbCkKICAgICAgICB7CiAgICAgICAgICAgIGV4aXN0aW5nUHJvZHVjdC5xdWFudGl0eSArPSBuZXdQcm9kdWN0LnF1YW50aXR5OwogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICBleGlzdGluZ1Byb2R1Y3RzLkFkZChuZXdQcm9kdWN0KTsKICAgICAgICB9CgogICAgICAgIHZhciBjYXJkUGF5bG9hZCA9IG5ldwogICAgICAgIHsKICAgICAgICAgICAgdXNlcklkID0gQ29udmVydC5Ub0ludDMyKGNvbnRleHQuSW5zdGFuY2UuRGF0YT8ubG9naW4/LmN1cnJlbnRMb2dpbj8uaWQgPz8gMCksCiAgICAgICAgICAgIG1lcmdlID0gdHJ1ZSwKICAgICAgICAgICAgcHJvZHVjdHMgPSBleGlzdGluZ1Byb2R1Y3RzCiAgICAgICAgfTsKCiAgICAgICAgaHR0cFRhc2suU2V0Qm9keShjYXJkUGF5bG9hZCk7CgogICAgICAgIC8vIFN0b3JlIHRoZSB1cGRhdGVkIGNhcnQgaW4gY29udGV4dC5JbnN0YW5jZS5EYXRhIGZvciBwZXJzaXN0ZW5jZQogICAgICAgIHZhciB1cGRhdGVkRGF0YSA9IGNvbnRleHQuSW5zdGFuY2UuRGF0YTsKICAgICAgICBpZiAodXBkYXRlZERhdGEgIT0gbnVsbCkKICAgICAgICB7CiAgICAgICAgICAgIHVwZGF0ZWREYXRhLmNhcmQgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdXNlcklkID0gQ29udmVydC5Ub0ludDMyKGNvbnRleHQuSW5zdGFuY2UuRGF0YT8ubG9naW4/LmN1cnJlbnRMb2dpbj8uaWQgPz8gMCksCiAgICAgICAgICAgICAgICBwcm9kdWN0cyA9IGV4aXN0aW5nUHJvZHVjdHMKICAgICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBUYXNrLkZyb21SZXN1bHQobmV3IFNjcmlwdFJlc3BvbnNlCiAgICAgICAgewogICAgICAgICAgICBEYXRhID0gdXBkYXRlZERhdGEsCiAgICAgICAgICAgIEhlYWRlcnMgPSBudWxsCiAgICAgICAgfSk7CiAgICB9CgogICAgcHVibGljIFRhc2s8U2NyaXB0UmVzcG9uc2U+IE91dHB1dEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIC8vIFN0b3JlIGF1dGhlbnRpY2F0aW9uIHRva2VuIGZvciBmdXR1cmUgcmVxdWVzdHMKICAgICAgICB2YXIgcmVzcG9uc2UgPSBuZXcgU2NyaXB0UmVzcG9uc2UoKTsKCiAgICAgICAgdmFyIHN0YXR1c0NvZGUgPSBjb250ZXh0LkJvZHk/LnN0YXR1c0NvZGUgPz8gNTAwOwogICAgICAgIGlmIChzdGF0dXNDb2RlID49IDIwMCB8fCBzdGF0dXNDb2RlIDw9IDMwMCkKICAgICAgICB7CiAgICAgICAgICAgIHJlc3BvbnNlLkRhdGEgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgc3VjY2VzcyA9IHRydWUsCiAgICAgICAgICAgICAgICBjYXJkID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IHRydWUsCiAgICAgICAgICAgICAgICAgICAgaWQgPSBjb250ZXh0LkJvZHk/LmRhdGE/LmlkLAogICAgICAgICAgICAgICAgICAgIHByb2R1Y3RzID0gY29udGV4dC5Cb2R5Py5kYXRhPy5wcm9kdWN0cwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChzdGF0dXNDb2RlID09IDQwNCkKICAgICAgICB7CiAgICAgICAgICAgIC8vIE5vdCBmb3VuZCAtIGhhbmRsZSBzcGVjaWZpY2FsbHkKICAgICAgICAgICAgcmVzcG9uc2UuRGF0YSA9IG5ldwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBjYXJkID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGVycm9yID0gIlJlc291cmNlIG5vdCBmb3VuZCIsCiAgICAgICAgICAgICAgICAgICAgc2hvdWxkUmV0cnkgPSBmYWxzZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICAvLyBTZXJ2ZXIgZXJyb3IgLSBtaWdodCB3YW50IHRvIHJldHJ5CiAgICAgICAgICAgIHJlc3BvbnNlLkRhdGEgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY2FyZCA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBlcnJvciA9ICJTZXJ2ZXIgZXJyb3Igb2NjdXJyZWQiLAogICAgICAgICAgICAgICAgICAgIHNob3VsZFJldHJ5ID0gdHJ1ZSwKICAgICAgICAgICAgICAgICAgICByZXRyeUFmdGVyID0gMzAgLy8gc2Vjb25kcwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChyZXNwb25zZSk7CiAgICB9CgogICAgaW50ZXJuYWwgY2xhc3MgUHJvZHVjdER0bwogICAgewogICAgICAgIHB1YmxpYyBpbnQgaWQgeyBnZXQ7IHNldDsgfQogICAgICAgIHB1YmxpYyBpbnQgcXVhbnRpdHkgeyBnZXQ7IHNldDsgfQogICAgfQp9\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"proceed-to-checkout\",\n            \"target\": \"order-processing\",\n            \"triggerType\": 0,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Proceed to Checkout\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Ödemeye Geç\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": null,\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"continue-shopping\",\n            \"target\": \"product-browsing\",\n            \"triggerType\": 0,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Continue Shopping\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Alışverişe Devam Et\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": null,\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"order-processing\",\n        \"stateType\": 2,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Order Processing\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Sipariş İşleme\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"process-order\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/ProcessOrderMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKcHVibGljIGNsYXNzIFByb2Nlc3NPcmRlck1hcHBpbmcgOiBJTWFwcGluZwp7CiAgICBwdWJsaWMgVGFzazxTY3JpcHRSZXNwb25zZT4gSW5wdXRIYW5kbGVyKFdvcmtmbG93VGFzayB0YXNrLCBTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgdmFyIGh0dHBUYXNrID0gdGFzayBhcyBIdHRwVGFzazsKICAgICAgICB2YXIgaGVhZGVycyA9IG5ldyBEaWN0aW9uYXJ5PHN0cmluZywgc3RyaW5nPz4KICAgICAgICB7CiAgICAgICAgICAgIFsiQXV0aG9yaXphdGlvbiJdID0gJCJCZXJlYXIge2NvbnRleHQuSW5zdGFuY2UuRGF0YT8ubG9naW4/LmN1cnJlbnRMb2dpbj8uYWNjZXNzVG9rZW59IgogICAgICAgIH07CiAgICAgICAgaHR0cFRhc2suU2V0SGVhZGVycyhoZWFkZXJzKTsKICAgICAgICBjb250ZXh0LkJvZHkudXNlcklkID0gY29udGV4dC5JbnN0YW5jZS5EYXRhPy5sb2dpbj8uY3VycmVudExvZ2luPy5pZDsKICAgICAgICBodHRwVGFzay5TZXRCb2R5KGNvbnRleHQuQm9keSk7CiAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChuZXcgU2NyaXB0UmVzcG9uc2UKICAgICAgICB7CiAgICAgICAgICAgIERhdGEgPSBuZXcgeyB9LAogICAgICAgICAgICBIZWFkZXJzID0gbnVsbAogICAgICAgIH0pOwogICAgfQoKICAgIHB1YmxpYyBhc3luYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBPdXRwdXRIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICAvLyBTdG9yZSBhdXRoZW50aWNhdGlvbiB0b2tlbiBmb3IgZnV0dXJlIHJlcXVlc3RzCiAgICAgICAgdmFyIHJlc3BvbnNlID0gbmV3IFNjcmlwdFJlc3BvbnNlKCk7CgogICAgICAgIHZhciBzdGF0dXNDb2RlID0gY29udGV4dC5Cb2R5LnN0YXR1c0NvZGUgPz8gNTAwOwogICAgICAgIGlmIChzdGF0dXNDb2RlID09IDIwMCkKICAgICAgICB7CiAgICAgICAgICAgIHJlc3BvbnNlLkRhdGEgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgb3JkZXIgPSBuZXcKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBjb250ZXh0LkJvZHkuZGF0YQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChzdGF0dXNDb2RlID09IDQwNCkKICAgICAgICB7CiAgICAgICAgICAgIC8vIE5vdCBmb3VuZCAtIGhhbmRsZSBzcGVjaWZpY2FsbHkKICAgICAgICAgICAgcmVzcG9uc2UuRGF0YSA9IG5ldwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBvcmRlciA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBlcnJvciA9ICJSZXNvdXJjZSBub3QgZm91bmQiLAogICAgICAgICAgICAgICAgICAgIHNob3VsZFJldHJ5ID0gZmFsc2UKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgLy8gU2VydmVyIGVycm9yIC0gbWlnaHQgd2FudCB0byByZXRyeQogICAgICAgICAgICByZXNwb25zZS5EYXRhID0gbmV3CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG9yZGVyID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGVycm9yID0gIlNlcnZlciBlcnJvciBvY2N1cnJlZCIsCiAgICAgICAgICAgICAgICAgICAgc2hvdWxkUmV0cnkgPSB0cnVlLAogICAgICAgICAgICAgICAgICAgIHJldHJ5QWZ0ZXIgPSAzMCAvLyBzZWNvbmRzCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmVzcG9uc2U7CiAgICB9Cn0=\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"order-completed\",\n            \"target\": \"order-confirmation\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Order Completed\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Sipariş Tamamlandı\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": null,\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"payment-failed\",\n            \"target\": \"cart-management\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Payment Failed - Return to Cart\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Ödeme Başarısız - Sepete Dön\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": null,\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"order-confirmation\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Order Confirmation\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Sipariş Onayı\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": []\n      }\n    ]\n  }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - e-Commerce Flow",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								}
							]
						},
						{
							"name": "Tasks",
							"item": [
								{
									"name": "1 - Start - Auth Login",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"auth-login\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"ecommerce\",\n    \"authentication\",\n    \"login\",\n    \"dummyjson\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"https://dummyjson.com/auth/login\",\n      \"method\": \"POST\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {\n      },\n      \"timeoutSeconds\": 3,\n      \"validateSsl\": false\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Auth Login",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Add to Card",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"add-to-cart\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"ecommerce\",\n    \"cart\",\n    \"shopping\",\n    \"dummyjson\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"https://dummyjson.com/{CARD_ADD_OR_UPDATE_PATH}\",\n      \"method\": \"POST\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {\n      },\n      \"timeoutSeconds\": 30,\n      \"validateSsl\": false\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Add to Card",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Process Order",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"process-order\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"ecommerce\",\n    \"order\",\n    \"checkout\",\n    \"dummyjson\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"https://dummyjson.com/recipes/add\",\n      \"method\": \"POST\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"timeoutSeconds\": 5,\n      \"validateSsl\": false\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Process Order",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								}
							]
						}
					]
				},
				{
					"name": "Instance Execute",
					"item": [
						{
							"name": "Get Instance Data",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instance",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										":domain",
										"workflows",
										":flow",
										"instances",
										":instance"
									],
									"variable": [
										{
											"key": "domain",
											"value": "{{domain}}"
										},
										{
											"key": "flow",
											"value": "ecommerce"
										},
										{
											"key": "instance",
											"value": "{{instanceId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Step 1: Start Instance",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"if (pm.response.code === 200 || pm.response.code === 201) {",
											"    var jsonData = pm.response.json();",
											"    pm.collectionVariables.set('instanceId', jsonData.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"var uuid = require('uuid');",
											"pm.collectionVariables.set(\"requestId\",uuid.v4());"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept-Language",
										"value": "tr-TR",
										"type": "text"
									},
									{
										"key": "X-Request-Id",
										"value": "{{requestId}}",
										"type": "text"
									},
									{
										"key": "X-Device-Id",
										"value": "{{requestId}}",
										"type": "text"
									},
									{
										"key": "X-Token-Id",
										"value": "{{requestId}}",
										"type": "text"
									},
									{
										"key": "X-Device-Info",
										"value": "IOS 16",
										"type": "text"
									},
									{
										"key": "X-Forwarded-For",
										"value": "192.168.2.1",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"key\": \"34987491721\",\n    \"tags\": [\n        \"test\",\n        \"ecommerce\",\n        \"order\"\n    ],\n    \"attributes\": {\n        \"username\": \"emilys\",\n        \"password\": \"emilyspass\",\n        \"expiresInMins\": 30\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										":domain",
										"workflows",
										":flow",
										"instances",
										"start"
									],
									"query": [
										{
											"key": "sync",
											"value": "true"
										}
									],
									"variable": [
										{
											"key": "domain",
											"value": "{{domain}}"
										},
										{
											"key": "flow",
											"value": "ecommerce"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Step 2: Select Product",
							"request": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"id\":2\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instance/transitions/select-product?sync=true",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										":domain",
										"workflows",
										":flow",
										"instances",
										":instance",
										"transitions",
										"select-product"
									],
									"query": [
										{
											"key": "sync",
											"value": "true"
										}
									],
									"variable": [
										{
											"key": "domain",
											"value": "{{domain}}"
										},
										{
											"key": "flow",
											"value": "ecommerce"
										},
										{
											"key": "instance",
											"value": "{{instanceId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Step 2.1: Continue Shopping",
							"request": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instance/transitions/continue-shopping?sync=true",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										":domain",
										"workflows",
										":flow",
										"instances",
										":instance",
										"transitions",
										"continue-shopping"
									],
									"query": [
										{
											"key": "sync",
											"value": "true"
										}
									],
									"variable": [
										{
											"key": "domain",
											"value": "{{domain}}"
										},
										{
											"key": "flow",
											"value": "ecommerce"
										},
										{
											"key": "instance",
											"value": "{{instanceId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Step 3: Proceed to Checkout",
							"request": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"name\": \"Classic Margherita Pizza\",\n    \"ingredients\": [\n        \"Pizza dough\",\n        \"Tomato sauce\",\n        \"Fresh mozzarella cheese\",\n        \"Fresh basil leaves\",\n        \"Olive oil\",\n        \"Salt and pepper to taste\"\n    ],\n    \"instructions\": [\n        \"Preheat the oven to 475°F (245°C).\",\n        \"Roll out the pizza dough and spread tomato sauce evenly.\",\n        \"Top with slices of fresh mozzarella and fresh basil leaves.\",\n        \"Drizzle with olive oil and season with salt and pepper.\",\n        \"Bake in the preheated oven for 12-15 minutes or until the crust is golden brown.\",\n        \"Slice and serve hot.\"\n    ],\n    \"prepTimeMinutes\": 20,\n    \"cookTimeMinutes\": 15,\n    \"servings\": 4,\n    \"difficulty\": \"Easy\",\n    \"cuisine\": \"Italian\",\n    \"caloriesPerServing\": 300,\n    \"tags\": [\n        \"Pizza\",\n        \"Italian\"\n    ],\n    \"userId\": 45,\n    \"image\": \"https://cdn.dummyjson.com/recipe-images/1.webp\",\n    \"rating\": 4.6,\n    \"reviewCount\": 3,\n    \"mealType\": [\n        \"Dinner\"\n    ]\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instance/transitions/proceed-to-checkout?sync=true",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										":domain",
										"workflows",
										":flow",
										"instances",
										":instance",
										"transitions",
										"proceed-to-checkout"
									],
									"query": [
										{
											"key": "sync",
											"value": "true"
										}
									],
									"variable": [
										{
											"key": "domain",
											"value": "{{domain}}"
										},
										{
											"key": "flow",
											"value": "ecommerce"
										},
										{
											"key": "instance",
											"value": "{{instanceId}}"
										}
									]
								}
							},
							"response": []
						}
					]
				}
			]
		},
		{
			"name": "oAuth2.0",
			"item": [
				{
					"name": "Definitions",
					"item": [
						{
							"name": "Flows",
							"item": [
								{
									"name": "1 - Start - e-oAuth2.0 Flow",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"oauth-authentication\",\n  \"flow\": \"sys-flows\",\n  \"domain\": \"{{domain}}\",\n  \"version\": \"1.0.0\",\n  \"tags\": [\n    \"oauth2\",\n    \"authentication\",\n    \"security\",\n    \"mfa\",\n    \"grant-types\"\n  ],\n  \"attributes\": {\n    \"type\": \"F\",\n    \"timeout\": null,\n    \"labels\": [\n      {\n        \"language\": \"en-US\",\n        \"label\": \"OAuth2.0 Authentication Workflow\"\n      },\n      {\n        \"language\": \"tr-TR\",\n        \"label\": \"OAuth2.0 Kimlik Doğrulama İş Akışı\"\n      }\n    ],\n    \"functions\": [],\n    \"features\": [],\n    \"extensions\": [],\n    \"sharedTransitions\": [],\n    \"startTransition\": {\n      \"key\": \"initiate-auth\",\n      \"target\": \"client-validation\",\n      \"triggerType\": 0,\n      \"versionStrategy\": \"Minor\",\n      \"labels\": [\n        {\n          \"language\": \"en-US\",\n          \"label\": \"Initiate Authentication\"\n        },\n        {\n          \"language\": \"tr-TR\",\n          \"label\": \"Kimlik Doğrulama Başlat\"\n        }\n      ],\n      \"schema\": null,\n      \"rule\": null,\n      \"timer\": null,\n      \"view\": null,\n      \"onExecutionTasks\": []\n    },\n    \"states\": [\n      {\n        \"key\": \"client-validation\",\n        \"stateType\": 1,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Client Validation\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"İstemci Doğrulama\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"validate-client\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/ValidateClientMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKLy8vIDxzdW1tYXJ5PgovLy8gT0F1dGgyIENsaWVudCBWYWxpZGF0aW9uIE1hcHBpbmcgLSBDbGllbnQgdmFsaWRhdGlvbiBtYXBwaW5nCi8vIFRoaXMgbWFwcGluZyBpcyB1c2VkIHRvIHZhbGlkYXRlIE9BdXRoMiBjbGllbnQgY3JlZGVudGlhbHMuCi8vLyA8L3N1bW1hcnk+CnB1YmxpYyBjbGFzcyBWYWxpZGF0ZUNsaWVudE1hcHBpbmcgOiBJTWFwcGluZwp7CiAgICBwdWJsaWMgVGFzazxTY3JpcHRSZXNwb25zZT4gSW5wdXRIYW5kbGVyKFdvcmtmbG93VGFzayB0YXNrLCBTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgdHJ5CiAgICAgICAgewogICAgICAgICAgICB2YXIgaHR0cFRhc2sgPSB0YXNrIGFzIEh0dHBUYXNrOwogICAgICAgICAgICBpZiAoaHR0cFRhc2sgPT0gbnVsbCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRPcGVyYXRpb25FeGNlcHRpb24oIlRhc2sgbXVzdCBiZSBhbiBIdHRwVGFzayBmb3IgY2xpZW50IHZhbGlkYXRpb24iKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gUHJlcGFyZSB0aGUgcmVxdWVzdCBib2R5IC0gUmVxdWlyZWQgcGFyYW1ldGVycyBmb3IgT0F1dGgyIGNsaWVudCB2YWxpZGF0aW9uCiAgICAgICAgICAgIHZhciByZXF1ZXN0Qm9keSA9IG5ldwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBjbGllbnRfaWQgPSBjb250ZXh0LkJvZHk/LmNsaWVudF9pZCwKICAgICAgICAgICAgICAgIGNsaWVudF9zZWNyZXQgPSBjb250ZXh0LkJvZHk/LmNsaWVudF9zZWNyZXQsCiAgICAgICAgICAgICAgICBncmFudF90eXBlID0gY29udGV4dC5Cb2R5Py5ncmFudF90eXBlLAogICAgICAgICAgICAgICAgc2NvcGUgPSBjb250ZXh0LkJvZHk/LnNjb3BlLAogICAgICAgICAgICAgICAgdXNlcm5hbWUgPSBjb250ZXh0LkJvZHk/LnVzZXJuYW1lLAogICAgICAgICAgICAgICAgcGFzc3dvcmQgPSBjb250ZXh0LkJvZHk/LnBhc3N3b3JkCiAgICAgICAgICAgIH07CgogICAgICAgICAgICBodHRwVGFzay5TZXRCb2R5KHJlcXVlc3RCb2R5KTsKCiAgICAgICAgICAgIC8vIFNldCBIZWFkZXJzCiAgICAgICAgICAgIHZhciBoZWFkZXJzID0gbmV3IERpY3Rpb25hcnk8c3RyaW5nLCBzdHJpbmc/PgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBbIkNvbnRlbnQtVHlwZSJdID0gImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICAgICAgWyJYLVdvcmtmbG93LUluc3RhbmNlIl0gPSBjb250ZXh0Lkluc3RhbmNlPy5JZC5Ub1N0cmluZygpCiAgICAgICAgICAgIH07CgogICAgICAgICAgICBodHRwVGFzay5TZXRIZWFkZXJzKGhlYWRlcnMpOwoKICAgICAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChuZXcgU2NyaXB0UmVzcG9uc2UgKCkpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChuZXcgU2NyaXB0UmVzcG9uc2UgKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8gPHN1bW1hcnk+CiAgICAvLy8gUHJvY2VzcyB0aGUgY2xpZW50IGF1dGhlbnRpY2F0aW9uIHJlc3VsdCBhbmQgbWVyZ2UgaXQgaW50byB0aGUgd29ya2Zsb3cgaW5zdGFuY2UKICAgIC8vLyA8L3N1bW1hcnk+CiAgICBwdWJsaWMgYXN5bmMgVGFzazxTY3JpcHRSZXNwb25zZT4gT3V0cHV0SGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgdHJ5CiAgICAgICAgewogICAgICAgICAgICB2YXIgc3RhdHVzQ29kZSA9IEdldFN0YXR1c0NvZGVGcm9tUmVzcG9uc2UoY29udGV4dCk7CiAgICAgICAgICAgIHZhciByZXNwb25zZURhdGEgPSBHZXRSZXNwb25zZURhdGFGcm9tQ29udGV4dChjb250ZXh0KTsKCiAgICAgICAgICAgIC8vIFN1Y2Nlc3NmdWwgdmVyaWZpY2F0aW9uCiAgICAgICAgICAgIGlmIChzdGF0dXNDb2RlID49IDIwMCAmJiBzdGF0dXNDb2RlIDwgMzAwKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgY2xpZW50VmFsaWRhdGlvbiA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSB0cnVlLAogICAgICAgICAgICAgICAgICAgIHZhbGlkYXRlZEF0ID0gRGF0ZVRpbWUuVXRjTm93LAogICAgICAgICAgICAgICAgICAgIGNsaWVudElkID0gcmVzcG9uc2VEYXRhPy5jbGllbnRJZCwKICAgICAgICAgICAgICAgICAgICBncmFudFR5cGVzID0gcmVzcG9uc2VEYXRhPy5ncmFudFR5cGVzLAogICAgICAgICAgICAgICAgICAgIHJlZGlyZWN0VXJpcyA9IHJlc3BvbnNlRGF0YT8ucmVkaXJlY3RVcmlzLAogICAgICAgICAgICAgICAgICAgIHNjb3BlcyA9IHJlc3BvbnNlRGF0YT8uc2NvcGVzLAogICAgICAgICAgICAgICAgICAgIGlzQWN0aXZlID0gcmVzcG9uc2VEYXRhPy5pc0FjdGl2ZQogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFNjcmlwdFJlc3BvbnNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgS2V5ID0gImNsaWVudC12YWxpZGF0aW9uLXN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIERhdGEgPSBuZXcKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudFZhbGlkYXRpb24gPSBjbGllbnRWYWxpZGF0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICBkZXZpY2VJZCA9IGNvbnRleHQuSGVhZGVycz9bIngtZGV2aWNlLWlkIl0sCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RJZCA9IGNvbnRleHQuSGVhZGVycz9bIngtcmVxdWVzdC1pZCJdLAogICAgICAgICAgICAgICAgICAgICAgICB1c2VyQWdlbnQgPSBjb250ZXh0LkhlYWRlcnM/WyJ1c2VyLWFnZW50Il0sCiAgICAgICAgICAgICAgICAgICAgICAgIGlwQWRkcmVzcyA9IGNvbnRleHQuSGVhZGVycz9bIngtZm9yd2FyZGVkLWZvciJdID8/IGNvbnRleHQuSGVhZGVycz9bIngtcmVhbC1pcCJdCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBUYWdzID0gbmV3W10geyAib2F1dGgyIiwgImNsaWVudC12YWxpZGF0aW9uIiwgInN1Y2Nlc3MiLCAiYXV0aGVudGljYXRlZCIgfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBGYWlsZWQgdmVyaWZpY2F0aW9uCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGVycm9ySW5mbyA9IEV4dHJhY3RFcnJvckluZm9ybWF0aW9uKGNvbnRleHQsIHN0YXR1c0NvZGUpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgY2xpZW50VmFsaWRhdGlvbiA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZWRBdCA9IERhdGVUaW1lLlV0Y05vdywKICAgICAgICAgICAgICAgICAgICBlcnJvciA9IGVycm9ySW5mby5tZXNzYWdlLAogICAgICAgICAgICAgICAgICAgIGVycm9yQ29kZSA9IGVycm9ySW5mby5jb2RlLAogICAgICAgICAgICAgICAgICAgIGVycm9yRGVzY3JpcHRpb24gPSBlcnJvckluZm8uZGVzY3JpcHRpb24sCiAgICAgICAgICAgICAgICAgICAgc3RhdHVzQ29kZSA9IHN0YXR1c0NvZGUKICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTY3JpcHRSZXNwb25zZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIEtleSA9ICJjbGllbnQtdmFsaWRhdGlvbi1mYWlsdXJlIiwKICAgICAgICAgICAgICAgICAgICBEYXRhID0gbmV3CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRWYWxpZGF0aW9uID0gY2xpZW50VmFsaWRhdGlvbgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgVGFncyA9IG5ld1tdIHsgIm9hdXRoMiIsICJjbGllbnQtdmFsaWRhdGlvbiIsICJmYWlsdXJlIiwgImVycm9yIiB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNhdGNoIChFeGNlcHRpb24gZXgpCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gbmV3IFNjcmlwdFJlc3BvbnNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIEtleSA9ICJjbGllbnQtdmFsaWRhdGlvbi1vdXRwdXQtZXJyb3IiLAogICAgICAgICAgICAgICAgRGF0YSA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGNsaWVudFZhbGlkYXRpb24gPSBuZXcKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSAiSW50ZXJuYWwgcHJvY2Vzc2luZyBlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yQ29kZSA9ICJwcm9jZXNzaW5nX2Vycm9yIiwKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JEZXNjcmlwdGlvbiA9IGV4Lk1lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkYXRlZEF0ID0gRGF0ZVRpbWUuVXRjTm93CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIFRhZ3MgPSBuZXdbXSB7ICJvYXV0aDIiLCAiY2xpZW50LXZhbGlkYXRpb24iLCAiZXJyb3IiLCAiZXhjZXB0aW9uIiB9CiAgICAgICAgICAgIH07CiAgICAgICAgfQogICAgfQoKICAgICNyZWdpb24gSGVscGVyIE1ldGhvZHMKCiAgICBwcml2YXRlIHN0YXRpYyBpbnQgR2V0U3RhdHVzQ29kZUZyb21SZXNwb25zZShTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgLy8gR2V0IHN0YXR1cyBjb2RlIGZyb20gc3RhbmRhcmQgcmVzcG9uc2Ugc3RydWN0dXJlCiAgICAgICAgaWYgKGNvbnRleHQuQm9keT8uc3RhdHVzQ29kZSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gKGludCljb250ZXh0LkJvZHkuc3RhdHVzQ29kZTsKCiAgICAgICAgLy8gQWNjZXB0IHN1Y2Nlc3MgYnkgZGVmYXVsdAogICAgICAgIHJldHVybiAyMDA7CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgZHluYW1pYz8gR2V0UmVzcG9uc2VEYXRhRnJvbUNvbnRleHQoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIC8vIEdldCBkYXRhIGZyb20gQm9keQogICAgICAgIGlmIChjb250ZXh0LkJvZHk/LmRhdGEgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuQm9keS5kYXRhOwoKICAgICAgICAvLyBEaXJlY3QgYm9keSBjb250ZW50CiAgICAgICAgaWYgKGNvbnRleHQuQm9keSAhPSBudWxsICYmIGNvbnRleHQuQm9keS5zdGF0dXNDb2RlID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBjb250ZXh0LkJvZHk7CgogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIChzdHJpbmcgbWVzc2FnZSwgc3RyaW5nIGNvZGUsIHN0cmluZyBkZXNjcmlwdGlvbikgRXh0cmFjdEVycm9ySW5mb3JtYXRpb24oU2NyaXB0Q29udGV4dCBjb250ZXh0LCBpbnQgc3RhdHVzQ29kZSkKICAgIHsKICAgICAgICB2YXIgZXJyb3JEYXRhID0gY29udGV4dC5Cb2R5Py5kYXRhPy5lcnJvciA/PyBudWxsOwogICAgICAgIAogICAgICAgIHN0cmluZyBtZXNzYWdlID0gIkNsaWVudCB2YWxpZGF0aW9uIGZhaWxlZCI7CiAgICAgICAgc3RyaW5nIGNvZGUgPSAiaW52YWxpZF9jbGllbnQiOwogICAgICAgIHN0cmluZyBkZXNjcmlwdGlvbiA9ICJUaGUgY2xpZW50IGNyZWRlbnRpYWxzIHByb3ZpZGVkIGFyZSBpbnZhbGlkIjsKCiAgICAgICAgaWYgKGVycm9yRGF0YSAhPSBudWxsKQogICAgICAgIHsKICAgICAgICAgICAgbWVzc2FnZSA9IGVycm9yRGF0YS5tZXNzYWdlID8/IG1lc3NhZ2U7CiAgICAgICAgICAgIGNvZGUgPSBlcnJvckRhdGEuY29kZSA/PyBjb2RlOwogICAgICAgICAgICBkZXNjcmlwdGlvbiA9IGVycm9yRGF0YS5kZXNjcmlwdGlvbiA/PyBkZXNjcmlwdGlvbjsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoc3RhdHVzQ29kZSA9PSA0MDEpCiAgICAgICAgewogICAgICAgICAgICBjb2RlID0gInVuYXV0aG9yaXplZF9jbGllbnQiOwogICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICJDbGllbnQgYXV0aGVudGljYXRpb24gZmFpbGVkIjsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoc3RhdHVzQ29kZSA9PSA0MDMpCiAgICAgICAgewogICAgICAgICAgICBjb2RlID0gImFjY2Vzc19kZW5pZWQiOwogICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICJDbGllbnQgYWNjZXNzIGRlbmllZCI7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKHN0YXR1c0NvZGUgPj0gNTAwKQogICAgICAgIHsKICAgICAgICAgICAgY29kZSA9ICJzZXJ2ZXJfZXJyb3IiOwogICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICJJbnRlcm5hbCBzZXJ2ZXIgZXJyb3IgZHVyaW5nIGNsaWVudCB2YWxpZGF0aW9uIjsKICAgICAgICB9CgogICAgICAgIHJldHVybiAobWVzc2FnZSwgY29kZSwgZGVzY3JpcHRpb24pOwogICAgfQoKICAgICNlbmRyZWdpb24KfQ==\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"client-valid\",\n            \"target\": \"grant-type-selection\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Client Valid\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"İstemci Geçerli\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/ClientValidRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCi8vLyA8c3VtbWFyeT4KLy8vIENsaWVudCBWYWxpZCBSdWxlIC0gQ2xpZW50IHZhbGlkYXRpb24gc3VjY2VzcyBjb25kaXRpb24gbWFwcGluZwovLy8gVGhpcyBydWxlIGNoZWNrcyBpZiB0aGUgY2xpZW50IHZhbGlkYXRpb24gd2FzIHN1Y2Nlc3NmdWwuCi8vLyA8L3N1bW1hcnk+CnB1YmxpYyBjbGFzcyBDbGllbnRWYWxpZFJ1bGUgOiBJQ29uZGl0aW9uTWFwcGluZwp7CiAgICAvLy8gPHN1bW1hcnk+CiAgICAvLy8gQ2hlY2sgaWYgdGhlIGNsaWVudCB2YWxpZGF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAgLy8vIDwvc3VtbWFyeT4KICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICAgICAgLy8gTnVsbCBjaGVjawogICAgICAgICAgICBpZiAoY29udGV4dD8uSW5zdGFuY2U/LkRhdGEgPT0gbnVsbCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBDbGllbnQgdmFsaWRhdGlvbiBkYXRhCiAgICAgICAgICAgIHZhciBjbGllbnRWYWxpZGF0aW9uID0gY29udGV4dC5JbnN0YW5jZS5EYXRhLmNsaWVudFZhbGlkYXRpb247CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoY2xpZW50VmFsaWRhdGlvbiA9PSBudWxsKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBjbGllbnQgdmFsaWRhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgICAgICAgICAgcmV0dXJuIGNsaWVudFZhbGlkYXRpb24uc3VjY2VzcyA9PSB0cnVlOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgICAgIHsKICAgICAgICAgICAgLy8gSWYgYW4gZXhjZXB0aW9uIG9jY3VycywgcmV0dXJuIGZhbHNlIGFuZCB3cml0ZSB0byBhdWRpdCBsb2cKICAgICAgICAgICAgaWYgKGNvbnRleHQ/Lk1ldGFEYXRhICE9IG51bGwpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNvbnRleHQuTWV0YURhdGFbImNsaWVudF92YWxpZF9ydWxlX2Vycm9yIl0gPSBuZXcKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBlcnJvciA9IGV4Lk1lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgdHlwZSA9IGV4LkdldFR5cGUoKS5OYW1lLAogICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcCA9IERhdGVUaW1lLlV0Y05vdwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KfQ==\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"client-invalid\",\n            \"target\": \"authentication-failed\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Client Invalid\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"İstemci Geçersiz\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/ClientInvalidRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCi8vLyA8c3VtbWFyeT4KLy8vIENsaWVudCBJbnZhbGlkIFJ1bGUgLSBDbGllbnQgdmFsaWRhdGlvbiBmYWlsdXJlIGNvbmRpdGlvbiBtYXBwaW5nCi8vLyBUaGlzIHJ1bGUgY2hlY2tzIGlmIHRoZSBjbGllbnQgdmFsaWRhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KLy8vIDwvc3VtbWFyeT4KcHVibGljIGNsYXNzIENsaWVudEludmFsaWRSdWxlIDogSUNvbmRpdGlvbk1hcHBpbmcKewogICAgLy8vIDxzdW1tYXJ5PgogICAgLy8vIENoZWNrIGlmIHRoZSBjbGllbnQgdmFsaWRhdGlvbiB3YXMgc3VjY2Vzc2Z1bC4KICAgIC8vLyA8L3N1bW1hcnk+CiAgICBwdWJsaWMgYXN5bmMgVGFzazxib29sPiBIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICB0cnkKICAgICAgICB7CiAgICAgICAgICAgIC8vIE51bGwgY2hlY2sKICAgICAgICAgICAgaWYgKGNvbnRleHQ/Lkluc3RhbmNlPy5EYXRhID09IG51bGwpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBDbGllbnQgdmFsaWRhdGlvbiBkYXRhCiAgICAgICAgICAgIHZhciBjbGllbnRWYWxpZGF0aW9uID0gY29udGV4dC5JbnN0YW5jZS5EYXRhLmNsaWVudFZhbGlkYXRpb247CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoY2xpZW50VmFsaWRhdGlvbiA9PSBudWxsKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGNsaWVudCB2YWxpZGF0aW9uIHdhcyBzdWNjZXNzZnVsLgogICAgICAgICAgICByZXR1cm4gY2xpZW50VmFsaWRhdGlvbi5zdWNjZXNzID09IGZhbHNlOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgICAgIHsKICAgICAgICAgICAgLy8gRXhjZXB0aW9uIGR1cnVtdW5kYSB0cnVlIGTDtm5kw7xyIChpbnZhbGlkKQogICAgICAgICAgICBpZiAoY29udGV4dD8uTWV0YURhdGEgIT0gbnVsbCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29udGV4dC5NZXRhRGF0YVsiY2xpZW50X2ludmFsaWRfcnVsZV9lcnJvciJdID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBleC5NZXNzYWdlLAogICAgICAgICAgICAgICAgICAgIHR5cGUgPSBleC5HZXRUeXBlKCkuTmFtZSwKICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXAgPSBEYXRlVGltZS5VdGNOb3cKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiB0cnVlOyAvLyBIYXRhIHZhcnNhIGludmFsaWQga2FidWwgZXQKICAgICAgICB9CiAgICB9Cn0=\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"grant-type-selection\",\n        \"stateType\": 2,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Grant Type Selection\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Grant Type Seçimi\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"client-credentials-flow\",\n            \"target\": \"token-generation\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Client Credentials Flow\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Client Credentials Akışı\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/ClientCredentialsFlowRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBDbGllbnRDcmVkZW50aWFsc0Zsb3dSdWxlIDogSUNvbmRpdGlvbk1hcHBpbmcKewogICAgcHVibGljIGFzeW5jIFRhc2s8Ym9vbD4gSGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgcmV0dXJuIGNvbnRleHQuSW5zdGFuY2UuRGF0YS5ncmFudF90eXBlID09ICJjbGllbnRfY3JlZGVudGlhbHMiOwogICAgfQp9\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"password-flow\",\n            \"target\": \"password-auth\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Password Flow\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Password Akışı\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/PasswordFlowRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBQYXNzd29yZEZsb3dSdWxlIDogSUNvbmRpdGlvbk1hcHBpbmcKewogICAgcHVibGljIGFzeW5jIFRhc2s8Ym9vbD4gSGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgcmV0dXJuIGNvbnRleHQuSW5zdGFuY2UuRGF0YS5ncmFudF90eXBlID09ICJwYXNzd29yZCI7CiAgICB9Cn0=\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"authorization-code-flow\",\n            \"target\": \"authorization-code-auth\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Authorization Code Flow\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Authorization Code Akışı\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/AuthorizationCodeFlowRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBBdXRob3JpemF0aW9uQ29kZUZsb3dSdWxlIDogSUNvbmRpdGlvbk1hcHBpbmcKewogICAgcHVibGljIGFzeW5jIFRhc2s8Ym9vbD4gSGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgcmV0dXJuIGNvbnRleHQuSW5zdGFuY2UuRGF0YS5ncmFudF90eXBlID09ICJhdXRob3JpemF0aW9uX2NvZGUiOwogICAgfQp9\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"password-auth\",\n        \"stateType\": 4,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Password Authentication\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Password Kimlik Doğrulama\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": {\n          \"type\": \"S\",\n          \"process\": {\n            \"key\": \"password-subflow\",\n            \"domain\": \"{{domain}}\",\n            \"version\": \"1.0.0\",\n            \"flow\": \"sys-flows\"\n          },\n          \"mapping\": {\n            \"location\": \"./src/PasswordSubflowMapping.csx\",\n            \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBQYXNzd29yZFN1YmZsb3dNYXBwaW5nIDogSVN1YkZsb3dNYXBwaW5nCnsKICAgIHB1YmxpYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBJbnB1dEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHJldHVybiBUYXNrLkZyb21SZXN1bHQobmV3IFNjcmlwdFJlc3BvbnNlCiAgICAgICAgewogICAgICAgICAgICBEYXRhID0gY29udGV4dC5JbnN0YW5jZS5EYXRhLAogICAgICAgICAgICBIZWFkZXJzID0gbnVsbAogICAgICAgIH0pOwogICAgfQoKICAgIHB1YmxpYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBPdXRwdXRIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICByZXR1cm4gVGFzay5Gcm9tUmVzdWx0KG5ldyBTY3JpcHRSZXNwb25zZQogICAgICAgIHsKICAgICAgICAgICAgRGF0YSA9IGNvbnRleHQuQm9keSwKICAgICAgICAgICAgSGVhZGVycyA9IG51bGwKICAgICAgICB9KTsKICAgIH0KfQo=\"\n          }\n        },\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"password-success\",\n            \"target\": \"mfa-check\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Password Success - Check MFA\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Password Başarılı - MFA Kontrol\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/AuthorizationSuccessRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBBdXRob3JpemF0aW9uU3VjY2Vzc1J1bGUgOiBJQ29uZGl0aW9uTWFwcGluZwp7CiAgICBwdWJsaWMgYXN5bmMgVGFzazxib29sPiBIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICByZXR1cm4gY29udGV4dC5JbnN0YW5jZS5EYXRhLmF1dGhlbnRpY2F0aW9uLnN1Y2Nlc3MgPT0gdHJ1ZTsKICAgIH0KfQo=\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"password-failed\",\n            \"target\": \"authentication-failed\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Password Failed\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Password Başarısız\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/AuthorizationFailedRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBBdXRob3JpemF0aW9uRmFpbGVkUnVsZSA6IElDb25kaXRpb25NYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHJldHVybiBjb250ZXh0Lkluc3RhbmNlLkRhdGEuYXV0aGVudGljYXRpb24uc3VjY2VzcyA9PSBmYWxzZTsKICAgIH0KfQo=\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"authorization-code-auth\",\n        \"stateType\": 4,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Authorization Code Authentication\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Authorization Code Kimlik Doğrulama\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": {\n          \"type\": \"S\",\n          \"process\": {\n            \"key\": \"authorization-code-subflow\",\n            \"domain\": \"{{domain}}\",\n            \"version\": \"1.0.0\",\n            \"flow\": \"sys-flows\"\n          },\n          \"mapping\": {\n            \"location\": \"./src/AuthorizationCodeSubflowMapping.csx\",\n            \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBBdXRob3JpemF0aW9uQ29kZVN1YmZsb3dNYXBwaW5nIDogSVN1YkZsb3dNYXBwaW5nCnsKICAgIHB1YmxpYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBJbnB1dEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHJldHVybiBUYXNrLkZyb21SZXN1bHQobmV3IFNjcmlwdFJlc3BvbnNlCiAgICAgICAgewogICAgICAgICAgICBEYXRhID0gY29udGV4dC5JbnN0YW5jZS5EYXRhLAogICAgICAgICAgICBIZWFkZXJzID0gbnVsbAogICAgICAgIH0pOwogICAgfQoKICAgIHB1YmxpYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBPdXRwdXRIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICByZXR1cm4gVGFzay5Gcm9tUmVzdWx0KG5ldyBTY3JpcHRSZXNwb25zZQogICAgICAgIHsKICAgICAgICAgICAgRGF0YSA9IGNvbnRleHQuQm9keSwKICAgICAgICAgICAgSGVhZGVycyA9IG51bGwKICAgICAgICB9KTsKICAgIH0KfQ==\"\n          }\n        },\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"authorization-code-success\",\n            \"target\": \"mfa-check\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Authorization Code Success - Check MFA\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Authorization Code Başarılı - MFA Kontrol\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/AuthorizationSuccessRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBBdXRob3JpemF0aW9uU3VjY2Vzc1J1bGUgOiBJQ29uZGl0aW9uTWFwcGluZwp7CiAgICBwdWJsaWMgYXN5bmMgVGFzazxib29sPiBIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICByZXR1cm4gY29udGV4dC5JbnN0YW5jZS5EYXRhLmF1dGhlbnRpY2F0aW9uLnN1Y2Nlc3MgPT0gdHJ1ZTsKICAgIH0KfQo=\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"authorization-code-failed\",\n            \"target\": \"authentication-failed\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Authorization Code Failed\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Authorization Code Başarısız\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/AuthorizationFailedRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBBdXRob3JpemF0aW9uRmFpbGVkUnVsZSA6IElDb25kaXRpb25NYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHJldHVybiBjb250ZXh0Lkluc3RhbmNlLkRhdGEuYXV0aGVudGljYXRpb24uc3VjY2VzcyA9PSBmYWxzZTsKICAgIH0KfQo=\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"mfa-check\",\n        \"stateType\": 2,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Multi-Factor Authentication Check\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Çok Faktörlü Kimlik Doğrulama Kontrolü\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"check-device-registration\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/CheckDeviceRegistrationMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKLy8vIDxzdW1tYXJ5PgovLy8gRGV2aWNlIFJlZ2lzdHJhdGlvbiBDaGVjayBNYXBwaW5nIC0gRGV2aWNlIHJlZ2lzdHJhdGlvbiBzdGF0dXMgY2hlY2sgbWFwcGluZwovLy8gVGhpcyBtYXBwaW5nIGlzIHVzZWQgdG8gY2hlY2sgd2hldGhlciB0aGUgZGV2aWNlIGlzIHJlZ2lzdGVyZWQgZHVyaW5nIHRoZSBNRkEgcHJvY2Vzcy4KLy8vIDwvc3VtbWFyeT4KcHVibGljIGNsYXNzIENoZWNrRGV2aWNlUmVnaXN0cmF0aW9uTWFwcGluZyA6IElNYXBwaW5nCnsKICAgIC8vLyA8c3VtbWFyeT4KICAgIC8vLyBQcmVwYXJlIGlucHV0IGZvciBkZXZpY2UgcmVnaXN0cmF0aW9uIGNoZWNrCiAgICAvLy8gPC9zdW1tYXJ5PgogICAgcHVibGljIFRhc2s8U2NyaXB0UmVzcG9uc2U+IElucHV0SGFuZGxlcihXb3JrZmxvd1Rhc2sgdGFzaywgU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICAgICAgdmFyIGh0dHBUYXNrID0gdGFzayBhcyBIdHRwVGFzazsKICAgICAgICAgICAgaWYgKGh0dHBUYXNrID09IG51bGwpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXhjZXB0aW9uKCJUYXNrIG11c3QgYmUgYW4gSHR0cFRhc2sgZm9yIGRldmljZSByZWdpc3RyYXRpb24gY2hlY2siKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLy8gR2V0IGluZm9ybWF0aW9uIGZyb20gYXV0aGVudGljYXRpb24gY29udGV4dAogICAgICAgICAgICB2YXIgYXV0aERhdGEgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5hdXRoZW50aWNhdGlvbjsKICAgICAgICAgICAgdmFyIGNsaWVudERhdGEgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5jbGllbnRWYWxpZGF0aW9uOwoKICAgICAgICAgICAgLy8gUXVlcnkgcGFyYW1ldGVycyB0byBiZSBzZW50CiAgICAgICAgICAgIHZhciBxdWVyeVBhcmFtcyA9IG5ldyBEaWN0aW9uYXJ5PHN0cmluZywgc3RyaW5nPz4KICAgICAgICAgICAgewogICAgICAgICAgICAgICAgWyJ1c2VyX2lkIl0gPSBhdXRoRGF0YT8udXNlcklkPy5Ub1N0cmluZygpLAogICAgICAgICAgICAgICAgWyJkZXZpY2VfaWQiXSA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LmRldmljZUlkLAogICAgICAgICAgICAgICAgWyJjbGllbnRfaWQiXSA9IGNsaWVudERhdGE/LmNsaWVudElkPy5Ub1N0cmluZygpID8/IGNsaWVudERhdGE/LmNsaWVudElkPy5Ub1N0cmluZygpCiAgICAgICAgICAgIH07CgogICAgICAgICAgICAvLyBVcGRhdGUgVVJMIHdpdGggcXVlcnkgcGFyYW1ldGVycwogICAgICAgICAgICB2YXIgYmFzZVVybCA9IGh0dHBUYXNrLlVybDsKICAgICAgICAgICAgdmFyIHF1ZXJ5U3RyaW5nID0gc3RyaW5nLkpvaW4oIiYiLCBxdWVyeVBhcmFtcy5XaGVyZShrdnAgPT4gIXN0cmluZy5Jc051bGxPckVtcHR5KGt2cC5WYWx1ZSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5TZWxlY3Qoa3ZwID0+ICQie2t2cC5LZXl9PXtVcmkuRXNjYXBlRGF0YVN0cmluZyhrdnAuVmFsdWUhKX0iKSk7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoIXN0cmluZy5Jc051bGxPckVtcHR5KHF1ZXJ5U3RyaW5nKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaHR0cFRhc2suVXJsID0gJCJ7YmFzZVVybH0/e3F1ZXJ5U3RyaW5nfSI7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFNldCBoZWFkZXJzCiAgICAgICAgICAgIHZhciBoZWFkZXJzID0gbmV3IERpY3Rpb25hcnk8c3RyaW5nLCBzdHJpbmc/PgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBbIlgtRGV2aWNlLUlkIl0gPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5kZXZpY2VJZCwKICAgICAgICAgICAgICAgIFsiWC1SZXF1ZXN0LUlkIl0gPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5yZXF1ZXN0SWQsCiAgICAgICAgICAgICAgICBbIlgtV29ya2Zsb3ctSW5zdGFuY2UiXSA9IGNvbnRleHQuSW5zdGFuY2U/LklkLlRvU3RyaW5nKCksCiAgICAgICAgICAgICAgICBbIkNvbnRlbnQtVHlwZSJdID0gImFwcGxpY2F0aW9uL2pzb24iCiAgICAgICAgICAgIH07CgogICAgICAgICAgICBodHRwVGFzay5TZXRIZWFkZXJzKGhlYWRlcnMpOwoKICAgICAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChuZXcgU2NyaXB0UmVzcG9uc2UoKSk7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChFeGNlcHRpb24gZXgpCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gVGFzay5Gcm9tUmVzdWx0KG5ldyBTY3JpcHRSZXNwb25zZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgLy8vIDxzdW1tYXJ5PgogICAgLy8vIFByb2Nlc3MgZGV2aWNlIHJlZ2lzdHJhdGlvbiBjaGVjayByZXN1bHQgYW5kIG1lcmdlIGl0IGludG8gdGhlIHdvcmtmbG93IGluc3RhbmNlCiAgICAvLy8gPC9zdW1tYXJ5PgogICAgcHVibGljIGFzeW5jIFRhc2s8U2NyaXB0UmVzcG9uc2U+IE91dHB1dEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICAgICAgdmFyIHN0YXR1c0NvZGUgPSBHZXRTdGF0dXNDb2RlRnJvbVJlc3BvbnNlKGNvbnRleHQpOwogICAgICAgICAgICB2YXIgcmVzcG9uc2VEYXRhID0gR2V0UmVzcG9uc2VEYXRhRnJvbUNvbnRleHQoY29udGV4dCk7CgogICAgICAgICAgICAvLyBTdWNjZXNzZnVsIGNoZWNrCiAgICAgICAgICAgIGlmIChzdGF0dXNDb2RlID49IDIwMCAmJiBzdGF0dXNDb2RlIDwgMzAwKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZGV2aWNlUmVnaXN0cmF0aW9uID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgY2hlY2tlZEF0ID0gRGF0ZVRpbWUuVXRjTm93LAogICAgICAgICAgICAgICAgICAgIGlzUmVnaXN0ZXJlZCA9IHJlc3BvbnNlRGF0YT8uaXNSZWdpc3RlcmVkID8/IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGRldmljZUlkID0gcmVzcG9uc2VEYXRhPy5kZXZpY2VJZCwKICAgICAgICAgICAgICAgICAgICBkZXZpY2VOYW1lID0gcmVzcG9uc2VEYXRhPy5kZXZpY2VOYW1lLAogICAgICAgICAgICAgICAgICAgIGRldmljZVR5cGUgPSByZXNwb25zZURhdGE/LmRldmljZVR5cGUgPz8gIm1vYmlsZSIsCiAgICAgICAgICAgICAgICAgICAgc3VwcG9ydHNQdXNoID0gcmVzcG9uc2VEYXRhPy5zdXBwb3J0c1B1c2ggPz8gZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgcmVnaXN0ZXJlZEF0ID0gcmVzcG9uc2VEYXRhPy5yZWdpc3RlcmVkQXQsCiAgICAgICAgICAgICAgICAgICAgbGFzdFNlZW5BdCA9IHJlc3BvbnNlRGF0YT8ubGFzdFNlZW5BdAogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFNjcmlwdFJlc3BvbnNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgRGF0YSA9IG5ldwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgZGV2aWNlUmVnaXN0cmF0aW9uID0gZGV2aWNlUmVnaXN0cmF0aW9uCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBlcnJvckluZm8gPSBFeHRyYWN0RXJyb3JJbmZvcm1hdGlvbihjb250ZXh0LCBzdGF0dXNDb2RlKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGRldmljZVJlZ2lzdHJhdGlvbiA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGNoZWNrZWRBdCA9IERhdGVUaW1lLlV0Y05vdywKICAgICAgICAgICAgICAgICAgICBpc1JlZ2lzdGVyZWQgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBlcnJvciA9IGVycm9ySW5mby5tZXNzYWdlLAogICAgICAgICAgICAgICAgICAgIGVycm9yQ29kZSA9IGVycm9ySW5mby5jb2RlLAogICAgICAgICAgICAgICAgICAgIGVycm9yRGVzY3JpcHRpb24gPSBlcnJvckluZm8uZGVzY3JpcHRpb24sCiAgICAgICAgICAgICAgICAgICAgc3RhdHVzQ29kZSA9IHN0YXR1c0NvZGUKICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTY3JpcHRSZXNwb25zZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIERhdGEgPSBuZXcKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRldmljZVJlZ2lzdHJhdGlvbiA9IGRldmljZVJlZ2lzdHJhdGlvbgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBleCkKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybiBuZXcgU2NyaXB0UmVzcG9uc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgRGF0YSA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGRldmljZVJlZ2lzdHJhdGlvbiA9IG5ldwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZEF0ID0gRGF0ZVRpbWUuVXRjTm93LAogICAgICAgICAgICAgICAgICAgICAgICBpc1JlZ2lzdGVyZWQgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSAiSW50ZXJuYWwgcHJvY2Vzc2luZyBlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yQ29kZSA9ICJwcm9jZXNzaW5nX2Vycm9yIiwKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JEZXNjcmlwdGlvbiA9IGV4Lk1lc3NhZ2UKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgfQogICAgfQoKICAgICNyZWdpb24gSGVscGVyIE1ldGhvZHMKCiAgICBwcml2YXRlIHN0YXRpYyBpbnQgR2V0U3RhdHVzQ29kZUZyb21SZXNwb25zZShTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgaWYgKGNvbnRleHQuQm9keT8uc3RhdHVzQ29kZSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gKGludCljb250ZXh0LkJvZHkuc3RhdHVzQ29kZTsKCiAgICAgICAgcmV0dXJuIDIwMDsKICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBkeW5hbWljPyBHZXRSZXNwb25zZURhdGFGcm9tQ29udGV4dChTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgaWYgKGNvbnRleHQuQm9keT8uZGF0YSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gY29udGV4dC5Cb2R5LmRhdGE7CgogICAgICAgIGlmIChjb250ZXh0LkJvZHkgIT0gbnVsbCAmJiBjb250ZXh0LkJvZHkuc3RhdHVzQ29kZSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gY29udGV4dC5Cb2R5OwoKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIAogICAgcHJpdmF0ZSBzdGF0aWMgKHN0cmluZyBtZXNzYWdlLCBzdHJpbmcgY29kZSwgc3RyaW5nIGRlc2NyaXB0aW9uKSBFeHRyYWN0RXJyb3JJbmZvcm1hdGlvbihTY3JpcHRDb250ZXh0IGNvbnRleHQsIGludCBzdGF0dXNDb2RlKQogICAgewogICAgICAgIHZhciBlcnJvckRhdGEgPSBjb250ZXh0LkJvZHk/LmRhdGE/LmVycm9yID8/IG51bGw7CiAgICAgICAgCiAgICAgICAgc3RyaW5nIG1lc3NhZ2UgPSAiRGV2aWNlIHZhbGlkYXRpb24gZmFpbGVkIjsKICAgICAgICBzdHJpbmcgY29kZSA9ICJpbnZhbGlkX2RldmljZSI7CiAgICAgICAgc3RyaW5nIGRlc2NyaXB0aW9uID0gIlRoZSBkZXZpY2UgY3JlZGVudGlhbHMgcHJvdmlkZWQgYXJlIGludmFsaWQiOwoKICAgICAgICBpZiAoZXJyb3JEYXRhICE9IG51bGwpCiAgICAgICAgewogICAgICAgICAgICBtZXNzYWdlID0gZXJyb3JEYXRhLm1lc3NhZ2UgPz8gbWVzc2FnZTsKICAgICAgICAgICAgY29kZSA9IGVycm9yRGF0YS5jb2RlID8/IGNvZGU7CiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gZXJyb3JEYXRhLmRlc2NyaXB0aW9uID8/IGRlc2NyaXB0aW9uOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChzdGF0dXNDb2RlID09IDQwMSkKICAgICAgICB7CiAgICAgICAgICAgIGNvZGUgPSAidW5hdXRob3JpemVkX2RldmljZSI7CiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gIkRldmljZSBhdXRoZW50aWNhdGlvbiBmYWlsZWQiOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChzdGF0dXNDb2RlID09IDQwMykKICAgICAgICB7CiAgICAgICAgICAgIGNvZGUgPSAiYWNjZXNzX2RlbmllZCI7CiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gIkRldmljZSBhY2Nlc3MgZGVuaWVkIjsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoc3RhdHVzQ29kZSA+PSA1MDApCiAgICAgICAgewogICAgICAgICAgICBjb2RlID0gInNlcnZlcl9lcnJvciI7CiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gIkludGVybmFsIHNlcnZlciBlcnJvciBkdXJpbmcgZGV2aWNlIHZhbGlkYXRpb24iOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIChtZXNzYWdlLCBjb2RlLCBkZXNjcmlwdGlvbik7CiAgICB9CiAgICAKCiAgICAjZW5kcmVnaW9uCn0=\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"device-registered-push\",\n            \"target\": \"push-notification-mfa\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Device Registered - Push Notification\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Cihaz Kayıtlı - Push Bildirimi\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/DeviceRegisteredPushRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCi8vLyA8c3VtbWFyeT4KLy8vIERldmljZSBSZWdpc3RlcmVkIFB1c2ggUnVsZSAtIERldmljZSByZWdpc3RlcmVkIGFuZCBwdXNoIHN1cHBvcnRlZCBjb25kaXRpb24gbWFwcGluZwovLyBUaGlzIHJ1bGUgY2hlY2tzIHdoZXRoZXIgdGhlIGRldmljZSBpcyByZWdpc3RlcmVkIGFuZCBzdXBwb3J0cyBwdXNoIG5vdGlmaWNhdGlvbnMuCi8vLyA8L3N1bW1hcnk+CnB1YmxpYyBjbGFzcyBEZXZpY2VSZWdpc3RlcmVkUHVzaFJ1bGUgOiBJQ29uZGl0aW9uTWFwcGluZwp7CiAgICAvLy8gPHN1bW1hcnk+CiAgICAvLy8gQ2hlY2sgaWYgdGhlIGRldmljZSBpcyByZWdpc3RlcmVkIGFuZCBzdXBwb3J0cyBwdXNoIG5vdGlmaWNhdGlvbnMKICAgIC8vLyA8L3N1bW1hcnk+CiAgICBwdWJsaWMgYXN5bmMgVGFzazxib29sPiBIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICB0cnkKICAgICAgICB7CiAgICAgICAgICAgIC8vIE51bGwgY2hlY2sKICAgICAgICAgICAgaWYgKGNvbnRleHQ/Lkluc3RhbmNlPy5EYXRhID09IG51bGwpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gR2V0IGRldmljZSByZWdpc3RyYXRpb24gZGF0YQogICAgICAgICAgICB2YXIgZGV2aWNlUmVnaXN0cmF0aW9uID0gY29udGV4dC5JbnN0YW5jZS5EYXRhLmRldmljZVJlZ2lzdHJhdGlvbjsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChkZXZpY2VSZWdpc3RyYXRpb24gPT0gbnVsbCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBCYXNpYyByZWdpc3RyYXRpb24gY2hlY2sKICAgICAgICAgICAgdmFyIGlzUmVnaXN0ZXJlZCA9IGRldmljZVJlZ2lzdHJhdGlvbi5pc1JlZ2lzdGVyZWQ7CiAgICAgICAgICAgIGlmIChpc1JlZ2lzdGVyZWQgIT0gdHJ1ZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBQdXNoIHN1cHBvcnQgY2hlY2sKICAgICAgICAgICAgdmFyIHN1cHBvcnRzUHVzaCA9IGRldmljZVJlZ2lzdHJhdGlvbi5zdXBwb3J0c1B1c2g7CiAgICAgICAgICAgIGlmIChzdXBwb3J0c1B1c2ggIT0gdHJ1ZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBBZGRpdGlvbmFsIHNlY3VyaXR5IGNoZWNrcwogICAgICAgICAgICAvLyBEZXZpY2UgSUQgY2hlY2sKICAgICAgICAgICAgdmFyIGRldmljZUlkID0gZGV2aWNlUmVnaXN0cmF0aW9uLmRldmljZUlkOwogICAgICAgICAgICBpZiAoc3RyaW5nLklzTnVsbE9yRW1wdHkoZGV2aWNlSWQ/LlRvU3RyaW5nKCkpKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIExhc3Qgc2VlbiB0aW1lIGNoZWNrICgzMCBkYXlzKQogICAgICAgICAgICAvLyB2YXIgbGFzdFNlZW5BdCA9IGRldmljZVJlZ2lzdHJhdGlvbi5sYXN0U2VlbkF0OwogICAgICAgICAgICAvLyBpZiAobGFzdFNlZW5BdCAhPSBudWxsKQogICAgICAgICAgICAvLyB7CiAgICAgICAgICAgIC8vICAgICBpZiAoRGF0ZVRpbWUuVHJ5UGFyc2UobGFzdFNlZW5BdC5Ub1N0cmluZygpLCBvdXQgRGF0ZVRpbWUgbGFzdFNlZW4pKQogICAgICAgICAgICAvLyAgICAgewogICAgICAgICAgICAvLyAgICAgICAgIGlmIChEYXRlVGltZS5VdGNOb3cuU3VidHJhY3QobGFzdFNlZW4pLlRvdGFsRGF5cyA+IDMwKQogICAgICAgICAgICAvLyAgICAgICAgIHsKICAgICAgICAgICAgLy8gICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAvLyAgICAgICAgIH0KICAgICAgICAgICAgLy8gICAgIH0KICAgICAgICAgICAgLy8gfQoKICAgICAgICAgICAgLy8gLy8gUmVnaXN0cmF0aW9uIHRpbWUgY2hlY2sgKDYgbW9udGhzKQogICAgICAgICAgICAvLyB2YXIgcmVnaXN0ZXJlZEF0ID0gZGV2aWNlUmVnaXN0cmF0aW9uLnJlZ2lzdGVyZWRBdDsKICAgICAgICAgICAgLy8gaWYgKHJlZ2lzdGVyZWRBdCAhPSBudWxsKQogICAgICAgICAgICAvLyB7CiAgICAgICAgICAgIC8vICAgICBpZiAoRGF0ZVRpbWUuVHJ5UGFyc2UocmVnaXN0ZXJlZEF0LlRvU3RyaW5nKCksIG91dCBEYXRlVGltZSByZWdUaW1lKSkKICAgICAgICAgICAgLy8gICAgIHsKICAgICAgICAgICAgLy8gICAgICAgICBpZiAoRGF0ZVRpbWUuVXRjTm93LlN1YnRyYWN0KHJlZ1RpbWUpLlRvdGFsRGF5cyA+IDE4MCkKICAgICAgICAgICAgLy8gICAgICAgICB7CiAgICAgICAgICAgIC8vICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgLy8gICAgICAgICB9CiAgICAgICAgICAgIC8vICAgICB9CiAgICAgICAgICAgIC8vIH0KCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgICAgIHsKICAgICAgICAgICAgLy8gSWYgYW4gZXhjZXB0aW9uIG9jY3VycywgcmV0dXJuIGZhbHNlIGFuZCB3cml0ZSB0byBhdWRpdCBsb2cKICAgICAgICAgICAgaWYgKGNvbnRleHQ/Lk1ldGFEYXRhICE9IG51bGwpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNvbnRleHQuTWV0YURhdGFbImRldmljZV9yZWdpc3RlcmVkX3B1c2hfcnVsZV9lcnJvciJdID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBleC5NZXNzYWdlLAogICAgICAgICAgICAgICAgICAgIHR5cGUgPSBleC5HZXRUeXBlKCkuTmFtZSwKICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXAgPSBEYXRlVGltZS5VdGNOb3cKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9Cn0=\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"device-not-registered-otp\",\n            \"target\": \"otp-mfa\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Device Not Registered - OTP\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Cihaz Kayıtlı Değil - OTP\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/DeviceNotRegisteredOtpRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBEZXZpY2VOb3RSZWdpc3RlcmVkT3RwUnVsZSA6IElDb25kaXRpb25NYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHJldHVybiBjb250ZXh0Lkluc3RhbmNlLkRhdGEuZGV2aWNlUmVnaXN0cmF0aW9uLmlzUmVnaXN0ZXJlZCA9PSBmYWxzZTsKICAgIH0KfQ==\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"push-notification-mfa\",\n        \"stateType\": 4,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Push Notification MFA\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Push Bildirimi MFA\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": {\n          \"type\": \"S\",\n          \"process\": {\n            \"key\": \"push-notification-mfa-subflow\",\n            \"domain\": \"{{domain}}\",\n            \"version\": \"1.0.0\",\n            \"flow\": \"sys-flows\"\n          },\n          \"mapping\": {\n            \"location\": \"./src/PushNotificationMfaSubflowMapping.csx\",\n            \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBQdXNoTm90aWZpY2F0aW9uTWZhU3ViZmxvd01hcHBpbmcgOiBJU3ViRmxvd01hcHBpbmcKewogICAgcHVibGljIFRhc2s8U2NyaXB0UmVzcG9uc2U+IElucHV0SGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChuZXcgU2NyaXB0UmVzcG9uc2UKICAgICAgICB7CiAgICAgICAgICAgIERhdGEgPSBjb250ZXh0Lkluc3RhbmNlLkRhdGEsCiAgICAgICAgICAgIEhlYWRlcnMgPSBudWxsCiAgICAgICAgfSk7CiAgICB9CgogICAgcHVibGljIFRhc2s8U2NyaXB0UmVzcG9uc2U+IE91dHB1dEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHJldHVybiBUYXNrLkZyb21SZXN1bHQobmV3IFNjcmlwdFJlc3BvbnNlCiAgICAgICAgewogICAgICAgICAgICBEYXRhID0gY29udGV4dC5Cb2R5LAogICAgICAgICAgICBIZWFkZXJzID0gbnVsbAogICAgICAgIH0pOwogICAgfQp9\"\n          }\n        },\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"push-mfa-success\",\n            \"target\": \"token-generation\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Push MFA Success\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Push MFA Başarılı\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/MfaSuccessRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBNZmFTdWNjZXNzUnVsZSA6IElDb25kaXRpb25NYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHJldHVybiBjb250ZXh0Lkluc3RhbmNlLkRhdGEubWZhLnN1Y2Nlc3MgPT0gdHJ1ZTsKICAgIH0KfQ==\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"push-mfa-failed\",\n            \"target\": \"authentication-failed\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Push MFA Failed\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Push MFA Başarısız\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/MfaFailedRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBNZmFGYWlsZWRSdWxlIDogSUNvbmRpdGlvbk1hcHBpbmcKewogICAgcHVibGljIGFzeW5jIFRhc2s8Ym9vbD4gSGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgcmV0dXJuIGNvbnRleHQuSW5zdGFuY2UuRGF0YS5tZmEuc3VjY2VzcyA9PSBmYWxzZTsKICAgIH0KfQ==\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"otp-mfa\",\n        \"stateType\": 4,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"OTP Multi-Factor Authentication\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"OTP Çok Faktörlü Kimlik Doğrulama\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": {\n          \"type\": \"S\",\n          \"process\": {\n            \"key\": \"otp-mfa-subflow\",\n            \"domain\": \"{{domain}}\",\n            \"version\": \"1.0.0\",\n            \"flow\": \"sys-flows\"\n          },\n          \"mapping\": {\n            \"location\": \"./src/OtpMfaSubflowMapping.csx\",\n            \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBPdHBNZmFTdWJmbG93TWFwcGluZyA6IElTdWJGbG93TWFwcGluZwp7CiAgICBwdWJsaWMgVGFzazxTY3JpcHRSZXNwb25zZT4gSW5wdXRIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICByZXR1cm4gVGFzay5Gcm9tUmVzdWx0KG5ldyBTY3JpcHRSZXNwb25zZQogICAgICAgIHsKICAgICAgICAgICAgRGF0YSA9IGNvbnRleHQuSW5zdGFuY2UuRGF0YSwKICAgICAgICAgICAgSGVhZGVycyA9IG51bGwKICAgICAgICB9KTsKICAgIH0KCiAgICBwdWJsaWMgVGFzazxTY3JpcHRSZXNwb25zZT4gT3V0cHV0SGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChuZXcgU2NyaXB0UmVzcG9uc2UKICAgICAgICB7CiAgICAgICAgICAgIERhdGEgPSBjb250ZXh0LkJvZHksCiAgICAgICAgICAgIEhlYWRlcnMgPSBudWxsCiAgICAgICAgfSk7CiAgICB9Cn0=\"\n          }\n        },\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"otp-mfa-success\",\n            \"target\": \"device-registration\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"OTP MFA Success - Register Device\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"OTP MFA Başarılı - Cihaz Kaydet\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/MfaSuccessRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBNZmFTdWNjZXNzUnVsZSA6IElDb25kaXRpb25NYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHJldHVybiBjb250ZXh0Lkluc3RhbmNlLkRhdGEubWZhLnN1Y2Nlc3MgPT0gdHJ1ZTsKICAgIH0KfQ==\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"otp-mfa-failed\",\n            \"target\": \"authentication-failed\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"OTP MFA Failed\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"OTP MFA Başarısız\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/MfaFailedRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBNZmFGYWlsZWRSdWxlIDogSUNvbmRpdGlvbk1hcHBpbmcKewogICAgcHVibGljIGFzeW5jIFRhc2s8Ym9vbD4gSGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgcmV0dXJuIGNvbnRleHQuSW5zdGFuY2UuRGF0YS5tZmEuc3VjY2VzcyA9PSBmYWxzZTsKICAgIH0KfQ==\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"device-registration\",\n        \"stateType\": 2,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Device Registration\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Cihaz Kaydı\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"register-device\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/RegisterDeviceMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKcHVibGljIGNsYXNzIFJlZ2lzdGVyRGV2aWNlTWFwcGluZyA6IElNYXBwaW5nCnsKICAgIHB1YmxpYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBJbnB1dEhhbmRsZXIoV29ya2Zsb3dUYXNrIHRhc2ssIFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICB2YXIgaHR0cFRhc2sgPSB0YXNrIGFzIEh0dHBUYXNrOwogICAgICAgIHZhciBkZXZpY2VEYXRhID0gbmV3CiAgICAgICAgewogICAgICAgICAgICB1c2VySWQgPSBjb250ZXh0Lkluc3RhbmNlLkRhdGE/LmF1dGhlbnRpY2F0aW9uPy51c2VySWQsCiAgICAgICAgICAgIGRldmljZUlkID0gY29udGV4dC5JbnN0YW5jZT8uRGF0YT8uZGV2aWNlSWQsCiAgICAgICAgICAgIGRldmljZU5hbWUgPSBjb250ZXh0LkJvZHk/LmRldmljZU5hbWUgPz8gIlVua25vd24gRGV2aWNlIiwKICAgICAgICAgICAgZGV2aWNlVHlwZSA9IGNvbnRleHQuQm9keT8uZGV2aWNlVHlwZSA/PyAibW9iaWxlIiwKICAgICAgICAgICAgc3VwcG9ydHNQdXNoID0gdHJ1ZQogICAgICAgIH07CiAgICAgICAgaHR0cFRhc2suU2V0Qm9keShkZXZpY2VEYXRhKTsKICAgICAgICB2YXIgaGVhZGVycyA9IG5ldyBEaWN0aW9uYXJ5PHN0cmluZywgc3RyaW5nPz4KICAgICAgICB7CiAgICAgICAgICAgIFsiQ29udGVudC1UeXBlIl0gPSAiYXBwbGljYXRpb24vanNvbiIKICAgICAgICB9OwogICAgICAgIGh0dHBUYXNrLlNldEhlYWRlcnMoaGVhZGVycyk7CiAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChuZXcgU2NyaXB0UmVzcG9uc2UKICAgICAgICB7CiAgICAgICAgICAgIERhdGEgPSBjb250ZXh0Lkluc3RhbmNlLkRhdGEsCiAgICAgICAgICAgIEhlYWRlcnMgPSBudWxsCiAgICAgICAgfSk7CiAgICB9CgogICAgcHVibGljIGFzeW5jIFRhc2s8U2NyaXB0UmVzcG9uc2U+IE91dHB1dEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHZhciByZXNwb25zZSA9IG5ldyBTY3JpcHRSZXNwb25zZSgpOwogICAgICAgIHZhciBzdGF0dXNDb2RlID0gY29udGV4dC5Cb2R5LnN0YXR1c0NvZGUgPz8gNTAwOwoKICAgICAgICBpZiAoc3RhdHVzQ29kZSA9PSAyMDAgfHwgc3RhdHVzQ29kZSA9PSAyMDEpCiAgICAgICAgewogICAgICAgICAgICByZXNwb25zZS5EYXRhID0gbmV3CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGRldmljZVJlZ2lzdHJhdGlvbiA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSB0cnVlLAogICAgICAgICAgICAgICAgICAgIGRldmljZUlkID0gY29udGV4dC5Cb2R5LmRhdGE/LmRldmljZUlkLAogICAgICAgICAgICAgICAgICAgIGlzUmVnaXN0ZXJlZCA9IHRydWUsCiAgICAgICAgICAgICAgICAgICAgc3VwcG9ydHNQdXNoID0gdHJ1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICByZXNwb25zZS5EYXRhID0gbmV3CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGRldmljZVJlZ2lzdHJhdGlvbiA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBlcnJvciA9ICJEZXZpY2UgcmVnaXN0cmF0aW9uIGZhaWxlZCIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXNwb25zZTsKICAgIH0KfQ==\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"device-registered\",\n            \"target\": \"token-generation\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Device Registered Successfully\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Cihaz Başarıyla Kaydedildi\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/DeviceRegisteredRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBEZXZpY2VSZWdpc3RlcmVkUnVsZSA6IElDb25kaXRpb25NYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHJldHVybiBjb250ZXh0Lkluc3RhbmNlLkRhdGEuZGV2aWNlUmVnaXN0cmF0aW9uLnN1Y2Nlc3MgPT0gdHJ1ZTsKICAgIH0KfQ==\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"token-generation\",\n        \"stateType\": 2,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Token Generation\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Token Oluşturma\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"generate-tokens\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/GenerateTokensMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKLy8vIDxzdW1tYXJ5PgovLy8gR2VuZXJhdGUgVG9rZW5zIE1hcHBpbmcgLSBPQXV0aDIgdG9rZW4gZ2VuZXJhdGlvbiBtYXBwaW5nCi8vIFRoaXMgbWFwcGluZyBpcyB1c2VkIHRvIGdlbmVyYXRlIGFjY2VzcyBhbmQgcmVmcmVzaCB0b2tlbnMgYWZ0ZXIgdGhlIGF1dGhlbnRpY2F0aW9uIHByb2Nlc3MgaXMgY29tcGxldGUuCi8vLyA8L3N1bW1hcnk+CnB1YmxpYyBjbGFzcyBHZW5lcmF0ZVRva2Vuc01hcHBpbmcgOiBJTWFwcGluZwp7CiAgICAvLy8gPHN1bW1hcnk+CiAgICAvLy8gUHJlcGFyaW5nIGlucHV0IGZvciB0b2tlbiBjcmVhdGlvbiByZXF1ZXN0CiAgICAvLy8gPC9zdW1tYXJ5PgogICAgcHVibGljIFRhc2s8U2NyaXB0UmVzcG9uc2U+IElucHV0SGFuZGxlcihXb3JrZmxvd1Rhc2sgdGFzaywgU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICAgICAgdmFyIGh0dHBUYXNrID0gdGFzayBhcyBIdHRwVGFzazsKICAgICAgICAgICAgaWYgKGh0dHBUYXNrID09IG51bGwpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXhjZXB0aW9uKCJUYXNrIG11c3QgYmUgYW4gSHR0cFRhc2sgZm9yIHRva2VuIGdlbmVyYXRpb24iKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gR2F0aGVyIGFsbCBpbmZvcm1hdGlvbiBmcm9tIHRoZSB3b3JrZmxvdyBjb250ZXh0CiAgICAgICAgICAgIHZhciBjbGllbnREYXRhID0gY29udGV4dC5JbnN0YW5jZT8uRGF0YT8uY2xpZW50VmFsaWRhdGlvbjsKICAgICAgICAgICAgdmFyIGF1dGhEYXRhID0gY29udGV4dC5JbnN0YW5jZT8uRGF0YT8uYXV0aGVudGljYXRpb247CiAgICAgICAgICAgIHZhciBtZmFEYXRhID0gY29udGV4dC5JbnN0YW5jZT8uRGF0YT8ubWZhOwogICAgICAgICAgICB2YXIgZGV2aWNlRGF0YSA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LmRldmljZVJlZ2lzdHJhdGlvbjsKCiAgICAgICAgICAgIC8vIFRva2VuIGdlbmVyYXRpb24gcmVxdWVzdCBib2R5CiAgICAgICAgICAgIHZhciByZXF1ZXN0Qm9keSA9IG5ldwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAvLyBDbGllbnQgaW5mb3JtYXRpb24KICAgICAgICAgICAgICAgIGNsaWVudF9pZCA9IGNsaWVudERhdGE/LmNsaWVudElkLAogICAgICAgICAgICAgICAgY2xpZW50X3NlY3JldCA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LmNsaWVudF9zZWNyZXQsCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIEdyYW50IHR5cGUgYW5kIHVzZXIgaW5mb3JtYXRpb24KICAgICAgICAgICAgICAgIGdyYW50X3R5cGUgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5ncmFudF90eXBlLAogICAgICAgICAgICAgICAgdXNlcl9pZCA9IGF1dGhEYXRhPy51c2VySWQsCiAgICAgICAgICAgICAgICB1c2VybmFtZSA9IGF1dGhEYXRhPy51c2VybmFtZSwKICAgICAgICAgICAgICAgIGVtYWlsID0gYXV0aERhdGE/LmVtYWlsLAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBTY29wZSB2ZSBwZXJtaXNzaW9ucwogICAgICAgICAgICAgICAgc2NvcGUgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5zY29wZSwKICAgICAgICAgICAgICAgIHVzZXJfcm9sZXMgPSBhdXRoRGF0YT8ucm9sZXMgPz8gbmV3W10geyAicmV0YWlsLXVzZXIiIH0sIAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBEZXZpY2UgY29udGV4dAogICAgICAgICAgICAgICAgZGV2aWNlX2lkID0gZGV2aWNlRGF0YT8uZGV2aWNlSWQsCiAgICAgICAgICAgICAgICBkZXZpY2VfcmVnaXN0ZXJlZCA9IGRldmljZURhdGE/LmlzUmVnaXN0ZXJlZCwKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gTUZBIGNvbnRleHQKICAgICAgICAgICAgICAgIG1mYV9jb21wbGV0ZWQgPSBtZmFEYXRhPy5zdWNjZXNzID8/IGZhbHNlLAogICAgICAgICAgICAgICAgbWZhX21ldGhvZCA9IG1mYURhdGE/Lm1ldGhvZCA/PyAibm9uZSIsCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIFNlY3VyaXR5IGNvbnRleHQKICAgICAgICAgICAgICAgIGlwX2FkZHJlc3MgPSBjb250ZXh0LkhlYWRlcnM/WyJ4LWZvcndhcmRlZC1mb3IiXSA/PyBjb250ZXh0LkhlYWRlcnM/WyJ4LXJlYWwtaXAiXSwKICAgICAgICAgICAgICAgIHVzZXJfYWdlbnQgPSBjb250ZXh0LkhlYWRlcnM/WyJ1c2VyLWFnZW50Il0KICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGh0dHBUYXNrLlNldEJvZHkocmVxdWVzdEJvZHkpOwoKICAgICAgICAgICAgLy8gU2V0IEhlYWRlcnMKICAgICAgICAgICAgdmFyIGhlYWRlcnMgPSBuZXcgRGljdGlvbmFyeTxzdHJpbmcsIHN0cmluZz8+CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFsiWC1SZXF1ZXN0LUlkIl0gPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5kZXZpY2VJZCwKICAgICAgICAgICAgICAgIFsiQ29udGVudC1UeXBlIl0gPSAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICAgICBbIlgtV29ya2Zsb3ctSW5zdGFuY2UiXSA9IGNvbnRleHQuSW5zdGFuY2U/LklkLlRvU3RyaW5nKCksCiAgICAgICAgICAgICAgICBbIlgtVXNlci1JZCJdID0gcmVxdWVzdEJvZHkudXNlcl9pZD8uVG9TdHJpbmcoKSwKICAgICAgICAgICAgICAgIFsiWC1EZXZpY2UtSWQiXSA9IHJlcXVlc3RCb2R5LmRldmljZV9pZCwKICAgICAgICAgICAgICAgIFsiWC1HcmFudC1UeXBlIl0gPSByZXF1ZXN0Qm9keS5ncmFudF90eXBlCiAgICAgICAgICAgIH07CgogICAgICAgICAgICBodHRwVGFzay5TZXRIZWFkZXJzKGhlYWRlcnMpOwoKICAgICAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChuZXcgU2NyaXB0UmVzcG9uc2UoKSk7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChFeGNlcHRpb24gZXgpCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gVGFzay5Gcm9tUmVzdWx0KG5ldyBTY3JpcHRSZXNwb25zZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBLZXkgPSAidG9rZW4tZ2VuZXJhdGlvbi1pbnB1dC1lcnJvciIsCiAgICAgICAgICAgICAgICBEYXRhID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBuZXcKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBleC5NZXNzYWdlLAogICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gZXguR2V0VHlwZSgpLk5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcCA9IERhdGVUaW1lLlV0Y05vdywKICAgICAgICAgICAgICAgICAgICAgICAgd29ya2Zsb3dfaW5zdGFuY2UgPSBjb250ZXh0Lkluc3RhbmNlPy5JZAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBUYWdzID0gbmV3W10geyAib2F1dGgyIiwgInRva2VuLWdlbmVyYXRpb24iLCAiaW5wdXQtZXJyb3IiIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfQoKICAgIC8vLyA8c3VtbWFyeT4KICAgLy8vIFByb2Nlc3MgdGhlIHRva2VuIGNyZWF0aW9uIHJlc3VsdCBhbmQgbWVyZ2UgaXQgaW50byB0aGUgd29ya2Zsb3cgaW5zdGFuY2UKICAgIC8vLyA8L3N1bW1hcnk+CiAgICBwdWJsaWMgYXN5bmMgVGFzazxTY3JpcHRSZXNwb25zZT4gT3V0cHV0SGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgdHJ5CiAgICAgICAgewogICAgICAgICAgICB2YXIgc3RhdHVzQ29kZSA9IEdldFN0YXR1c0NvZGVGcm9tUmVzcG9uc2UoY29udGV4dCk7CiAgICAgICAgICAgIHZhciByZXNwb25zZURhdGEgPSBHZXRSZXNwb25zZURhdGFGcm9tQ29udGV4dChjb250ZXh0KTsKCiAgICAgICAgICAgLy8gU3VjY2Vzc2Z1bCB0b2tlbiBnZW5lcmF0aW9uCiAgICAgICAgICAgIGlmIChzdGF0dXNDb2RlID49IDIwMCAmJiBzdGF0dXNDb2RlIDwgMzAwKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgdG9rZW5zID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IHRydWUsCiAgICAgICAgICAgICAgICAgICAgZ2VuZXJhdGVkX2F0ID0gRGF0ZVRpbWUuVXRjTm93LAogICAgICAgICAgICAgICAgICAgIGFjY2Vzc190b2tlbiA9IHJlc3BvbnNlRGF0YT8uYWNjZXNzX3Rva2VuLAogICAgICAgICAgICAgICAgICAgIHJlZnJlc2hfdG9rZW4gPSByZXNwb25zZURhdGE/LnJlZnJlc2hfdG9rZW4sCiAgICAgICAgICAgICAgICAgICAgdG9rZW5fdHlwZSA9IHJlc3BvbnNlRGF0YT8udG9rZW5fdHlwZSA/PyAiQmVhcmVyIiwKICAgICAgICAgICAgICAgICAgICBleHBpcmVzX2luID0gcmVzcG9uc2VEYXRhPy5leHBpcmVzX2luLAogICAgICAgICAgICAgICAgICAgIHNjb3BlID0gcmVzcG9uc2VEYXRhPy5zY29wZQogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFNjcmlwdFJlc3BvbnNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgS2V5ID0gInRva2VuLWdlbmVyYXRpb24tc3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgRGF0YSA9IG5ldwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW5zID0gdG9rZW5zCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBUYWdzID0gbmV3W10geyAib2F1dGgyIiwgInRva2VuLWdlbmVyYXRpb24iLCAic3VjY2VzcyIsICJhdXRoZW50aWNhdGlvbi1jb21wbGV0ZWQiLCAidG9rZW5zLWlzc3VlZCIgfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBlcnJvckluZm8gPSBFeHRyYWN0RXJyb3JJbmZvcm1hdGlvbihjb250ZXh0LCBzdGF0dXNDb2RlKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIHRva2VucyA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBnZW5lcmF0ZWRfYXQgPSBEYXRlVGltZS5VdGNOb3csCiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBlcnJvckluZm8ubWVzc2FnZSwKICAgICAgICAgICAgICAgICAgICBlcnJvcl9jb2RlID0gZXJyb3JJbmZvLmNvZGUsCiAgICAgICAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb24gPSBlcnJvckluZm8uZGVzY3JpcHRpb24sCiAgICAgICAgICAgICAgICAgICAgc3RhdHVzX2NvZGUgPSBzdGF0dXNDb2RlLAogICAgICAgICAgICAgICAgICAgIC8vIE1ldGFkYXRhCiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdF9pZCA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LmRldmljZUlkCiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU2NyaXB0UmVzcG9uc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBLZXkgPSAidG9rZW4tZ2VuZXJhdGlvbi1mYWlsdXJlIiwKICAgICAgICAgICAgICAgICAgICBEYXRhID0gbmV3CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB0b2tlbnMgPSB0b2tlbnMKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIFRhZ3MgPSBuZXdbXSB7ICJvYXV0aDIiLCAidG9rZW4tZ2VuZXJhdGlvbiIsICJmYWlsdXJlIiwgImVycm9yIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYXV0aGVudGljYXRpb24tZmFpbGVkIiwgInRva2Vucy1ub3QtaXNzdWVkIiB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNhdGNoIChFeGNlcHRpb24gZXgpCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gbmV3IFNjcmlwdFJlc3BvbnNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIEtleSA9ICJ0b2tlbi1nZW5lcmF0aW9uLW91dHB1dC1lcnJvciIsCiAgICAgICAgICAgICAgICBEYXRhID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdG9rZW5zID0gbmV3CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gIkludGVybmFsIHByb2Nlc3NpbmcgZXJyb3IiLAogICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl9jb2RlID0gInByb2Nlc3NpbmdfZXJyb3IiLAogICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl9kZXNjcmlwdGlvbiA9IGV4Lk1lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgICAgIGdlbmVyYXRlZF9hdCA9IERhdGVUaW1lLlV0Y05vdwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBUYWdzID0gbmV3W10geyAib2F1dGgyIiwgInRva2VuLWdlbmVyYXRpb24iLCAiZXJyb3IiLCAiZXhjZXB0aW9uIiwgInByb2Nlc3NpbmctZXJyb3IiIH0KICAgICAgICAgICAgfTsKICAgICAgICB9CiAgICB9CgogICAgI3JlZ2lvbiBIZWxwZXIgTWV0aG9kcwoKICAgIHByaXZhdGUgc3RhdGljIGludCBHZXRTdGF0dXNDb2RlRnJvbVJlc3BvbnNlKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICBpZiAoY29udGV4dC5Cb2R5Py5zdGF0dXNDb2RlICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiAoaW50KWNvbnRleHQuQm9keS5zdGF0dXNDb2RlOwoKICAgICAgICByZXR1cm4gMjAwOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGR5bmFtaWM/IEdldFJlc3BvbnNlRGF0YUZyb21Db250ZXh0KFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICBpZiAoY29udGV4dC5Cb2R5Py5kYXRhICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiBjb250ZXh0LkJvZHkuZGF0YTsKCiAgICAgICAgaWYgKGNvbnRleHQuQm9keSAhPSBudWxsICYmIGNvbnRleHQuQm9keS5zdGF0dXNDb2RlID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBjb250ZXh0LkJvZHk7CgogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIChzdHJpbmcgbWVzc2FnZSwgc3RyaW5nIGNvZGUsIHN0cmluZyBkZXNjcmlwdGlvbikgRXh0cmFjdEVycm9ySW5mb3JtYXRpb24oU2NyaXB0Q29udGV4dCBjb250ZXh0LCBpbnQgc3RhdHVzQ29kZSkKICAgIHsKICAgICAgICB2YXIgZXJyb3JEYXRhID0gY29udGV4dC5Cb2R5Py5lcnJvciA/PyBjb250ZXh0LkJvZHk/LmRhdGE/LmVycm9yOwogICAgICAgIAogICAgICAgIHN0cmluZyBtZXNzYWdlID0gIlRva2VuIGdlbmVyYXRpb24gZmFpbGVkIjsKICAgICAgICBzdHJpbmcgY29kZSA9ICJ0b2tlbl9nZW5lcmF0aW9uX2Vycm9yIjsKICAgICAgICBzdHJpbmcgZGVzY3JpcHRpb24gPSAiVW5hYmxlIHRvIGdlbmVyYXRlIGFjY2VzcyB0b2tlbnMiOwoKICAgICAgICBpZiAoZXJyb3JEYXRhICE9IG51bGwpCiAgICAgICAgewogICAgICAgICAgICBtZXNzYWdlID0gZXJyb3JEYXRhLm1lc3NhZ2UgPz8gZXJyb3JEYXRhLmVycm9yID8/IG1lc3NhZ2U7CiAgICAgICAgICAgIGNvZGUgPSBlcnJvckRhdGEuY29kZSA/PyBlcnJvckRhdGEuZXJyb3JfY29kZSA/PyBjb2RlOwogICAgICAgICAgICBkZXNjcmlwdGlvbiA9IGVycm9yRGF0YS5kZXNjcmlwdGlvbiA/PyBlcnJvckRhdGEuZXJyb3JfZGVzY3JpcHRpb24gPz8gZGVzY3JpcHRpb247CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKHN0YXR1c0NvZGUgPT0gNDAwKQogICAgICAgIHsKICAgICAgICAgICAgY29kZSA9ICJpbnZhbGlkX3JlcXVlc3QiOwogICAgICAgICAgICBkZXNjcmlwdGlvbiA9ICJJbnZhbGlkIHRva2VuIGdlbmVyYXRpb24gcmVxdWVzdCI7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKHN0YXR1c0NvZGUgPT0gNDAxKQogICAgICAgIHsKICAgICAgICAgICAgY29kZSA9ICJpbnZhbGlkX2NsaWVudCI7CiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gIkNsaWVudCBhdXRoZW50aWNhdGlvbiBmYWlsZWQgZHVyaW5nIHRva2VuIGdlbmVyYXRpb24iOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChzdGF0dXNDb2RlID09IDQwMykKICAgICAgICB7CiAgICAgICAgICAgIGNvZGUgPSAiYWNjZXNzX2RlbmllZCI7CiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gIkFjY2VzcyBkZW5pZWQgZm9yIHRva2VuIGdlbmVyYXRpb24iOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChzdGF0dXNDb2RlID49IDUwMCkKICAgICAgICB7CiAgICAgICAgICAgIGNvZGUgPSAic2VydmVyX2Vycm9yIjsKICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAiSW50ZXJuYWwgc2VydmVyIGVycm9yIGR1cmluZyB0b2tlbiBnZW5lcmF0aW9uIjsKICAgICAgICB9CgogICAgICAgIHJldHVybiAobWVzc2FnZSwgY29kZSwgZGVzY3JpcHRpb24pOwogICAgfQoKICAgICNlbmRyZWdpb24KfQ==\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"tokens-generated\",\n            \"target\": \"authentication-success\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Tokens Generated Successfully\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Token'lar Başarıyla Oluşturuldu\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/TokensGeneratedRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBUb2tlbnNHZW5lcmF0ZWRSdWxlIDogSUNvbmRpdGlvbk1hcHBpbmcKewogICAgcHVibGljIGFzeW5jIFRhc2s8Ym9vbD4gSGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgcmV0dXJuIGNvbnRleHQuSW5zdGFuY2UuRGF0YS50b2tlbnMuc3VjY2VzcyA9PSB0cnVlOwogICAgfQp9\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"token-generation-failed\",\n            \"target\": \"authentication-failed\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Token Generation Failed\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Token Oluşturma Başarısız\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/TokenGenerationFailedRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBUb2tlbkdlbmVyYXRpb25GYWlsZWRSdWxlIDogSUNvbmRpdGlvbk1hcHBpbmcKewogICAgcHVibGljIGFzeW5jIFRhc2s8Ym9vbD4gSGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgcmV0dXJuIGNvbnRleHQuSW5zdGFuY2UuRGF0YS50b2tlbnMuc3VjY2VzcyA9PSBmYWxzZTsKICAgIH0KfQ==\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"authentication-success\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Authentication Successful\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Kimlik Doğrulama Başarılı\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": []\n      },\n      {\n        \"key\": \"authentication-failed\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Authentication Failed\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Kimlik Doğrulama Başarısız\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": []\n      }\n    ]\n  }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - oAuth2.0 Flow",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Authorization Code SubFlow",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"authorization-code-subflow\",\n  \"flow\": \"sys-flows\",\n  \"domain\": \"{{domain}}\",\n  \"version\": \"1.0.0\",\n  \"tags\": [\n    \"oauth2\",\n    \"authorization-code\",\n    \"subflow\",\n    \"authentication\",\n    \"redirect\"\n  ],\n  \"attributes\": {\n    \"type\": \"S\",\n    \"timeout\": null,\n    \"labels\": [\n      {\n        \"language\": \"en-US\",\n        \"label\": \"Authorization Code Grant Subflow\"\n      },\n      {\n        \"language\": \"tr-TR\",\n        \"label\": \"Authorization Code Grant Alt Akışı\"\n      }\n    ],\n    \"functions\": [],\n    \"features\": [],\n    \"extensions\": [],\n    \"sharedTransitions\": [],\n    \"startTransition\": {\n      \"key\": \"start-authorization-code\",\n      \"target\": \"validate-authorization-code\",\n      \"triggerType\": 0,\n      \"versionStrategy\": \"Minor\",\n      \"labels\": [\n        {\n          \"language\": \"en-US\",\n          \"label\": \"Start Authorization Code Flow\"\n        },\n        {\n          \"language\": \"tr-TR\",\n          \"label\": \"Authorization Code Akışını Başlat\"\n        }\n      ],\n      \"schema\": null,\n      \"rule\": null,\n      \"timer\": null,\n      \"view\": null,\n      \"onExecutionTasks\": []\n    },\n    \"states\": [\n      {\n        \"key\": \"validate-authorization-code\",\n        \"stateType\": 1,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Validate Authorization Code\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Authorization Code Doğrulama\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"validate-authorization-code\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/ValidateAuthorizationCodeMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKcHVibGljIGNsYXNzIFZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGVNYXBwaW5nIDogSU1hcHBpbmcKewogICAgcHVibGljIFRhc2s8U2NyaXB0UmVzcG9uc2U+IElucHV0SGFuZGxlcihXb3JrZmxvd1Rhc2sgdGFzaywgU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHZhciBodHRwVGFzayA9IHRhc2sgYXMgSHR0cFRhc2s7CiAgICAgICAgdmFyIGF1dGhDb2RlRGF0YSA9IG5ldwogICAgICAgIHsKICAgICAgICAgICAgY29kZSA9IGNvbnRleHQuQm9keS5jb2RlLAogICAgICAgICAgICBjbGllbnRJZCA9IGNvbnRleHQuQm9keS5jbGllbnRfaWQsCiAgICAgICAgICAgIGNsaWVudFNlY3JldCA9IGNvbnRleHQuQm9keS5jbGllbnRfc2VjcmV0LAogICAgICAgICAgICByZWRpcmVjdFVyaSA9IGNvbnRleHQuQm9keS5yZWRpcmVjdF91cmksCiAgICAgICAgICAgIGNvZGVWZXJpZmllciA9IGNvbnRleHQuQm9keS5jb2RlX3ZlcmlmaWVyIC8vIFBLQ0UgZm9yIGVuaGFuY2VkIHNlY3VyaXR5CiAgICAgICAgfTsKICAgICAgICBodHRwVGFzay5TZXRCb2R5KGF1dGhDb2RlRGF0YSk7CiAgICAgICAgdmFyIGhlYWRlcnMgPSBuZXcgRGljdGlvbmFyeTxzdHJpbmcsIHN0cmluZz8+CiAgICAgICAgewogICAgICAgICAgICBbIkNvbnRlbnQtVHlwZSJdID0gImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICBbIlgtUmVxdWVzdC1JZCJdID0gY29udGV4dC5JbnN0YW5jZT8uRGF0YT8ucmVxdWVzdElkLAogICAgICAgIH07CiAgICAgICAgaHR0cFRhc2suU2V0SGVhZGVycyhoZWFkZXJzKTsKICAgICAgICByZXR1cm4gVGFzay5Gcm9tUmVzdWx0KG5ldyBTY3JpcHRSZXNwb25zZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgYXN5bmMgVGFzazxTY3JpcHRSZXNwb25zZT4gT3V0cHV0SGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgdmFyIHJlc3BvbnNlID0gbmV3IFNjcmlwdFJlc3BvbnNlKCk7CiAgICAgICAgdmFyIHN0YXR1c0NvZGUgPSBjb250ZXh0LkJvZHkuc3RhdHVzQ29kZSA/PyA1MDA7CgogICAgICAgIGlmIChzdGF0dXNDb2RlID09IDIwMCkKICAgICAgICB7CiAgICAgICAgICAgIHJlc3BvbnNlLkRhdGEgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgYXV0aGVudGljYXRpb24gPSBuZXcKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gdHJ1ZSwKICAgICAgICAgICAgICAgICAgICB1c2VySWQgPSBjb250ZXh0LkJvZHkuZGF0YT8udXNlcklkLAogICAgICAgICAgICAgICAgICAgIGdyYW50VHlwZSA9ICJhdXRob3JpemF0aW9uX2NvZGUiLAogICAgICAgICAgICAgICAgICAgIHJlZGlyZWN0VXJpID0gY29udGV4dC5Cb2R5LmRhdGE/LnJlZGlyZWN0VXJpLAogICAgICAgICAgICAgICAgICAgIGNvZGVDaGFsbGVuZ2UgPSBjb250ZXh0LkJvZHkuZGF0YT8uY29kZUNoYWxsZW5nZSwKICAgICAgICAgICAgICAgICAgICBjb2RlQ2hhbGxlbmdlTWV0aG9kID0gY29udGV4dC5Cb2R5LmRhdGE/LmNvZGVDaGFsbGVuZ2VNZXRob2QsCiAgICAgICAgICAgICAgICAgICAgaXNWYWxpZGF0aW9uU3VjY2VzcyA9IGNvbnRleHQuQm9keS5kYXRhPy5pc1ZhbGlkLAogICAgICAgICAgICAgICAgICAgIGV4cGlyZXNBdCA9IGNvbnRleHQuQm9keS5kYXRhPy5leHBpcmVzQXQsCiAgICAgICAgICAgICAgICAgICAgYXV0aG9yaXphdGlvbkNvZGUgPSBjb250ZXh0LkJvZHkuZGF0YT8uY29kZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChzdGF0dXNDb2RlID09IDQwMCkKICAgICAgICB7CiAgICAgICAgICAgIHJlc3BvbnNlLkRhdGEgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgYXV0aGVudGljYXRpb24gPSBuZXcKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSAiSW52YWxpZCBhdXRob3JpemF0aW9uIGNvZGUiLAogICAgICAgICAgICAgICAgICAgIGVycm9yQ29kZSA9ICJpbnZhbGlkX2dyYW50IgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICByZXNwb25zZS5EYXRhID0gbmV3CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGF1dGhlbnRpY2F0aW9uID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGVycm9yID0gIlNlcnZlciBlcnJvciBvY2N1cnJlZCIsCiAgICAgICAgICAgICAgICAgICAgZXJyb3JDb2RlID0gInNlcnZlcl9lcnJvciIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXNwb25zZTsKICAgIH0KfQ==\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"code-valid\",\n            \"target\": \"authorization-code-success\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Authorization Code Valid\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Authorization Code Geçerli\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/AuthorizationSuccessRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBBdXRob3JpemF0aW9uU3VjY2Vzc1J1bGUgOiBJQ29uZGl0aW9uTWFwcGluZwp7CiAgICBwdWJsaWMgYXN5bmMgVGFzazxib29sPiBIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICByZXR1cm4gY29udGV4dC5JbnN0YW5jZS5EYXRhLmF1dGhlbnRpY2F0aW9uLnN1Y2Nlc3MgPT0gdHJ1ZTsKICAgIH0KfQo=\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"code-invalid\",\n            \"target\": \"authorization-code-failed\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Authorization Code Invalid\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Authorization Code Geçersiz\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/AuthorizationFailedRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBBdXRob3JpemF0aW9uRmFpbGVkUnVsZSA6IElDb25kaXRpb25NYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHJldHVybiBjb250ZXh0Lkluc3RhbmNlLkRhdGEuYXV0aGVudGljYXRpb24uc3VjY2VzcyA9PSBmYWxzZTsKICAgIH0KfQo=\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"authorization-code-success\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Authorization Code Success\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Authorization Code Başarılı\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": []\n      },\n      {\n        \"key\": \"authorization-code-failed\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Authorization Code Failed\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Authorization Code Başarısız\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": []\n      }\n    ]\n  }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Authorization Code SubFlow",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Password SubFlow",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"password-subflow\",\n  \"flow\": \"sys-flows\",\n  \"domain\": \"{{domain}}\",\n  \"version\": \"1.0.0\",\n  \"tags\": [\n    \"oauth2\",\n    \"password\",\n    \"subflow\",\n    \"authentication\",\n    \"user-credentials\"\n  ],\n  \"attributes\": {\n    \"type\": \"S\",\n    \"timeout\": null,\n    \"labels\": [\n      {\n        \"language\": \"en-US\",\n        \"label\": \"Password Grant Subflow\"\n      },\n      {\n        \"language\": \"tr-TR\",\n        \"label\": \"Password Grant Alt Akışı\"\n      }\n    ],\n    \"functions\": [],\n    \"features\": [],\n    \"extensions\": [],\n    \"sharedTransitions\": [],\n    \"startTransition\": {\n      \"key\": \"start-password-flow\",\n      \"target\": \"validate-user-credentials\",\n      \"triggerType\": 0,\n      \"versionStrategy\": \"Minor\",\n      \"labels\": [\n        {\n          \"language\": \"en-US\",\n          \"label\": \"Start Password Flow\"\n        },\n        {\n          \"language\": \"tr-TR\",\n          \"label\": \"Password Akışını Başlat\"\n        }\n      ],\n      \"schema\": null,\n      \"rule\": null,\n      \"timer\": null,\n      \"view\": null,\n      \"onExecutionTasks\": []\n    },\n    \"states\": [\n      {\n        \"key\": \"validate-user-credentials\",\n        \"stateType\": 1,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Validate User Credentials\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Kullanıcı Kimlik Bilgilerini Doğrula\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"validate-user-credentials\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/ValidateUserCredentialsMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKLy8vIDxzdW1tYXJ5PgovLy8gT0F1dGgyIFVzZXIgQ3JlZGVudGlhbHMgVmFsaWRhdGlvbiBNYXBwaW5nIC0gVXNlciBjcmVkZW50aWFsIHZhbGlkYXRpb24gbWFwcGluZwovLyBUaGlzIG1hcHBpbmcgaXMgdXNlZCB0byB2YWxpZGF0ZSB1c2VyIGNyZWRlbnRpYWxzIGluIHRoZSBPQXV0aDIgcGFzc3dvcmQgZ3JhbnQgZmxvdy4KLy8vIDwvc3VtbWFyeT4KcHVibGljIGNsYXNzIFZhbGlkYXRlVXNlckNyZWRlbnRpYWxzTWFwcGluZyA6IElNYXBwaW5nCnsKICAgIC8vLyA8c3VtbWFyeT4KICAgIC8vLyBQcmVwYXJlIGlucHV0IGZvciB1c2VyIGNyZWRlbnRpYWwgdmFsaWRhdGlvbiByZXF1ZXN0CiAgICAvLy8gPC9zdW1tYXJ5PgogICAgcHVibGljIFRhc2s8U2NyaXB0UmVzcG9uc2U+IElucHV0SGFuZGxlcihXb3JrZmxvd1Rhc2sgdGFzaywgU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICAgICAgdmFyIGh0dHBUYXNrID0gdGFzayBhcyBIdHRwVGFzazsKICAgICAgICAgICAgaWYgKGh0dHBUYXNrID09IG51bGwpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXhjZXB0aW9uKCJUYXNrIG11c3QgYmUgYW4gSHR0cFRhc2sgZm9yIHVzZXIgY3JlZGVudGlhbHMgdmFsaWRhdGlvbiIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgcmVxdWVzdEJvZHkgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdXNlcm5hbWUgPSBjb250ZXh0LkJvZHk/LnVzZXJuYW1lID8/IGNvbnRleHQuQm9keT8uZW1haWwsCiAgICAgICAgICAgICAgICBwYXNzd29yZCA9IGNvbnRleHQuQm9keT8ucGFzc3dvcmQKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGh0dHBUYXNrLlNldEJvZHkocmVxdWVzdEJvZHkpOwoKICAgICAgICAgICAgLy8gU2V0IHRoZSBoZWFkZXJzCiAgICAgICAgICAgIHZhciBoZWFkZXJzID0gbmV3IERpY3Rpb25hcnk8c3RyaW5nLCBzdHJpbmc/PgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBbIlgtUmVxdWVzdC1JZCJdID0gY29udGV4dC5JbnN0YW5jZT8uRGF0YT8ucmVxdWVzdElkLAogICAgICAgICAgICAgICAgWyJDb250ZW50LVR5cGUiXSA9ICJhcHBsaWNhdGlvbi9qc29uIgogICAgICAgICAgICB9OwoKICAgICAgICAgICAgaHR0cFRhc2suU2V0SGVhZGVycyhoZWFkZXJzKTsKCiAgICAgICAgICAgIHJldHVybiBUYXNrLkZyb21SZXN1bHQobmV3IFNjcmlwdFJlc3BvbnNlKCkpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChuZXcgU2NyaXB0UmVzcG9uc2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIC8vLyA8c3VtbWFyeT4KICAgIC8vLyBQcm9jZXNzIHVzZXIgYXV0aGVudGljYXRpb24gcmVzdWx0IGFuZCBtZXJnZSBpdCBpbnRvIHRoZSB3b3JrZmxvdyBpbnN0YW5jZQogICAgLy8vIDwvc3VtbWFyeT4KICAgIHB1YmxpYyBhc3luYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBPdXRwdXRIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICAgdmFyIHJlc3BvbnNlID0gbmV3IFNjcmlwdFJlc3BvbnNlKCk7CiAgICAgICAgdHJ5CiAgICAgICAgewogICAgICAgICAgICB2YXIgc3RhdHVzQ29kZSA9IEdldFN0YXR1c0NvZGVGcm9tUmVzcG9uc2UoY29udGV4dCk7CiAgICAgICAgICAgIHZhciByZXNwb25zZURhdGEgPSBHZXRSZXNwb25zZURhdGFGcm9tQ29udGV4dChjb250ZXh0KTsKCiAgICAgICAgICAgIC8vIFN1Y2Nlc3NmdWwgdmFsaWRhdGlvbgogICAgICAgICAgICBpZiAoc3RhdHVzQ29kZSA+PSAyMDAgJiYgc3RhdHVzQ29kZSA8IDMwMCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcmVzcG9uc2UuRGF0YSA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGF1dGhlbnRpY2F0aW9uID0gbmV3IAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZCA9IHJlc3BvbnNlRGF0YT8udXNlcklkLAogICAgICAgICAgICAgICAgICAgICAgICB1c2VybmFtZSA9IHJlc3BvbnNlRGF0YT8udXNlcm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsID0gcmVzcG9uc2VEYXRhPy5lbWFpbCwKICAgICAgICAgICAgICAgICAgICAgICAgcm9sZXMgPSByZXNwb25zZURhdGE/LnJvbGVzLAogICAgICAgICAgICAgICAgICAgICAgICAvLyBNRkEgY29udGV4dAogICAgICAgICAgICAgICAgICAgICAgICBtZmFSZXF1aXJlZCA9IHJlc3BvbnNlRGF0YT8ubWZhUmVxdWlyZWQgPz8gdHJ1ZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXNwb25zZS5EYXRhID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgYXV0aGVudGljYXRpb24gPSBuZXcKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSAiSW52YWxpZCB1c2VybmFtZSBvciBwYXNzd29yZCIsCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yQ29kZSA9ICJpbnZhbGlkX2NyZWRlbnRpYWxzIgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBleCkKICAgICAgICB7CiAgICAgICAgICAgIHJlc3BvbnNlLkRhdGEgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgYXV0aGVudGljYXRpb24gPSBuZXcKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSAiSW50ZXJuYWwgcHJvY2Vzc2luZyBlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgZXJyb3JDb2RlID0gInByb2Nlc3NpbmdfZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIGVycm9yRGVzY3JpcHRpb24gPSBleC5NZXNzYWdlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXNwb25zZTsKICAgIH0KCiAgICAjcmVnaW9uIEhlbHBlciBNZXRob2RzCgogICAgcHJpdmF0ZSBzdGF0aWMgaW50IEdldFN0YXR1c0NvZGVGcm9tUmVzcG9uc2UoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIGlmIChjb250ZXh0LkJvZHk/LnN0YXR1c0NvZGUgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIChpbnQpY29udGV4dC5Cb2R5LnN0YXR1c0NvZGU7CgogICAgICAgIHJldHVybiAyMDA7CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgZHluYW1pYz8gR2V0UmVzcG9uc2VEYXRhRnJvbUNvbnRleHQoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIGlmIChjb250ZXh0LkJvZHk/LmRhdGEgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuQm9keS5kYXRhOwoKICAgICAgICBpZiAoY29udGV4dC5Cb2R5ICE9IG51bGwgJiYgY29udGV4dC5Cb2R5LnN0YXR1c0NvZGUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuQm9keTsKCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgI2VuZHJlZ2lvbgp9Cg==\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"credentials-valid\",\n            \"target\": \"password-success\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"User Credentials Valid\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Kullanıcı Kimlik Bilgileri Geçerli\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/AuthorizationSuccessRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBBdXRob3JpemF0aW9uU3VjY2Vzc1J1bGUgOiBJQ29uZGl0aW9uTWFwcGluZwp7CiAgICBwdWJsaWMgYXN5bmMgVGFzazxib29sPiBIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICByZXR1cm4gY29udGV4dC5JbnN0YW5jZS5EYXRhLmF1dGhlbnRpY2F0aW9uLnN1Y2Nlc3MgPT0gdHJ1ZTsKICAgIH0KfQo=\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"credentials-invalid\",\n            \"target\": \"password-failed\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"User Credentials Invalid\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Kullanıcı Kimlik Bilgileri Geçersiz\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/AuthorizationFailedRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBBdXRob3JpemF0aW9uRmFpbGVkUnVsZSA6IElDb25kaXRpb25NYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHJldHVybiBjb250ZXh0Lkluc3RhbmNlLkRhdGEuYXV0aGVudGljYXRpb24uc3VjY2VzcyA9PSBmYWxzZTsKICAgIH0KfQo=\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"password-success\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Password Authentication Success\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Password Kimlik Doğrulama Başarılı\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": []\n      },\n      {\n        \"key\": \"password-failed\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Password Authentication Failed\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Password Kimlik Doğrulama Başarısız\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": []\n      }\n    ]\n  }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Password SubFlow",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Otp - Mfa SubFlow",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"otp-mfa-subflow\",\n  \"flow\": \"sys-flows\",\n  \"domain\": \"{{domain}}\",\n  \"version\": \"1.0.0\",\n  \"tags\": [\n    \"oauth2\",\n    \"mfa\",\n    \"otp\",\n    \"subflow\",\n    \"two-factor\"\n  ],\n  \"attributes\": {\n    \"type\": \"S\",\n    \"timeout\": {\n      \"key\": \"otp-timeout\",\n      \"target\": \"otp-expired\",\n      \"versionStrategy\": \"Minor\",\n      \"timer\": {\n        \"reset\": \"OnEntry\",\n        \"duration\": \"PT5M\"\n      }\n    },\n    \"labels\": [\n      {\n        \"language\": \"en-US\",\n        \"label\": \"OTP Multi-Factor Authentication Subflow\"\n      },\n      {\n        \"language\": \"tr-TR\",\n        \"label\": \"OTP Çok Faktörlü Kimlik Doğrulama Alt Akışı\"\n      }\n    ],\n    \"functions\": [],\n    \"features\": [],\n    \"extensions\": [],\n    \"sharedTransitions\": [],\n    \"startTransition\": {\n      \"key\": \"start-otp-mfa\",\n      \"target\": \"send-otp\",\n      \"triggerType\": 0,\n      \"versionStrategy\": \"Minor\",\n      \"labels\": [\n        {\n          \"language\": \"en-US\",\n          \"label\": \"Start OTP MFA\"\n        },\n        {\n          \"language\": \"tr-TR\",\n          \"label\": \"OTP MFA Başlat\"\n        }\n      ],\n      \"schema\": null,\n      \"rule\": null,\n      \"timer\": null,\n      \"view\": null,\n      \"onExecutionTasks\": []\n    },\n    \"states\": [\n      {\n        \"key\": \"send-otp\",\n        \"stateType\": 1,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Send OTP Code\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"OTP Kodu Gönder\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"send-otp-notification\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/SendOtpNotificationMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKcHVibGljIGNsYXNzIFNlbmRPdHBOb3RpZmljYXRpb25NYXBwaW5nIDogSU1hcHBpbmcKewogICAgcHVibGljIFRhc2s8U2NyaXB0UmVzcG9uc2U+IElucHV0SGFuZGxlcihXb3JrZmxvd1Rhc2sgdGFzaywgU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHZhciBodHRwVGFzayA9IHRhc2sgYXMgSHR0cFRhc2s7CiAgICAgICAgdmFyIG90cERhdGEgPSBuZXcKICAgICAgICB7CiAgICAgICAgICAgIHVzZXJJZCA9IGNvbnRleHQuSW5zdGFuY2UuRGF0YT8uYXV0aGVudGljYXRpb24/LnVzZXJJZCwKICAgICAgICAgICAgZW1haWwgPSBjb250ZXh0Lkluc3RhbmNlLkRhdGE/LmF1dGhlbnRpY2F0aW9uPy5lbWFpbCwKICAgICAgICAgICAgcGhvbmUgPSBjb250ZXh0Lkluc3RhbmNlLkRhdGE/LmF1dGhlbnRpY2F0aW9uPy5waG9uZSwKICAgICAgICAgICAgbWV0aG9kID0gInNtcyIsIC8vIERlZmF1bHQgdG8gc21zLCBjYW4gYmUgInNtcyIgb3IgImVtYWlsIgogICAgICAgICAgICBkZXZpY2VJZCA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LmRldmljZUlkLAogICAgICAgICAgICBsYW5ndWFnZSA9IGNvbnRleHQuSGVhZGVyc1siYWNjZXB0LWxhbmd1YWdlIl0gPz8gImVuLVVTIgogICAgICAgIH07CiAgICAgICAgaHR0cFRhc2suU2V0Qm9keShvdHBEYXRhKTsKICAgICAgICB2YXIgaGVhZGVycyA9IG5ldyBEaWN0aW9uYXJ5PHN0cmluZywgc3RyaW5nPz4KICAgICAgICB7CiAgICAgICAgICAgIFsiQ29udGVudC1UeXBlIl0gPSAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgIFsiWC1SZXF1ZXN0LUlkIl0gPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5yZXF1ZXN0SWQsCiAgICAgICAgICAgIFsiWC1Vc2VyLUlkIl0gPSBjb250ZXh0Lkluc3RhbmNlLkRhdGE/LmF1dGhlbnRpY2F0aW9uPy51c2VySWQKICAgICAgICB9OwogICAgICAgIGh0dHBUYXNrLlNldEhlYWRlcnMoaGVhZGVycyk7CiAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChuZXcgU2NyaXB0UmVzcG9uc2UoKSk7CiAgICB9CgogICAgcHVibGljIGFzeW5jIFRhc2s8U2NyaXB0UmVzcG9uc2U+IE91dHB1dEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHZhciByZXNwb25zZSA9IG5ldyBTY3JpcHRSZXNwb25zZSgpOwogICAgICAgIHZhciBzdGF0dXNDb2RlID0gY29udGV4dC5Cb2R5LnN0YXR1c0NvZGUgPz8gNTAwOwoKICAgICAgICBpZiAoc3RhdHVzQ29kZSA9PSAyMDApCiAgICAgICAgewogICAgICAgICAgICByZXNwb25zZS5EYXRhID0gbmV3CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG90cCA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHNlbnQgPSB0cnVlLAogICAgICAgICAgICAgICAgICAgIG90cElkID0gY29udGV4dC5Cb2R5LmRhdGE/Lm90cElkLAogICAgICAgICAgICAgICAgICAgIGV4cGlyZXNBdCA9IGNvbnRleHQuQm9keS5kYXRhPy5leHBpcmVzQXQsCiAgICAgICAgICAgICAgICAgICAgbWV0aG9kID0gY29udGV4dC5Cb2R5LmRhdGE/Lm1ldGhvZCwKICAgICAgICAgICAgICAgICAgICBhdHRlbXB0c1JlbWFpbmluZyA9IGNvbnRleHQuQm9keS5kYXRhPy5hdHRlbXB0c1JlbWFpbmluZyA/PyAzCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIHJlc3BvbnNlLkRhdGEgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgb3RwID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgc2VudCA9IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGVycm9yID0gIkZhaWxlZCB0byBzZW5kIE9UUCIsCiAgICAgICAgICAgICAgICAgICAgZXJyb3JDb2RlID0gIm90cF9zZW5kX2ZhaWxlZCIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXNwb25zZTsKICAgIH0KfQ==\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"otp-sent\",\n            \"target\": \"submit-otp\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"OTP Sent Successfully\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"OTP Başarıyla Gönderildi\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/OtpSentRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBPdHBTZW50UnVsZSA6IElDb25kaXRpb25NYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHJldHVybiBjb250ZXh0Lkluc3RhbmNlLkRhdGEub3RwLnNlbnQgPT0gdHJ1ZTsKICAgIH0KfQ==\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"otp-send-failed\",\n            \"target\": \"otp-failed\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"OTP Send Failed\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"OTP Gönderme Başarısız\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/OtpSendFailedRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBPdHBTZW5kRmFpbGVkUnVsZSA6IElDb25kaXRpb25NYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHJldHVybiBjb250ZXh0Lkluc3RhbmNlLkRhdGEub3RwLnNlbnQgPT0gZmFsc2U7CiAgICB9Cn0=\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"submit-otp\",\n        \"stateType\": 2,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Submit OTP Code\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"OTP Kodunu Gönder\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"submit-otp\",\n            \"target\": \"verify-otp\",\n            \"triggerType\": 0,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"OTP Verified Successfully\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"OTP Başarıyla Doğrulandı\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": null,\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": [\n              {\n                \"order\": 1,\n                \"task\": {\n                  \"key\": \"verify-otp-code\",\n                  \"domain\": \"{{domain}}\",\n                  \"version\": \"1.0.0\",\n                  \"flow\": \"sys-tasks\"\n                },\n                \"mapping\": {\n                  \"location\": \"./src/VerifyOtpCodeMapping.csx\",\n                  \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKcHVibGljIGNsYXNzIFZlcmlmeU90cENvZGVNYXBwaW5nIDogSU1hcHBpbmcKewogICAgcHVibGljIFRhc2s8U2NyaXB0UmVzcG9uc2U+IElucHV0SGFuZGxlcihXb3JrZmxvd1Rhc2sgdGFzaywgU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHZhciBodHRwVGFzayA9IHRhc2sgYXMgSHR0cFRhc2s7CiAgICAgICAgdmFyIHZlcmlmeURhdGEgPSBuZXcKICAgICAgICB7CiAgICAgICAgICAgIG90cElkID0gY29udGV4dC5JbnN0YW5jZS5EYXRhPy5vdHA/Lm90cElkLAogICAgICAgICAgICBvdHBDb2RlID0gY29udGV4dC5Cb2R5Lm90cF9jb2RlLAogICAgICAgICAgICB1c2VySWQgPSBjb250ZXh0Lkluc3RhbmNlLkRhdGE/LmF1dGhlbnRpY2F0aW9uPy51c2VySWQsCiAgICAgICAgICAgIGRldmljZUlkID0gY29udGV4dC5JbnN0YW5jZT8uRGF0YT8uZGV2aWNlSWQKICAgICAgICB9OwogICAgICAgIGh0dHBUYXNrLlNldEJvZHkodmVyaWZ5RGF0YSk7CiAgICAgICAgdmFyIGhlYWRlcnMgPSBuZXcgRGljdGlvbmFyeTxzdHJpbmcsIHN0cmluZz8+CiAgICAgICAgewogICAgICAgICAgICBbIkNvbnRlbnQtVHlwZSJdID0gImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICBbIlgtUmVxdWVzdC1JZCJdID0gY29udGV4dC5JbnN0YW5jZT8uRGF0YT8ucmVxdWVzdElkLAogICAgICAgICAgICBbIlgtVXNlci1JZCJdID0gY29udGV4dC5JbnN0YW5jZS5EYXRhPy5hdXRoZW50aWNhdGlvbj8udXNlcklkCiAgICAgICAgfTsKICAgICAgICBodHRwVGFzay5TZXRIZWFkZXJzKGhlYWRlcnMpOwogICAgICAgIHJldHVybiBUYXNrLkZyb21SZXN1bHQobmV3IFNjcmlwdFJlc3BvbnNlKCkpOwogICAgfQoKICAgIHB1YmxpYyBhc3luYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBPdXRwdXRIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICB2YXIgcmVzcG9uc2UgPSBuZXcgU2NyaXB0UmVzcG9uc2UoKTsKICAgICAgICB2YXIgc3RhdHVzQ29kZSA9IGNvbnRleHQuQm9keS5zdGF0dXNDb2RlID8/IDUwMDsKCiAgICAgICAgaWYgKHN0YXR1c0NvZGUgPT0gMjAwKQogICAgICAgIHsKICAgICAgICAgICAgcmVzcG9uc2UuRGF0YSA9IG5ldwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBtZmEgPSBuZXcKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBvdHBWZXJpZmllZCA9IHRydWUsCiAgICAgICAgICAgICAgICAgICAgbWV0aG9kID0gIm90cCIsCiAgICAgICAgICAgICAgICAgICAgdmVyaWZpZWRBdCA9IERhdGVUaW1lLlV0Y05vdy5Ub1N0cmluZygibyIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKHN0YXR1c0NvZGUgPT0gNDAwKQogICAgICAgIHsKICAgICAgICAgICAgcmVzcG9uc2UuRGF0YSA9IG5ldwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBtZmEgPSBuZXcKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSAiSW52YWxpZCBPVFAgY29kZSIsCiAgICAgICAgICAgICAgICAgICAgZXJyb3JDb2RlID0gImludmFsaWRfb3RwIiwKICAgICAgICAgICAgICAgICAgICBhdHRlbXB0c1JlbWFpbmluZyA9IGNvbnRleHQuQm9keS5kYXRhPy5hdHRlbXB0c1JlbWFpbmluZyA/PyAwCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIHJlc3BvbnNlLkRhdGEgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbWZhID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGVycm9yID0gIlNlcnZlciBlcnJvciBvY2N1cnJlZCIsCiAgICAgICAgICAgICAgICAgICAgZXJyb3JDb2RlID0gInNlcnZlcl9lcnJvciIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXNwb25zZTsKICAgIH0KfQ==\"\n                }\n              }\n            ]\n          }\n        ]\n      },\n      {\n        \"key\": \"verify-otp\",\n        \"stateType\": 2,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Verify OTP Code\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"OTP Kodu Doğrula\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"otp-verified\",\n            \"target\": \"otp-success\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"OTP Verified Successfully\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"OTP Başarıyla Doğrulandı\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/MfaSuccessRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBNZmFTdWNjZXNzUnVsZSA6IElDb25kaXRpb25NYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHJldHVybiBjb250ZXh0Lkluc3RhbmNlLkRhdGEubWZhLnN1Y2Nlc3MgPT0gdHJ1ZTsKICAgIH0KfQ==\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"otp-invalid-retry\",\n            \"target\": \"submit-otp\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"OTP Invalid - Retry\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"OTP Geçersiz - Tekrar Dene\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/OtpInvalidRetryRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBPdHBJbnZhbGlkUmV0cnlSdWxlIDogSUNvbmRpdGlvbk1hcHBpbmcKewogICAgcHVibGljIGFzeW5jIFRhc2s8Ym9vbD4gSGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgcmV0dXJuIGNvbnRleHQuSW5zdGFuY2UuRGF0YS5tZmEuc3VjY2VzcyA9PSBmYWxzZSAmJiAKICAgICAgICAgICAgICAgY29udGV4dC5JbnN0YW5jZS5EYXRhLm1mYS5hdHRlbXB0c1JlbWFpbmluZyA+IDA7CiAgICB9Cn0=\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"otp-invalid-max-attempts\",\n            \"target\": \"otp-failed\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"OTP Invalid - Max Attempts Reached\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"OTP Geçersiz - Maksimum Deneme Sayısına Ulaşıldı\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/OtpInvalidMaxAttemptsRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBPdHBJbnZhbGlkTWF4QXR0ZW1wdHNSdWxlIDogSUNvbmRpdGlvbk1hcHBpbmcKewogICAgcHVibGljIGFzeW5jIFRhc2s8Ym9vbD4gSGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgcmV0dXJuIGNvbnRleHQuSW5zdGFuY2UuRGF0YS5tZmEuc3VjY2VzcyA9PSBmYWxzZSAmJiAKICAgICAgICAgICAgICAgY29udGV4dC5JbnN0YW5jZS5EYXRhLm1mYS5hdHRlbXB0c1JlbWFpbmluZyA8PSAwOwogICAgfQp9\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"otp-success\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"OTP MFA Success\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"OTP MFA Başarılı\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": []\n      },\n      {\n        \"key\": \"otp-failed\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"OTP MFA Failed\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"OTP MFA Başarısız\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": []\n      },\n      {\n        \"key\": \"otp-expired\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"OTP Expired\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"OTP Süresi Doldu\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": []\n      }\n    ]\n  }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Otp - Mfa SubFlow",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Push Notify SubFlow",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"push-notification-mfa-subflow\",\n  \"flow\": \"sys-flows\",\n  \"domain\": \"{{domain}}\",\n  \"version\": \"1.0.0\",\n  \"tags\": [\n    \"oauth2\",\n    \"mfa\",\n    \"push-notification\",\n    \"subflow\",\n    \"two-factor\"\n  ],\n  \"attributes\": {\n    \"type\": \"S\",\n    \"timeout\": {\n      \"key\": \"push-timeout\",\n      \"target\": \"push-expired\",\n      \"versionStrategy\": \"Minor\",\n      \"timer\": {\n        \"reset\": \"OnEntry\",\n        \"duration\": \"PT2M\"\n      }\n    },\n    \"labels\": [\n      {\n        \"language\": \"en-US\",\n        \"label\": \"Push Notification MFA Subflow\"\n      },\n      {\n        \"language\": \"tr-TR\",\n        \"label\": \"Push Bildirimi MFA Alt Akışı\"\n      }\n    ],\n    \"functions\": [],\n    \"features\": [],\n    \"extensions\": [],\n    \"sharedTransitions\": [],\n    \"startTransition\": {\n      \"key\": \"start-push-mfa\",\n      \"target\": \"send-push-notification\",\n      \"triggerType\": 0,\n      \"versionStrategy\": \"Minor\",\n      \"labels\": [\n        {\n          \"language\": \"en-US\",\n          \"label\": \"Start Push MFA\"\n        },\n        {\n          \"language\": \"tr-TR\",\n          \"label\": \"Push MFA Başlat\"\n        }\n      ],\n      \"schema\": null,\n      \"rule\": null,\n      \"timer\": null,\n      \"view\": null,\n      \"onExecutionTasks\": []\n    },\n    \"states\": [\n      {\n        \"key\": \"send-push-notification\",\n        \"stateType\": 1,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Send Push Notification\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Push Bildirimi Gönder\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"send-push-notification\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/SendPushNotificationMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKcHVibGljIGNsYXNzIFNlbmRQdXNoTm90aWZpY2F0aW9uTWFwcGluZyA6IElNYXBwaW5nCnsKICAgIHB1YmxpYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBJbnB1dEhhbmRsZXIoV29ya2Zsb3dUYXNrIHRhc2ssIFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICB2YXIgaHR0cFRhc2sgPSB0YXNrIGFzIEh0dHBUYXNrOwogICAgICAgIHZhciBwdXNoRGF0YSA9IG5ldwogICAgICAgIHsKICAgICAgICAgICAgdXNlcklkID0gY29udGV4dC5JbnN0YW5jZS5EYXRhPy5hdXRoZW50aWNhdGlvbj8udXNlcklkLAogICAgICAgICAgICBkZXZpY2VJZCA9IGNvbnRleHQuSW5zdGFuY2UuRGF0YT8uZGV2aWNlUmVnaXN0cmF0aW9uPy5kZXZpY2VJZCwKICAgICAgICAgICAgdGl0bGUgPSAiQXV0aGVudGljYXRpb24gUmVxdWVzdCIsCiAgICAgICAgICAgIG1lc3NhZ2UgPSAiQXBwcm92ZSB0aGlzIGxvZ2luIGF0dGVtcHQgZnJvbSB5b3VyIGRldmljZSIsCiAgICAgICAgICAgIGFjdGlvblR5cGUgPSAibWZhX2F1dGhlbnRpY2F0aW9uIiwKICAgICAgICAgICAgZXhwaXJlc0luID0gMTIwLCAvLyAyIG1pbnV0ZXMKICAgICAgICAgICAgbWV0YWRhdGEgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcmVxdWVzdElkID0gY29udGV4dC5JbnN0YW5jZT8uRGF0YT8ucmVxdWVzdElkLAogICAgICAgICAgICAgICAgY2xpZW50SWQgPSBjb250ZXh0Lkluc3RhbmNlLkRhdGE/LmNsaWVudFZhbGlkYXRpb24/LmNsaWVudElkLAogICAgICAgICAgICAgICAgaXBBZGRyZXNzID0gY29udGV4dC5JbnN0YW5jZT8uRGF0YT8uaXBBZGRyZXNzLAogICAgICAgICAgICAgICAgdXNlckFnZW50ID0gY29udGV4dC5JbnN0YW5jZT8uRGF0YT8udXNlckFnZW50CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIGh0dHBUYXNrLlNldEJvZHkocHVzaERhdGEpOwogICAgICAgIHZhciBoZWFkZXJzID0gbmV3IERpY3Rpb25hcnk8c3RyaW5nLCBzdHJpbmc/PgogICAgICAgIHsKICAgICAgICAgICAgWyJDb250ZW50LVR5cGUiXSA9ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgWyJYLVJlcXVlc3QtSWQiXSA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LnJlcXVlc3RJZCwKICAgICAgICAgICAgWyJYLVVzZXItSWQiXSA9IGNvbnRleHQuSW5zdGFuY2UuRGF0YT8uYXV0aGVudGljYXRpb24/LnVzZXJJZCwKICAgICAgICAgICAgWyJYLURldmljZS1JZCJdID0gY29udGV4dC5JbnN0YW5jZS5EYXRhPy5kZXZpY2VSZWdpc3RyYXRpb24/LmRldmljZUlkCiAgICAgICAgfTsKICAgICAgICBodHRwVGFzay5TZXRIZWFkZXJzKGhlYWRlcnMpOwogICAgICAgIHJldHVybiBUYXNrLkZyb21SZXN1bHQobmV3IFNjcmlwdFJlc3BvbnNlKCkpOwogICAgfQoKICAgIHB1YmxpYyBhc3luYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBPdXRwdXRIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICB2YXIgcmVzcG9uc2UgPSBuZXcgU2NyaXB0UmVzcG9uc2UoKTsKICAgICAgICB2YXIgc3RhdHVzQ29kZSA9IGNvbnRleHQuQm9keS5zdGF0dXNDb2RlID8/IDUwMDsKCiAgICAgICAgaWYgKHN0YXR1c0NvZGUgPT0gMjAwKQogICAgICAgIHsKICAgICAgICAgICAgcmVzcG9uc2UuRGF0YSA9IG5ldwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBwdXNoTm90aWZpY2F0aW9uID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgc2VudCA9IHRydWUsCiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uSWQgPSBjb250ZXh0LkJvZHkuZGF0YT8ubm90aWZpY2F0aW9uSWQsCiAgICAgICAgICAgICAgICAgICAgZXhwaXJlc0F0ID0gY29udGV4dC5Cb2R5LmRhdGE/LmV4cGlyZXNBdCwKICAgICAgICAgICAgICAgICAgICBkZWxpdmVyeVN0YXR1cyA9IGNvbnRleHQuQm9keS5kYXRhPy5zdGF0dXMgPz8gInBlbmRpbmciCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIHJlc3BvbnNlLkRhdGEgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcHVzaE5vdGlmaWNhdGlvbiA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHNlbnQgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBlcnJvciA9ICJGYWlsZWQgdG8gc2VuZCBwdXNoIG5vdGlmaWNhdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgZXJyb3JDb2RlID0gInB1c2hfc2VuZF9mYWlsZWQiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmVzcG9uc2U7CiAgICB9Cn0=\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"push-sent\",\n            \"target\": \"wait-for-approval\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Push Notification Sent\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Push Bildirimi Gönderildi\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/PushSentRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBQdXNoU2VudFJ1bGUgOiBJQ29uZGl0aW9uTWFwcGluZwp7CiAgICBwdWJsaWMgYXN5bmMgVGFzazxib29sPiBIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICByZXR1cm4gY29udGV4dC5JbnN0YW5jZS5EYXRhLnB1c2hOb3RpZmljYXRpb24uc2VudCA9PSB0cnVlOwogICAgfQp9\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"push-send-failed\",\n            \"target\": \"push-failed\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Push Send Failed\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Push Gönderme Başarısız\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/PushSendFailedRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBQdXNoU2VuZEZhaWxlZFJ1bGUgOiBJQ29uZGl0aW9uTWFwcGluZwp7CiAgICBwdWJsaWMgYXN5bmMgVGFzazxib29sPiBIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICByZXR1cm4gY29udGV4dC5JbnN0YW5jZS5EYXRhLnB1c2hOb3RpZmljYXRpb24uc2VudCA9PSBmYWxzZTsKICAgIH0KfQ==\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"wait-for-approval\",\n        \"stateType\": 2,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Wait for User Approval\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Kullanıcı Onayını Bekle\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"push-approved\",\n            \"target\": \"push-success\",\n            \"triggerType\": 0,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Push Notification Approved\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Push Bildirimi Onaylandı\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": null,\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": [\n              {\n                \"order\": 1,\n                \"task\": {\n                  \"key\": \"check-push-response\",\n                  \"domain\": \"{{domain}}\",\n                  \"version\": \"1.0.0\",\n                  \"flow\": \"sys-tasks\"\n                },\n                \"mapping\": {\n                  \"location\": \"./src/CheckPushResponseMapping.csx\",\n                  \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKcHVibGljIGNsYXNzIENoZWNrUHVzaFJlc3BvbnNlTWFwcGluZyA6IElNYXBwaW5nCnsKICAgIHB1YmxpYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBJbnB1dEhhbmRsZXIoV29ya2Zsb3dUYXNrIHRhc2ssIFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICB2YXIgaHR0cFRhc2sgPSB0YXNrIGFzIEh0dHBUYXNrOwogICAgICAgIHZhciBjaGVja0RhdGEgPSBuZXcKICAgICAgICB7CiAgICAgICAgICAgIG5vdGlmaWNhdGlvbklkID0gY29udGV4dC5JbnN0YW5jZS5EYXRhPy5wdXNoTm90aWZpY2F0aW9uPy5ub3RpZmljYXRpb25JZCwKICAgICAgICAgICAgdXNlcklkID0gY29udGV4dC5JbnN0YW5jZS5EYXRhPy5hdXRoZW50aWNhdGlvbj8udXNlcklkLAogICAgICAgICAgICBkZXZpY2VJZCA9IGNvbnRleHQuSW5zdGFuY2UuRGF0YT8uZGV2aWNlUmVnaXN0cmF0aW9uPy5kZXZpY2VJZAogICAgICAgIH07CiAgICAgICAgaHR0cFRhc2suU2V0Qm9keShjaGVja0RhdGEpOwogICAgICAgIHZhciBoZWFkZXJzID0gbmV3IERpY3Rpb25hcnk8c3RyaW5nLCBzdHJpbmc/PgogICAgICAgIHsKICAgICAgICAgICAgWyJDb250ZW50LVR5cGUiXSA9ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgWyJYLVJlcXVlc3QtSWQiXSA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LnJlcXVlc3RJZCwKICAgICAgICAgICAgWyJYLVVzZXItSWQiXSA9IGNvbnRleHQuSW5zdGFuY2UuRGF0YT8uYXV0aGVudGljYXRpb24/LnVzZXJJZAogICAgICAgIH07CiAgICAgICAgaHR0cFRhc2suU2V0SGVhZGVycyhoZWFkZXJzKTsKICAgICAgICByZXR1cm4gVGFzay5Gcm9tUmVzdWx0KG5ldyBTY3JpcHRSZXNwb25zZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgYXN5bmMgVGFzazxTY3JpcHRSZXNwb25zZT4gT3V0cHV0SGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgdmFyIHJlc3BvbnNlID0gbmV3IFNjcmlwdFJlc3BvbnNlKCk7CiAgICAgICAgdmFyIHN0YXR1c0NvZGUgPSBjb250ZXh0LkJvZHkuc3RhdHVzQ29kZSA/PyA1MDA7CgogICAgICAgIGlmIChzdGF0dXNDb2RlID09IDIwMCkKICAgICAgICB7CiAgICAgICAgICAgIHZhciByZXNwb25zZVN0YXR1cyA9IGNvbnRleHQuQm9keS5kYXRhPy5zdGF0dXM7CiAgICAgICAgICAgIGlmIChyZXNwb25zZVN0YXR1cyA9PSAiYXBwcm92ZWQiKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXNwb25zZS5EYXRhID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbWZhID0gbmV3CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgcHVzaEFwcHJvdmVkID0gdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kID0gInB1c2giLAogICAgICAgICAgICAgICAgICAgICAgICBhcHByb3ZlZEF0ID0gY29udGV4dC5Cb2R5LmRhdGE/LnJlc3BvbmRlZEF0CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmIChyZXNwb25zZVN0YXR1cyA9PSAiZGVuaWVkIikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcmVzcG9uc2UuRGF0YSA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG1mYSA9IG5ldwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9ICJBdXRoZW50aWNhdGlvbiByZXF1ZXN0IGRlbmllZCBieSB1c2VyIiwKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JDb2RlID0gImFjY2Vzc19kZW5pZWQiCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIC8vIFN0aWxsIHBlbmRpbmcsIGNvbnRpbnVlIHdhaXRpbmcKICAgICAgICAgICAgICAgIHJlc3BvbnNlLkRhdGEgPSBuZXcKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBtZmEgPSBuZXcKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZSwgLy8gU3RpbGwgcGVuZGluZwogICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXMgPSAicGVuZGluZyIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIHJlc3BvbnNlLkRhdGEgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbWZhID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGVycm9yID0gIlNlcnZlciBlcnJvciBvY2N1cnJlZCIsCiAgICAgICAgICAgICAgICAgICAgZXJyb3JDb2RlID0gInNlcnZlcl9lcnJvciIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXNwb25zZTsKICAgIH0KfQ==\"\n                }\n              }\n            ]\n          },\n          {\n            \"key\": \"push-denied\",\n            \"target\": \"push-failed\",\n            \"triggerType\": 0,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Push Notification Denied\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Push Bildirimi Reddedildi\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": null,\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": [\n              {\n                \"order\": 1,\n                \"task\": {\n                  \"key\": \"check-push-denied-response\",\n                  \"domain\": \"{{domain}}\",\n                  \"version\": \"1.0.0\",\n                  \"flow\": \"sys-tasks\"\n                },\n                \"mapping\": {\n                  \"location\": \"./src/CheckPushDeniedResponseMapping.csx\",\n                  \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKcHVibGljIGNsYXNzIENoZWNrUHVzaERlbmllZFJlc3BvbnNlTWFwcGluZyA6IElNYXBwaW5nCnsKICAgIHB1YmxpYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBJbnB1dEhhbmRsZXIoV29ya2Zsb3dUYXNrIHRhc2ssIFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICByZXR1cm4gVGFzay5Gcm9tUmVzdWx0KG5ldyBTY3JpcHRSZXNwb25zZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgYXN5bmMgVGFzazxTY3JpcHRSZXNwb25zZT4gT3V0cHV0SGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgdmFyIHJlc3BvbnNlID0gbmV3IFNjcmlwdFJlc3BvbnNlKCk7CiAgICAgICAgcmVzcG9uc2UuRGF0YSA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG1mYSA9IG5ldwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICBwdXNoQXBwcm92ZWQgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kID0gInB1c2giLAogICAgICAgICAgICAgICAgICAgICAgICBhcHByb3ZlZEF0ID0gRGF0ZVRpbWUuVXRjTm93CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlOwogICAgfQp9\"\n                }\n              }\n            ]\n          }\n        ]\n      },\n      {\n        \"key\": \"push-success\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Push MFA Success\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Push MFA Başarılı\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": []\n      },\n      {\n        \"key\": \"push-failed\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Push MFA Failed\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Push MFA Başarısız\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": []\n      },\n      {\n        \"key\": \"push-expired\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Push Notification Expired\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Push Bildirimi Süresi Doldu\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": []\n      }\n    ]\n  }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Push Notify SubFlow",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								}
							]
						},
						{
							"name": "Tasks",
							"item": [
								{
									"name": "1 - Start - Check Device Register",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"check-device-registration\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"oauth2\",\n    \"device-registration\",\n    \"mfa\",\n    \"user-device\",\n    \"security\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"{{mockoonApi}}/api/oauth2/devices/check\",\n      \"method\": \"GET\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 5,\n      \"validateSsl\": false\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Check Device Register",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Check Push Response",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"check-push-response\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"oauth2\",\n    \"push-notification\",\n    \"mfa\",\n    \"response-check\",\n    \"approval\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"{{mockoonApi}}/api/oauth2/push/status\",\n      \"method\": \"POST\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 5,\n      \"validateSsl\": false\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Check Push Response",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Check Push Denied Response",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"check-push-denied-response\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"oauth2\",\n    \"push-notification\",\n    \"mfa\",\n    \"response-check\",\n    \"approval\"\n  ],\n  \"attributes\": {\n    \"type\": \"7\",\n    \"config\": {\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Check Push Denied Response",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Generate Token",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"generate-tokens\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"oauth2\",\n    \"token-generation\",\n    \"jwt\",\n    \"access-token\",\n    \"refresh-token\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"{{mockoonApi}}/api/oauth2/tokens/generate\",\n      \"method\": \"POST\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 5,\n      \"validateSsl\": false\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Generate Token",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Register Device",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"register-device\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"oauth2\",\n    \"device-registration\",\n    \"mfa\",\n    \"user-device\",\n    \"security\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"{{mockoonApi}}/api/oauth2/devices/register\",\n      \"method\": \"POST\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 5,\n      \"validateSsl\": false\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Register Device",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Send Otp Nofity",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"send-otp-notification\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"oauth2\",\n    \"otp\",\n    \"notification\",\n    \"mfa\",\n    \"sms\",\n    \"email\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"{{mockoonApi}}/api/oauth2/otp/send\",\n      \"method\": \"POST\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 10,\n      \"validateSsl\": false\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Send Otp Notify",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Send Push Notify",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"send-push-notification\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"oauth2\",\n    \"push-notification\",\n    \"mfa\",\n    \"mobile\",\n    \"approval\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"{{mockoonApi}}/api/oauth2/push/send\",\n      \"method\": \"POST\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 10,\n      \"validateSsl\": false\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Send Push Notify",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Validate Authorization Code",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"validate-authorization-code\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"oauth2\",\n    \"authorization-code\",\n    \"authentication\",\n    \"pkce\",\n    \"security\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"{{mockoonApi}}/api/oauth2/user/validate-authorization-code\",\n      \"method\": \"POST\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 10,\n      \"validateSsl\": false\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Validate Authorization Code",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Validate Client",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"validate-client\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"oauth2\",\n    \"client-validation\",\n    \"authentication\",\n    \"security\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"{{mockoonApi}}/api/oauth2/client/validate\",\n      \"method\": \"POST\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 5,\n      \"validateSsl\": false\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Validate Client",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Validate User Credential",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"validate-user-credentials\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"oauth2\",\n    \"user-validation\",\n    \"authentication\",\n    \"password\",\n    \"credentials\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"{{mockoonApi}}/api/oauth2/user/authenticate\",\n      \"method\": \"POST\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 10,\n      \"validateSsl\": false\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Validate User Credential",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Verify Otp Code",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"verify-otp-code\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"oauth2\",\n    \"otp\",\n    \"verification\",\n    \"mfa\",\n    \"two-factor\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"{{mockoonApi}}/api/oauth2/otp/verify\",\n      \"method\": \"POST\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 5,\n      \"validateSsl\": false\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Verify Otp Code",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								}
							]
						}
					]
				},
				{
					"name": "Instance Execute",
					"item": [
						{
							"name": "Get Instance Data",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instance",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										":domain",
										"workflows",
										":flow",
										"instances",
										":instance"
									],
									"variable": [
										{
											"key": "domain",
											"value": "{{domain}}"
										},
										{
											"key": "flow",
											"value": "oauth-authentication"
										},
										{
											"key": "instance",
											"value": "{{instanceId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Step 1: Start Instance",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"if (pm.response.code === 200 || pm.response.code === 201) {",
											"    var jsonData = pm.response.json();",
											"    pm.collectionVariables.set('instanceId', jsonData.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"var uuid = require('uuid');",
											"pm.collectionVariables.set(\"requestId\",uuid.v4());"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept-Language",
										"value": "tr-TR",
										"type": "text"
									},
									{
										"key": "X-Request-Id",
										"value": "{{requestId}}",
										"type": "text"
									},
									{
										"key": "X-Device-Id",
										"value": "{{requestId}}",
										"type": "text"
									},
									{
										"key": "X-Token-Id",
										"value": "{{requestId}}",
										"type": "text"
									},
									{
										"key": "X-Device-Info",
										"value": "IOS 16",
										"type": "text"
									},
									{
										"key": "X-Forwarded-For",
										"value": "192.168.2.1",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"key\": \"34987491872323\",\n    \"tags\": [\n        \"test\",\n        \"oauth\",\n        \"authentication\"\n    ],\n    \"attributes\": {\n        \"username\": \"34987491778\",\n        \"password\": \"112233\",\n        \"grant_type\": \"password\",\n        \"client_id\": \"acme\",\n        \"client_secret\": \"1q2w3e*\",\n        \"scope\": \"openid profile product-api\"\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										":domain",
										"workflows",
										":flow",
										"instances",
										"start"
									],
									"query": [
										{
											"key": "sync",
											"value": "true"
										}
									],
									"variable": [
										{
											"key": "domain",
											"value": "{{domain}}"
										},
										{
											"key": "flow",
											"value": "oauth-authentication"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Step 2: Push Send Approval",
							"request": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instance/transitions/:transition?sync=true",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										":domain",
										"workflows",
										":flow",
										"instances",
										":instance",
										"transitions",
										":transition"
									],
									"query": [
										{
											"key": "sync",
											"value": "true"
										}
									],
									"variable": [
										{
											"key": "domain",
											"value": "{{domain}}"
										},
										{
											"key": "flow",
											"value": "oauth-authentication"
										},
										{
											"key": "instance",
											"value": "{{instanceId}}"
										},
										{
											"key": "transition",
											"value": "push-approved"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Step 2.1: If: Push Send Denied (Optional)",
							"request": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instance/transitions/:transition?sync=true",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										":domain",
										"workflows",
										":flow",
										"instances",
										":instance",
										"transitions",
										":transition"
									],
									"query": [
										{
											"key": "sync",
											"value": "true"
										}
									],
									"variable": [
										{
											"key": "domain",
											"value": "{{domain}}"
										},
										{
											"key": "flow",
											"value": "oauth-authentication"
										},
										{
											"key": "instance",
											"value": "{{instanceId}}"
										},
										{
											"key": "transition",
											"value": "push-denied"
										}
									]
								}
							},
							"response": []
						}
					]
				}
			]
		},
		{
			"name": "Payment",
			"item": [
				{
					"name": "Definitions",
					"item": [
						{
							"name": "Flows",
							"item": [
								{
									"name": "1 - Start - Scheduled Payments Flow",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"scheduled-payments\",\n  \"flow\": \"sys-flows\",\n  \"domain\": \"{{domain}}\",\n  \"version\": \"1.0.0\",\n  \"tags\": [\n    \"payments\",\n    \"scheduled\",\n    \"recurring\",\n    \"financial\",\n    \"automation\"\n  ],\n  \"attributes\": {\n    \"type\": \"F\",\n    \"timeout\": null,\n    \"labels\": [\n      {\n        \"language\": \"en-US\",\n        \"label\": \"Scheduled Payments Workflow\"\n      },\n      {\n        \"language\": \"tr-TR\",\n        \"label\": \"Zamanlanmış Ödemeler İş Akışı\"\n      }\n    ],\n    \"functions\": [],\n    \"features\": [],\n    \"extensions\": [],\n    \"sharedTransitions\": [],\n    \"startTransition\": {\n      \"key\": \"start-payment-setup\",\n      \"target\": \"payment-configuration\",\n      \"triggerType\": 0,\n      \"versionStrategy\": \"Minor\",\n      \"labels\": [\n        {\n          \"language\": \"en-US\",\n          \"label\": \"Start Payment Setup\"\n        },\n        {\n          \"language\": \"tr-TR\",\n          \"label\": \"Ödeme Kurulum Başlat\"\n        }\n      ],\n      \"schema\": {\n        \"key\": \"payment-start-validation\",\n        \"domain\": \"{{domain}}\",\n        \"version\": \"1.0.0\",\n        \"flow\": \"sys-schemas\"\n      },\n      \"rule\": null,\n      \"timer\": null,\n      \"view\": null,\n      \"onExecutionTasks\": []\n    },\n    \"states\": [\n      {\n        \"key\": \"payment-configuration\",\n        \"stateType\": 1,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Manual - Save Payment Configuration\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Manuel - Ödeme Konfigürasyonu Kaydet\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"save-payment-configuration\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/SavePaymentConfigurationMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKLy8vIDxzdW1tYXJ5PgovLy8gU2F2ZSBQYXltZW50IENvbmZpZ3VyYXRpb24gTWFwcGluZyAtIFBheW1lbnQgc2NoZWR1bGUgY29uZmlndXJhdGlvbiBzYXZpbmcKLy8vIDwvc3VtbWFyeT4KcHVibGljIGNsYXNzIFNhdmVQYXltZW50Q29uZmlndXJhdGlvbk1hcHBpbmcgOiBJTWFwcGluZwp7CiAgICBwdWJsaWMgVGFzazxTY3JpcHRSZXNwb25zZT4gSW5wdXRIYW5kbGVyKFdvcmtmbG93VGFzayB0YXNrLCBTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgdHJ5CiAgICAgICAgewogICAgICAgICAgICB2YXIgaHR0cFRhc2sgPSB0YXNrIGFzIEh0dHBUYXNrOwogICAgICAgICAgICBpZiAoaHR0cFRhc2sgPT0gbnVsbCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRPcGVyYXRpb25FeGNlcHRpb24oIlRhc2sgbXVzdCBiZSBhbiBIdHRwVGFzayBmb3IgcGF5bWVudCBjb25maWd1cmF0aW9uIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFByZXBhcmUgcGF5bWVudCBjb25maWd1cmF0aW9uIGRhdGEKICAgICAgICAgICAgdmFyIHBheW1lbnRDb25maWcgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdXNlcklkID0gY29udGV4dC5Cb2R5Py51c2VySWQsCiAgICAgICAgICAgICAgICBhbW91bnQgPSBjb250ZXh0LkJvZHk/LmFtb3VudCwKICAgICAgICAgICAgICAgIGN1cnJlbmN5ID0gY29udGV4dC5Cb2R5Py5jdXJyZW5jeSA/PyAiVVNEIiwKICAgICAgICAgICAgICAgIGZyZXF1ZW5jeSA9IGNvbnRleHQuQm9keT8uZnJlcXVlbmN5ID8/ICJtb250aGx5IiwKICAgICAgICAgICAgICAgIHN0YXJ0RGF0ZSA9IGNvbnRleHQuQm9keT8uc3RhcnREYXRlLAogICAgICAgICAgICAgICAgZW5kRGF0ZSA9IGNvbnRleHQuQm9keT8uZW5kRGF0ZSwKICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2RJZCA9IGNvbnRleHQuQm9keT8ucGF5bWVudE1ldGhvZElkLAogICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gPSBjb250ZXh0LkJvZHk/LmRlc2NyaXB0aW9uLAogICAgICAgICAgICAgICAgcmVjaXBpZW50SWQgPSBjb250ZXh0LkJvZHk/LnJlY2lwaWVudElkLAogICAgICAgICAgICAgICAgaXNBdXRvUmV0cnkgPSBjb250ZXh0LkJvZHk/LmlzQXV0b1JldHJ5ID8/IHRydWUsCiAgICAgICAgICAgICAgICBtYXhSZXRyaWVzID0gY29udGV4dC5Cb2R5Py5tYXhSZXRyaWVzID8/IDMKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGh0dHBUYXNrLlNldEJvZHkocGF5bWVudENvbmZpZyk7CgogICAgICAgICAgICAvLyBTZXQgSGVhZGVycwogICAgICAgICAgICB2YXIgaGVhZGVycyA9IG5ldyBEaWN0aW9uYXJ5PHN0cmluZywgc3RyaW5nPz4KICAgICAgICAgICAgewogICAgICAgICAgICAgICAgWyJDb250ZW50LVR5cGUiXSA9ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgICAgIFsiWC1Xb3JrZmxvdy1JbnN0YW5jZSJdID0gY29udGV4dC5JbnN0YW5jZT8uSWQuVG9TdHJpbmcoKSwKICAgICAgICAgICAgICAgIFsiWC1Vc2VyLUlkIl0gPSBjb250ZXh0LkJvZHk/LnVzZXJJZD8uVG9TdHJpbmcoKQogICAgICAgICAgICB9OwoKICAgICAgICAgICAgaHR0cFRhc2suU2V0SGVhZGVycyhoZWFkZXJzKTsKCiAgICAgICAgICAgIHJldHVybiBUYXNrLkZyb21SZXN1bHQobmV3IFNjcmlwdFJlc3BvbnNlKCkpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChuZXcgU2NyaXB0UmVzcG9uc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgS2V5ID0gInBheW1lbnQtY29uZmlnLWVycm9yIiwKICAgICAgICAgICAgICAgIERhdGEgPSBuZXcgeyBlcnJvciA9IGV4Lk1lc3NhZ2UgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGFzeW5jIFRhc2s8U2NyaXB0UmVzcG9uc2U+IE91dHB1dEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICAgICAgdmFyIHN0YXR1c0NvZGUgPSBjb250ZXh0LkJvZHk/LnN0YXR1c0NvZGUgPz8gNTAwOwogICAgICAgICAgICB2YXIgcmVzcG9uc2VEYXRhID0gY29udGV4dC5Cb2R5Py5kYXRhOwoKICAgICAgICAgICAgaWYgKHN0YXR1c0NvZGUgPj0gMjAwICYmIHN0YXR1c0NvZGUgPCAzMDApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBwYXltZW50U2NoZWR1bGUgPSBuZXcKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZUlkID0gcmVzcG9uc2VEYXRhPy5zY2hlZHVsZUlkLAogICAgICAgICAgICAgICAgICAgIHN0YXR1cyA9ICJpbmFjdGl2ZSIsIC8vIGluaXRpYWwgc3RhdGUKICAgICAgICAgICAgICAgICAgICBuZXh0UGF5bWVudERhdGUgPSByZXNwb25zZURhdGE/Lm5leHRQYXltZW50RGF0ZSwKICAgICAgICAgICAgICAgICAgICBtYXhQYXltZW50cyA9IHJlc3BvbnNlRGF0YT8ubWF4UGF5bWVudHMsCiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0ID0gRGF0ZVRpbWUuVXRjTm93LAogICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlZFBheW1lbnRzID0gMCwKICAgICAgICAgICAgICAgICAgICBsYXN0UGF5bWVudEF0ID0gRGF0ZVRpbWUuVXRjTm93LAogICAgICAgICAgICAgICAgICAgIGlzQWN0aXZlID0gZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgYWN0aXZhdGVkQXQgPSBEYXRlVGltZS5VdGNOb3csCiAgICAgICAgICAgICAgICAgICAgYXJjaGl2ZWQgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBmaW5pc2hlZEF0ID0gRGF0ZVRpbWUuVXRjTm93CiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU2NyaXB0UmVzcG9uc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBLZXkgPSAicGF5bWVudC1jb25maWctc3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgRGF0YSA9IG5ldwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudFNjaGVkdWxlID0gcGF5bWVudFNjaGVkdWxlLAogICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50UmVzdWx0cyA9IG5ldyBMaXN0PGR5bmFtaWM+KCkKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIFRhZ3MgPSBuZXdbXSB7ICJwYXltZW50cyIsICJzY2hlZHVsZSIsICJjb25maWd1cmF0aW9uIiwgInN1Y2Nlc3MiIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgcGF5bWVudFNjaGVkdWxlID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGVycm9yID0gIkZhaWxlZCB0byBzYXZlIHBheW1lbnQgY29uZmlndXJhdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgZXJyb3JDb2RlID0gImNvbmZpZ19zYXZlX2ZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgc3RhdHVzQ29kZSA9IHN0YXR1c0NvZGUKICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTY3JpcHRSZXNwb25zZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIEtleSA9ICJwYXltZW50LWNvbmZpZy1mYWlsdXJlIiwKICAgICAgICAgICAgICAgICAgICBEYXRhID0gbmV3CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50U2NoZWR1bGUgPSBwYXltZW50U2NoZWR1bGUsCiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRSZXN1bHRzID0gbmV3IExpc3Q8ZHluYW1pYz4oKQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgVGFncyA9IG5ld1tdIHsgInBheW1lbnRzIiwgInNjaGVkdWxlIiwgImNvbmZpZ3VyYXRpb24iLCAiZmFpbHVyZSIgfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBTY3JpcHRSZXNwb25zZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBLZXkgPSAicGF5bWVudC1jb25maWctZXhjZXB0aW9uIiwKICAgICAgICAgICAgICAgIERhdGEgPSBuZXcKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBwYXltZW50U2NoZWR1bGUgPSBuZXcKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSAiSW50ZXJuYWwgcHJvY2Vzc2luZyBlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yQ29kZSA9ICJwcm9jZXNzaW5nX2Vycm9yIiwKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JEZXNjcmlwdGlvbiA9IGV4Lk1lc3NhZ2UKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHBheW1lbnRSZXN1bHRzID0gbmV3IExpc3Q8ZHluYW1pYz4oKQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIFRhZ3MgPSBuZXdbXSB7ICJwYXltZW50cyIsICJzY2hlZHVsZSIsICJjb25maWd1cmF0aW9uIiwgImVycm9yIiB9CiAgICAgICAgICAgIH07CiAgICAgICAgfQogICAgfQp9\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"payment-config-saved\",\n            \"target\": \"payment-active\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Auto - Payment Saved Successfully\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Otomatik - Ödeme Başarıyla Kaydedildi\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/PaymentConfigSavedRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBQYXltZW50Q29uZmlnU2F2ZWRSdWxlIDogSUNvbmRpdGlvbk1hcHBpbmcKewogICAgcHVibGljIGFzeW5jIFRhc2s8Ym9vbD4gSGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgdHJ5CiAgICAgICAgewogICAgICAgICAgICBpZiAoY29udGV4dD8uSW5zdGFuY2U/LkRhdGEgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAgIHZhciBwYXltZW50U2NoZWR1bGUgPSBjb250ZXh0Lkluc3RhbmNlLkRhdGEucGF5bWVudFNjaGVkdWxlOwogICAgICAgICAgICBpZiAocGF5bWVudFNjaGVkdWxlID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICByZXR1cm4gcGF5bWVudFNjaGVkdWxlLnN1Y2Nlc3MgPT0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbikKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9Cn0K\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"payment-config-failed\",\n            \"target\": \"payment-configuration\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Configuration Failed - Retry\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Konfigürasyon Başarısız - Tekrar Dene\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/PaymentConfigFailedRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBQYXltZW50Q29uZmlnRmFpbGVkUnVsZSA6IElDb25kaXRpb25NYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICAgICAgaWYgKGNvbnRleHQ/Lkluc3RhbmNlPy5EYXRhID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgICAgICAgIHZhciBwYXltZW50U2NoZWR1bGUgPSBjb250ZXh0Lkluc3RhbmNlLkRhdGEucGF5bWVudFNjaGVkdWxlOwogICAgICAgICAgICBpZiAocGF5bWVudFNjaGVkdWxlID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgICAgICAgIHJldHVybiBwYXltZW50U2NoZWR1bGUuc3VjY2VzcyA9PSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbikKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgIH0KfQo=\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"payment-active\",\n        \"stateType\": 4,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Active\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Aktif\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": {\n          \"type\": \"S\",\n          \"process\": {\n            \"key\": \"payment-process\",\n            \"domain\": \"{{domain}}\",\n            \"version\": \"1.0.0\",\n            \"flow\": \"sys-flows\"\n          },\n          \"mapping\": {\n            \"location\": \"./src/PaymentProcessMapping.csx\",\n            \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBQYXltZW50UHJvY2Vzc01hcHBpbmcgOiBJU3ViRmxvd01hcHBpbmcKewogICAgcHVibGljIFRhc2s8U2NyaXB0UmVzcG9uc2U+IElucHV0SGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgLy8gUGFzcyBwYXltZW50IHNjaGVkdWxlIGRhdGEgdG8gc3VicHJvY2VzcwogICAgICAgIHJldHVybiBUYXNrLkZyb21SZXN1bHQobmV3IFNjcmlwdFJlc3BvbnNlCiAgICAgICAgewogICAgICAgICAgICBEYXRhID0gY29udGV4dC5JbnN0YW5jZS5EYXRhLAogICAgICAgICAgICBIZWFkZXJzID0gbnVsbAogICAgICAgIH0pOwogICAgfQoKICAgIHB1YmxpYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBPdXRwdXRIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICByZXR1cm4gVGFzay5Gcm9tUmVzdWx0KG5ldyBTY3JpcHRSZXNwb25zZQogICAgICAgIHsKICAgICAgICAgICAgRGF0YSA9IGNvbnRleHQuQm9keSwKICAgICAgICAgICAgVGFncyA9IG5ld1tdIHsgInBheW1lbnRzIiwgInN1YmZsb3ciLCAiY29tcGxldGVkIiwgInBheW1lbnQtcmVzdWx0LWFkZGVkIiB9CiAgICAgICAgfSk7CiAgICB9Cn0=\"\n          }\n        },\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"activate-payment-schedule\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/ActivatePaymentScheduleMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKcHVibGljIGNsYXNzIEFjdGl2YXRlUGF5bWVudFNjaGVkdWxlTWFwcGluZyA6IElNYXBwaW5nCnsKICAgIHB1YmxpYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBJbnB1dEhhbmRsZXIoV29ya2Zsb3dUYXNrIHRhc2ssIFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICB2YXIgaHR0cFRhc2sgPSB0YXNrIGFzIEh0dHBUYXNrOwogICAgICAgIGlmIChodHRwVGFzayA9PSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZE9wZXJhdGlvbkV4Y2VwdGlvbigiVGFzayBtdXN0IGJlIGFuIEh0dHBUYXNrIik7CgogICAgICAgIHZhciBhY3RpdmF0aW9uRGF0YSA9IG5ldwogICAgICAgIHsKICAgICAgICAgICAgc2NoZWR1bGVJZCA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LnBheW1lbnRTY2hlZHVsZT8uc2NoZWR1bGVJZCwKICAgICAgICAgICAgc3RhdHVzID0gImFjdGl2ZSIsCiAgICAgICAgICAgIGFjdGl2YXRlZEF0ID0gRGF0ZVRpbWUuVXRjTm93CiAgICAgICAgfTsKCiAgICAgICAgaHR0cFRhc2suU2V0Qm9keShhY3RpdmF0aW9uRGF0YSk7CiAgICAgICAgdmFyIGhlYWRlcnMgPSBuZXcgRGljdGlvbmFyeTxzdHJpbmcsIHN0cmluZz8+CiAgICAgICAgewogICAgICAgICAgICBbIkNvbnRlbnQtVHlwZSJdID0gImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICBbIlgtU2NoZWR1bGUtSWQiXSA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LnBheW1lbnRTY2hlZHVsZT8uc2NoZWR1bGVJZD8uVG9TdHJpbmcoKQogICAgICAgIH07CiAgICAgICAgaHR0cFRhc2suU2V0SGVhZGVycyhoZWFkZXJzKTsKCiAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChuZXcgU2NyaXB0UmVzcG9uc2UoKSk7CiAgICB9CgogICAgcHVibGljIGFzeW5jIFRhc2s8U2NyaXB0UmVzcG9uc2U+IE91dHB1dEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHZhciByZXNwb25zZSA9IG5ldyBTY3JpcHRSZXNwb25zZSgpOwogICAgICAgIHZhciBzdGF0dXNDb2RlID0gY29udGV4dC5Cb2R5Py5zdGF0dXNDb2RlID8/IDUwMDsKCiAgICAgICAgaWYgKHN0YXR1c0NvZGUgPj0gMjAwICYmIHN0YXR1c0NvZGUgPCAzMDApCiAgICAgICAgewogICAgICAgICAgICByZXNwb25zZS5EYXRhID0gbmV3CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHBheW1lbnRTY2hlZHVsZSA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHN0YXR1cyA9ICJhY3RpdmUiLAogICAgICAgICAgICAgICAgICAgIGFjdGl2YXRlZEF0ID0gRGF0ZVRpbWUuVXRjTm93LAogICAgICAgICAgICAgICAgICAgIGlzQWN0aXZlID0gdHJ1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICByZXNwb25zZS5EYXRhID0gbmV3CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHBheW1lbnRTY2hlZHVsZSA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHN0YXR1cyA9ICJpbmFjdGl2ZSIsCiAgICAgICAgICAgICAgICAgICAgaXNBY3RpdmUgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBlcnJvciA9ICJGYWlsZWQgdG8gYWN0aXZhdGUgcGF5bWVudCBzY2hlZHVsZSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXNwb25zZTsKICAgIH0KfQo=\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"manual-deactivate-payment\",\n            \"target\": \"payment-deactive\",\n            \"triggerType\": 0,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Manual - Deactivate Payment\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Manuel - Ödemeyi Deaktive Et\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": null,\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"payment-process-complete\",\n            \"target\": \"payment-cycle-check\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Auto - Payment Process Complete (Success & More Payments Remaining)\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Otomatik - Ödeme Süreci Tamamlandı (Başarılı & Daha Fazla Ödeme Var)\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/PaymentProcessCompleteRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBQYXltZW50UHJvY2Vzc0NvbXBsZXRlUnVsZSA6IElDb25kaXRpb25NYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICAgICAgLy8gQ2hlY2sgaWYgcGF5bWVudCB3YXMgc3VjY2Vzc2Z1bAogICAgICAgICAgICB2YXIgcGF5bWVudFJlc3VsdCA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LnBheW1lbnRSZXN1bHQ7CiAgICAgICAgICAgIGlmIChwYXltZW50UmVzdWx0ID09IG51bGwgfHwgcGF5bWVudFJlc3VsdC5zdWNjZXNzICE9IHRydWUpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICAvLyBDaGVjayBpZiBtb3JlIHBheW1lbnRzIGFyZSByZW1haW5pbmcKICAgICAgICAgICAgdmFyIHBheW1lbnRTY2hlZHVsZSA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LnBheW1lbnRTY2hlZHVsZTsKICAgICAgICAgICAgaWYgKHBheW1lbnRTY2hlZHVsZSA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgLy8gQ2hlY2sgaWYgbWF4aW11bSBwYXltZW50IGNvdW50IGlzIHJlYWNoZWQKICAgICAgICAgICAgdmFyIG1heFBheW1lbnRzID0gcGF5bWVudFNjaGVkdWxlLm1heFBheW1lbnRzOwogICAgICAgICAgICB2YXIgY29tcGxldGVkUGF5bWVudHMgPSBwYXltZW50U2NoZWR1bGUuY29tcGxldGVkUGF5bWVudHMgPz8gMDsKCiAgICAgICAgICAgIC8vIElmIG1heFBheW1lbnRzIGlzIG51bGwsIGNvbnRpbnVlIGluZGVmaW5pdGVseSAodW50aWwgZW5kRGF0ZSkKICAgICAgICAgICAgaWYgKG1heFBheW1lbnRzICE9IG51bGwgJiYgY29tcGxldGVkUGF5bWVudHMgPj0gbWF4UGF5bWVudHMpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICAvLyBDaGVjayBpZiBlbmQgZGF0ZSBpcyByZWFjaGVkCiAgICAgICAgICAgIGlmIChjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5lbmREYXRlICE9IG51bGwpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChEYXRlVGltZS5UcnlQYXJzZShjb250ZXh0Lkluc3RhbmNlLkRhdGEuZW5kRGF0ZS5Ub1N0cmluZygpLCBvdXQgRGF0ZVRpbWUgZW5kRGF0ZSkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYgKERhdGVUaW1lLlV0Y05vdyA+PSBlbmREYXRlKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIElmIGFsbCBjaGVja3MgcGFzcywgY29udGludWUgdG8gbmV4dCBwYXltZW50IGN5Y2xlCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uKQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KfQ==\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"payments-all-complete\",\n            \"target\": \"payment-finished\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Auto - All Payments Complete (Count/Date/Pattern Finished)\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Otomatik - Tüm Ödemeler Tamamlandı (Sayı/Tarih/Desen Bitti)\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/PaymentsAllCompleteRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBQYXltZW50c0FsbENvbXBsZXRlUnVsZSA6IElDb25kaXRpb25NYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICAgICAgdmFyIHBheW1lbnRTY2hlZHVsZSA9IGNvbnRleHQuSW5zdGFuY2UuRGF0YS5wYXltZW50U2NoZWR1bGU7CiAgICAgICAgICAgIGlmIChwYXltZW50U2NoZWR1bGUgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAgIC8vIENoZWNrIGlmIGVuZCBkYXRlIGlzIHJlYWNoZWQKICAgICAgICAgICAgaWYgKGNvbnRleHQuSW5zdGFuY2UuRGF0YS5lbmREYXRlICE9IG51bGwpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChEYXRlVGltZS5UcnlQYXJzZShjb250ZXh0Lkluc3RhbmNlLkRhdGEuZW5kRGF0ZS5Ub1N0cmluZygpLCBvdXQgRGF0ZVRpbWUgZW5kRGF0ZSkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYgKERhdGVUaW1lLlV0Y05vdyA+PSBlbmREYXRlKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gQ2hlY2sgaWYgbWF4aW11bSBwYXltZW50IGNvdW50IGlzIHJlYWNoZWQKICAgICAgICAgICAgdmFyIG1heFBheW1lbnRzID0gcGF5bWVudFNjaGVkdWxlLm1heFBheW1lbnRzOwogICAgICAgICAgICB2YXIgY29tcGxldGVkUGF5bWVudHMgPSBwYXltZW50U2NoZWR1bGUuY29tcGxldGVkUGF5bWVudHMgPz8gMDsKCiAgICAgICAgICAgIGlmIChtYXhQYXltZW50cyAhPSBudWxsICYmIGNvbXBsZXRlZFBheW1lbnRzID49IG1heFBheW1lbnRzKQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChFeGNlcHRpb24pCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQp9\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"payment-deactive\",\n        \"stateType\": 2,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Deactive\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Deaktif\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"deactivate-payment-schedule\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/DeactivatePaymentScheduleMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKcHVibGljIGNsYXNzIERlYWN0aXZhdGVQYXltZW50U2NoZWR1bGVNYXBwaW5nIDogSU1hcHBpbmcKewogICAgcHVibGljIFRhc2s8U2NyaXB0UmVzcG9uc2U+IElucHV0SGFuZGxlcihXb3JrZmxvd1Rhc2sgdGFzaywgU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHZhciBodHRwVGFzayA9IHRhc2sgYXMgSHR0cFRhc2s7CiAgICAgICAgaWYgKGh0dHBUYXNrID09IG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXhjZXB0aW9uKCJUYXNrIG11c3QgYmUgYW4gSHR0cFRhc2siKTsKCiAgICAgICAgdmFyIGRlYWN0aXZhdGlvbkRhdGEgPSBuZXcKICAgICAgICB7CiAgICAgICAgICAgIHNjaGVkdWxlSWQgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5wYXltZW50U2NoZWR1bGU/LnNjaGVkdWxlSWQsCiAgICAgICAgICAgIHN0YXR1cyA9ICJkZWFjdGl2ZSIsCiAgICAgICAgICAgIGRlYWN0aXZhdGVkQXQgPSBEYXRlVGltZS5VdGNOb3csCiAgICAgICAgICAgIHJlYXNvbiA9IGNvbnRleHQuQm9keT8ucmVhc29uID8/ICJNYW51YWwgZGVhY3RpdmF0aW9uIgogICAgICAgIH07CgogICAgICAgIGh0dHBUYXNrLlNldEJvZHkoZGVhY3RpdmF0aW9uRGF0YSk7CiAgICAgICAgdmFyIGhlYWRlcnMgPSBuZXcgRGljdGlvbmFyeTxzdHJpbmcsIHN0cmluZz8+CiAgICAgICAgewogICAgICAgICAgICBbIkNvbnRlbnQtVHlwZSJdID0gImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICBbIlgtU2NoZWR1bGUtSWQiXSA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LnBheW1lbnRTY2hlZHVsZT8uc2NoZWR1bGVJZD8uVG9TdHJpbmcoKQogICAgICAgIH07CiAgICAgICAgaHR0cFRhc2suU2V0SGVhZGVycyhoZWFkZXJzKTsKCiAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChuZXcgU2NyaXB0UmVzcG9uc2UoKSk7CiAgICB9CgogICAgcHVibGljIGFzeW5jIFRhc2s8U2NyaXB0UmVzcG9uc2U+IE91dHB1dEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHZhciByZXNwb25zZSA9IG5ldyBTY3JpcHRSZXNwb25zZSgpOwogICAgICAgIHZhciBzdGF0dXNDb2RlID0gY29udGV4dC5Cb2R5Py5zdGF0dXNDb2RlID8/IDUwMDsKCiAgICAgICAgaWYgKHN0YXR1c0NvZGUgPj0gMjAwICYmIHN0YXR1c0NvZGUgPCAzMDApCiAgICAgICAgewogICAgICAgICAgICByZXNwb25zZS5EYXRhID0gbmV3CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHBheW1lbnRTY2hlZHVsZSA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHN0YXR1cyA9ICJkZWFjdGl2ZSIsCiAgICAgICAgICAgICAgICAgICAgZGVhY3RpdmF0ZWRBdCA9IERhdGVUaW1lLlV0Y05vdywKICAgICAgICAgICAgICAgICAgICBpc0FjdGl2ZSA9IGZhbHNlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIHJlc3BvbnNlLkRhdGEgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcGF5bWVudFNjaGVkdWxlID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaXNBY3RpdmUgPSB0cnVlLCAvLyBTdGlsbCBhY3RpdmUgaWYgZmFpbGVkCiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSAiRmFpbGVkIHRvIGRlYWN0aXZhdGUgcGF5bWVudCBzY2hlZHVsZSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXNwb25zZTsKICAgIH0KfQ==\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"manual-reactivate-payment\",\n            \"target\": \"payment-active\",\n            \"triggerType\": 0,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Manual - Reactivate Payment\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Manuel - Ödemeyi Reaktive Et\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": null,\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"manual-update-payment\",\n            \"target\": \"payment-configuration\",\n            \"triggerType\": 0,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Manual - Update Payment\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Manuel - Ödemeyi Güncelle\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": null,\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"manual-delete-payment\",\n            \"target\": \"payment-terminated\",\n            \"triggerType\": 0,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Manual - Delete Payment\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Manuel - Ödemeyi Sil\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": null,\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"payment-cycle-check\",\n        \"stateType\": 4,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Payment Cycle Check\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Ödeme Döngüsü Kontrolü\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": {\n          \"type\": \"P\",\n          \"process\": {\n            \"key\": \"payment-notification-subflow\",\n            \"domain\": \"{{domain}}\",\n            \"version\": \"1.0.0\",\n            \"flow\": \"sys-flows\"\n          },\n          \"mapping\": {\n            \"location\": \"./src/PaymentNotificationSubflowMapping.csx\",\n            \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBQYXltZW50Tm90aWZpY2F0aW9uU3ViZmxvd01hcHBpbmcgOiBJU3ViUHJvY2Vzc01hcHBpbmcKewogICAgcHVibGljIFRhc2s8U2NyaXB0UmVzcG9uc2U+IElucHV0SGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgLy8gUGFzcyBwYXltZW50IGRhdGEgYW5kIHVzZXIgaW5mbyB0byBub3RpZmljYXRpb24gc3VicHJvY2VzcwogICAgICAgIGR5bmFtaWMgbm90aWZpY2F0aW9uRGF0YSA9IG5ldyBFeHBhbmRvT2JqZWN0KCk7CiAgICAgICAgbm90aWZpY2F0aW9uRGF0YS5wYXltZW50UmVzdWx0ICAgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5wYXltZW50UmVzdWx0OwogICAgICAgIG5vdGlmaWNhdGlvbkRhdGEucGF5bWVudFNjaGVkdWxlID0gY29udGV4dC5JbnN0YW5jZT8uRGF0YT8ucGF5bWVudFNjaGVkdWxlOwogICAgICAgIG5vdGlmaWNhdGlvbkRhdGEudXNlcklkICAgICAgICAgID0gY29udGV4dC5JbnN0YW5jZT8uRGF0YT8udXNlcklkOwogICAgICAgIG5vdGlmaWNhdGlvbkRhdGEubm90aWZpY2F0aW9uVHlwZT0gInBheW1lbnQtcmVzdWx0IjsKICAgICAgICBub3RpZmljYXRpb25EYXRhLnRpbWVzdGFtcCAgICAgICA9IERhdGVUaW1lLlV0Y05vdy5Ub1N0cmluZygibyIpOwoKICAgICAgICByZXR1cm4gVGFzay5Gcm9tUmVzdWx0KG5ldyBTY3JpcHRSZXNwb25zZQogICAgICAgIHsKICAgICAgICAgICAgRGF0YSA9IG5vdGlmaWNhdGlvbkRhdGEsCiAgICAgICAgICAgIEhlYWRlcnMgPSBudWxsCiAgICAgICAgfSk7CiAgICB9Cn0=\"\n          }\n        },\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"continue-payment-cycle\",\n            \"target\": \"payment-active\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Auto - Continue Payment Cycle\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Otomatik - Ödeme Döngüsünü Devam Ettir\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/ContinuePaymentCycleRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBDb250aW51ZVBheW1lbnRDeWNsZVJ1bGUgOiBJQ29uZGl0aW9uTWFwcGluZwp7CiAgICBwdWJsaWMgYXN5bmMgVGFzazxib29sPiBIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICAvLyBBbHdheXMgY29udGludWUgdG8gbmV4dCBwYXltZW50IGN5Y2xlCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0=\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"payment-finished\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Finished\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Tamamlandı\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"archive-payment-record\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/ArchivePaymentRecordMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKcHVibGljIGNsYXNzIEFyY2hpdmVQYXltZW50UmVjb3JkTWFwcGluZyA6IElNYXBwaW5nCnsKICAgIHB1YmxpYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBJbnB1dEhhbmRsZXIoV29ya2Zsb3dUYXNrIHRhc2ssIFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICB2YXIgaHR0cFRhc2sgPSB0YXNrIGFzIEh0dHBUYXNrOwogICAgICAgIGlmIChodHRwVGFzayA9PSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZE9wZXJhdGlvbkV4Y2VwdGlvbigiVGFzayBtdXN0IGJlIGFuIEh0dHBUYXNrIik7CgogICAgICAgIHZhciBhcmNoaXZlRGF0YSA9IG5ldwogICAgICAgIHsKICAgICAgICAgICAgc2NoZWR1bGVJZCA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LnBheW1lbnRTY2hlZHVsZT8uc2NoZWR1bGVJZCwKICAgICAgICAgICAgc3RhdHVzID0gImFyY2hpdmVkIiwKICAgICAgICAgICAgYXJjaGl2ZWRBdCA9IERhdGVUaW1lLlV0Y05vdywKICAgICAgICAgICAgY29tcGxldGlvblJlYXNvbiA9ICJBbGwgcGF5bWVudHMgY29tcGxldGVkIiwKICAgICAgICAgICAgZmluYWxQYXltZW50Q291bnQgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5wYXltZW50U2NoZWR1bGU/LmNvbXBsZXRlZFBheW1lbnRzCiAgICAgICAgfTsKCiAgICAgICAgaHR0cFRhc2suU2V0Qm9keShhcmNoaXZlRGF0YSk7CiAgICAgICAgdmFyIGhlYWRlcnMgPSBuZXcgRGljdGlvbmFyeTxzdHJpbmcsIHN0cmluZz8+CiAgICAgICAgewogICAgICAgICAgICBbIkNvbnRlbnQtVHlwZSJdID0gImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICBbIlgtU2NoZWR1bGUtSWQiXSA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LnBheW1lbnRTY2hlZHVsZT8uc2NoZWR1bGVJZD8uVG9TdHJpbmcoKQogICAgICAgIH07CiAgICAgICAgaHR0cFRhc2suU2V0SGVhZGVycyhoZWFkZXJzKTsKCiAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChuZXcgU2NyaXB0UmVzcG9uc2UoKSk7CiAgICB9CgogICAgcHVibGljIGFzeW5jIFRhc2s8U2NyaXB0UmVzcG9uc2U+IE91dHB1dEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHZhciByZXNwb25zZSA9IG5ldyBTY3JpcHRSZXNwb25zZSgpOwogICAgICAgIHZhciBzdGF0dXNDb2RlID0gY29udGV4dC5Cb2R5Py5zdGF0dXNDb2RlID8/IDUwMDsKCiAgICAgICAgcmVzcG9uc2UuRGF0YSA9IG5ldwogICAgICAgIHsKICAgICAgICAgICAgcGF5bWVudFNjaGVkdWxlID0gbmV3CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHN0YXR1cyA9ICJmaW5pc2hlZCIsCiAgICAgICAgICAgICAgICBhcmNoaXZlZCA9IHN0YXR1c0NvZGUgPj0gMjAwICYmIHN0YXR1c0NvZGUgPCAzMDAsCiAgICAgICAgICAgICAgICBmaW5pc2hlZEF0ID0gRGF0ZVRpbWUuVXRjTm93CiAgICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICByZXR1cm4gcmVzcG9uc2U7CiAgICB9Cn0K\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": []\n      },\n      {\n        \"key\": \"payment-terminated\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Terminated\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Sonlandırıldı\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": []\n      }\n    ]\n  }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Scheduled Payments Flow",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Payment Process SubFlow",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"payment-process\",\n  \"flow\": \"sys-flows\",\n  \"domain\": \"{{domain}}\",\n  \"version\": \"1.0.0\",\n  \"tags\": [\n    \"payments\",\n    \"process\",\n    \"retry\",\n    \"processing\",\n    \"transaction\"\n  ],\n  \"attributes\": {\n    \"type\": \"S\",\n    \"timeout\": null,\n    \"labels\": [\n      {\n        \"language\": \"en-US\",\n        \"label\": \"Payment Processing\"\n      },\n      {\n        \"language\": \"tr-TR\",\n        \"label\": \"Ödeme İşleme\"\n      }\n    ],\n    \"functions\": [],\n    \"features\": [],\n    \"extensions\": [],\n    \"sharedTransitions\": [],\n    \"startTransition\": {\n      \"key\": \"start-payment-processing\",\n      \"target\": \"payment-pending\",\n      \"triggerType\": 0,\n      \"versionStrategy\": \"Minor\",\n      \"labels\": [\n        {\n          \"language\": \"en-US\",\n          \"label\": \"Start Payment Processing\"\n        },\n        {\n          \"language\": \"tr-TR\",\n          \"label\": \"Ödeme İşlemeyi Başlat\"\n        }\n      ],\n      \"schema\": null,\n      \"rule\": null,\n      \"timer\": null,\n      \"view\": null,\n      \"onExecutionTasks\": []\n    },\n    \"states\": [\n      {\n        \"key\": \"payment-pending\",\n        \"stateType\": 2,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Payment Pending\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Ödeme Beklemede\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"scheduled-payment-due\",\n            \"target\": \"process-payment\",\n            \"triggerType\": 2,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Scheduled - Payment Due Date/Time\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Zamanlanmış - Ödeme Vade Tarihi/Saati\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": null,\n            \"timer\": {\n              \"location\": \"./src/PaymentDueTimerRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zLlRpbWVyOwoKcHVibGljIGNsYXNzIFBheW1lbnREdWVUaW1lclJ1bGUgOiBJVGltZXJNYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPFRpbWVyU2NoZWR1bGU+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIFRpbWVyU2NoZWR1bGUuRnJvbURhdGVUaW1lKERhdGVUaW1lLlV0Y05vdy5BZGRTZWNvbmRzKDYwKSk7IC8vIEZvciB0ZXN0aW5nCiAgICAgICAgICAgIC8vIHZhciBwYXltZW50U2NoZWR1bGUgPSBjb250ZXh0Lkluc3RhbmNlLkRhdGEucGF5bWVudFNjaGVkdWxlOwogICAgICAgICAgICAvLyBpZiAocGF5bWVudFNjaGVkdWxlID09IG51bGwpCiAgICAgICAgICAgIC8vICAgICByZXR1cm4gVGltZXJTY2hlZHVsZS5Gcm9tRGF0ZVRpbWUoRGF0ZVRpbWUuVXRjTm93LkFkZERheXMoMSkpOyAvLyBEZWZhdWx0IHRvIDEgZGF5CiAgICAKICAgICAgICAgICAgLy8gaWYgKHBheW1lbnRTY2hlZHVsZS5uZXh0UGF5bWVudERhdGUgIT0gbnVsbCkKICAgICAgICAgICAgLy8gewogICAgICAgICAgICAvLyAgICAgaWYgKERhdGVUaW1lLlRyeVBhcnNlKHBheW1lbnRTY2hlZHVsZS5uZXh0UGF5bWVudERhdGUuVG9TdHJpbmcoKSwgb3V0IERhdGVUaW1lIG5leHRQYXltZW50KSkKICAgICAgICAgICAgLy8gICAgICAgICByZXR1cm4gVGltZXJTY2hlZHVsZS5Gcm9tRGF0ZVRpbWUobmV4dFBheW1lbnQpOwogICAgICAgICAgICAvLyB9CgogICAgICAgICAgICAvLyAvLyBDYWxjdWxhdGUgbmV4dCBwYXltZW50IGJhc2VkIG9uIGZyZXF1ZW5jeQogICAgICAgICAgICAvLyB2YXIgZnJlcXVlbmN5ID0gY29udGV4dC5JbnN0YW5jZS5EYXRhLmZyZXF1ZW5jeT8uVG9TdHJpbmcoKS5Ub0xvd2VyKCkgPz8gIm1vbnRobHkiOwogICAgICAgICAgICAvLyByZXR1cm4gZnJlcXVlbmN5IHN3aXRjaAogICAgICAgICAgICAvLyB7CiAgICAgICAgICAgIC8vICAgICAiZGFpbHkiID0+IFRpbWVyU2NoZWR1bGUuRnJvbURhdGVUaW1lKERhdGVUaW1lLlV0Y05vdy5BZGREYXlzKDEpKSwKICAgICAgICAgICAgLy8gICAgICJ3ZWVrbHkiID0+IFRpbWVyU2NoZWR1bGUuRnJvbURhdGVUaW1lKERhdGVUaW1lLlV0Y05vdy5BZGREYXlzKDcpKSwKICAgICAgICAgICAgLy8gICAgICJtb250aGx5IiA9PiBUaW1lclNjaGVkdWxlLkZyb21EYXRlVGltZShEYXRlVGltZS5VdGNOb3cuQWRkTW9udGhzKDEpKSwKICAgICAgICAgICAgLy8gICAgICJxdWFydGVybHkiID0+IFRpbWVyU2NoZWR1bGUuRnJvbURhdGVUaW1lKERhdGVUaW1lLlV0Y05vdy5BZGRNb250aHMoMykpLAogICAgICAgICAgICAvLyAgICAgInllYXJseSIgPT4gVGltZXJTY2hlZHVsZS5Gcm9tRGF0ZVRpbWUoRGF0ZVRpbWUuVXRjTm93LkFkZFllYXJzKDEpKSwKICAgICAgICAgICAgLy8gICAgIF8gPT4gVGltZXJTY2hlZHVsZS5Gcm9tRGF0ZVRpbWUoRGF0ZVRpbWUuVXRjTm93LkFkZE1vbnRocygxKSkKICAgICAgICAgICAgLy8gfTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbikKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybiBUaW1lclNjaGVkdWxlLkZyb21EYXRlVGltZShEYXRlVGltZS5VdGNOb3cuQWRkRGF5cygxKSk7IC8vIEZhbGxiYWNrCiAgICAgICAgfQogICAgfQp9Cg==\"\n            },\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"manual-pay-now\",\n            \"target\": \"process-payment\",\n            \"triggerType\": 0,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Manual - Pay Now\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Manuel - Hemen Öde\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": null,\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"process-payment\",\n        \"stateType\": 1,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"ProcessPayment\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Ödeme İşle\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"process-payment\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/ProcessPaymentMapping.csx\",\n              \"code\": \"CnVzaW5nIFN5c3RlbS5UaHJlYWRpbmcuVGFza3M7CnVzaW5nIEJCVC5Xb3JrZmxvdy5TY3JpcHRpbmc7CnVzaW5nIEJCVC5Xb3JrZmxvdy5EZWZpbml0aW9uczsKCi8vLyA8c3VtbWFyeT4KLy8vIFByb2Nlc3MgUGF5bWVudCBNYXBwaW5nIC0gSGFuZGxlcyBwYXltZW50IHByb2Nlc3NpbmcgbG9naWMKLy8vIDwvc3VtbWFyeT4KcHVibGljIGNsYXNzIFByb2Nlc3NQYXltZW50TWFwcGluZyA6IElNYXBwaW5nCnsKICAgIHB1YmxpYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBJbnB1dEhhbmRsZXIoV29ya2Zsb3dUYXNrIHRhc2ssIFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICB0cnkKICAgICAgICB7CiAgICAgICAgICAgIHZhciBodHRwVGFzayA9IHRhc2sgYXMgSHR0cFRhc2s7CiAgICAgICAgICAgIGlmIChodHRwVGFzayA9PSBudWxsKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZE9wZXJhdGlvbkV4Y2VwdGlvbigiVGFzayBtdXN0IGJlIGFuIEh0dHBUYXNrIGZvciBwYXltZW50IHByb2Nlc3NpbmciKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gUHJlcGFyZSBwYXltZW50IHByb2Nlc3NpbmcgZGF0YQogICAgICAgICAgICB2YXIgcGF5bWVudFNjaGVkdWxlID0gY29udGV4dC5JbnN0YW5jZT8uRGF0YT8ucGF5bWVudFNjaGVkdWxlOwogICAgICAgICAgICB2YXIgcGF5bWVudFJlcXVlc3QgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgc2NoZWR1bGVJZCA9IHBheW1lbnRTY2hlZHVsZT8uc2NoZWR1bGVJZCwKICAgICAgICAgICAgICAgIHVzZXJJZCA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LnVzZXJJZCwKICAgICAgICAgICAgICAgIGFtb3VudCA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LmFtb3VudCwKICAgICAgICAgICAgICAgIGN1cnJlbmN5ID0gY29udGV4dC5JbnN0YW5jZT8uRGF0YT8uY3VycmVuY3ksCiAgICAgICAgICAgICAgICBwcm9jZXNzZWRBdCA9IERhdGVUaW1lLlV0Y05vdwogICAgICAgICAgICB9OwoKICAgICAgICAgICAgaHR0cFRhc2suU2V0Qm9keShwYXltZW50UmVxdWVzdCk7CgogICAgICAgICAgICAvLyBTZXQgSGVhZGVycwogICAgICAgICAgICB2YXIgaGVhZGVycyA9IG5ldyBEaWN0aW9uYXJ5PHN0cmluZywgc3RyaW5nPz4KICAgICAgICAgICAgewogICAgICAgICAgICAgICAgWyJDb250ZW50LVR5cGUiXSA9ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgICAgIFsiWC1TY2hlZHVsZS1JZCJdID0gcGF5bWVudFNjaGVkdWxlPy5zY2hlZHVsZUlkPy5Ub1N0cmluZygpLAogICAgICAgICAgICAgICAgWyJYLVBheW1lbnQtUmVxdWVzdC1JZCJdID0gR3VpZC5OZXdHdWlkKCkuVG9TdHJpbmcoKSwKICAgICAgICAgICAgICAgIFsiWC1SZXRyeS1Db3VudCJdID0gY29udGV4dC5JbnN0YW5jZT8uRGF0YS5tYXhSZXRyaWVzLlRvU3RyaW5nKCkKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGh0dHBUYXNrLlNldEhlYWRlcnMoaGVhZGVycyk7CgogICAgICAgICAgICByZXR1cm4gVGFzay5Gcm9tUmVzdWx0KG5ldyBTY3JpcHRSZXNwb25zZSgpKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBleCkKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybiBUYXNrLkZyb21SZXN1bHQobmV3IFNjcmlwdFJlc3BvbnNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIEtleSA9ICJwYXltZW50LXByb2Nlc3NpbmctZXJyb3IiLAogICAgICAgICAgICAgICAgRGF0YSA9IG5ldyB7IGVycm9yID0gZXguTWVzc2FnZSB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgYXN5bmMgVGFzazxTY3JpcHRSZXNwb25zZT4gT3V0cHV0SGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgdHJ5CiAgICAgICAgewogICAgICAgICAgICB2YXIgc3RhdHVzQ29kZSA9IGNvbnRleHQuQm9keT8uc3RhdHVzQ29kZSA/PyA1MDA7CiAgICAgICAgICAgIHZhciByZXNwb25zZURhdGEgPSBjb250ZXh0LkJvZHk/LmRhdGE7CgogICAgICAgICAgICBpZiAoc3RhdHVzQ29kZSA+PSAyMDAgJiYgc3RhdHVzQ29kZSA8IDMwMCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHBheW1lbnRSZXN1bHQgPSBuZXcKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzdGF0dXMgPSAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IHRydWUsCiAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25JZCA9IHJlc3BvbnNlRGF0YT8udHJhbnNhY3Rpb25JZCwKICAgICAgICAgICAgICAgICAgICBhbW91bnQgPSByZXNwb25zZURhdGE/LmFtb3VudCwKICAgICAgICAgICAgICAgICAgICBjdXJyZW5jeSA9IHJlc3BvbnNlRGF0YT8uY3VycmVuY3ksCiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc2VkQXQgPSBEYXRlVGltZS5VdGNOb3csCiAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZCA9IHJlc3BvbnNlRGF0YT8ucGF5bWVudE1ldGhvZCwKICAgICAgICAgICAgICAgICAgICBmZWVzID0gcmVzcG9uc2VEYXRhPy5mZWVzCiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBwYXltZW50IGNvdW50ZXIKICAgICAgICAgICAgICAgIHZhciBwYXltZW50U2NoZWR1bGUgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5wYXltZW50U2NoZWR1bGUgPz8gbmV3IHsgfTsKICAgICAgICAgICAgICAgIHBheW1lbnRTY2hlZHVsZS5jb21wbGV0ZWRQYXltZW50cyA9IChwYXltZW50U2NoZWR1bGUuY29tcGxldGVkUGF5bWVudHMgPz8gMCkgKyAxOwogICAgICAgICAgICAgICAgcGF5bWVudFNjaGVkdWxlLmxhc3RQYXltZW50QXQgPSBEYXRlVGltZS5VdGNOb3c7CgogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTY3JpcHRSZXNwb25zZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIEtleSA9ICJwYXltZW50LXN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIERhdGEgPSBuZXcKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRSZXN1bHQgPSBwYXltZW50UmVzdWx0LAogICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50U2NoZWR1bGUgPSBwYXltZW50U2NoZWR1bGUKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIFRhZ3MgPSBuZXdbXSB7ICJwYXltZW50cyIsICJzdWNjZXNzIiwgInRyYW5zYWN0aW9uIiB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGVycm9ySW5mbyA9IEV4dHJhY3RFcnJvckluZm9ybWF0aW9uKGNvbnRleHQsIHN0YXR1c0NvZGUpOwogICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRSZXRyeUNvdW50ID0gY29udGV4dC5JbnN0YW5jZT8uRGF0YT8ubWF4UmV0cmllcyA/PyAwOwoKICAgICAgICAgICAgICAgIHZhciBwYXltZW50UmVzdWx0ID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgc3RhdHVzID0gImZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGVycm9yID0gZXJyb3JJbmZvLm1lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgZXJyb3JDb2RlID0gZXJyb3JJbmZvLmNvZGUsCiAgICAgICAgICAgICAgICAgICAgZXJyb3JEZXNjcmlwdGlvbiA9IGVycm9ySW5mby5kZXNjcmlwdGlvbiwKICAgICAgICAgICAgICAgICAgICBzdGF0dXNDb2RlID0gc3RhdHVzQ29kZSwKICAgICAgICAgICAgICAgICAgICBmYWlsZWRBdCA9IERhdGVUaW1lLlV0Y05vdywKICAgICAgICAgICAgICAgICAgICByZXRyeUNvdW50ID0gY3VycmVudFJldHJ5Q291bnQKICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTY3JpcHRSZXNwb25zZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIEtleSA9ICJwYXltZW50LWZhaWx1cmUiLAogICAgICAgICAgICAgICAgICAgIERhdGEgPSBuZXcKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRSZXN1bHQgPSBwYXltZW50UmVzdWx0LAogICAgICAgICAgICAgICAgICAgICAgICByZXRyeUNvdW50ID0gY3VycmVudFJldHJ5Q291bnQKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIFRhZ3MgPSBuZXdbXSB7ICJwYXltZW50cyIsICJmYWlsdXJlIiwgImVycm9yIiwgInJldHJ5LXBvdGVudGlhbCIgfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBTY3JpcHRSZXNwb25zZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBLZXkgPSAicGF5bWVudC1wcm9jZXNzaW5nLWV4Y2VwdGlvbiIsCiAgICAgICAgICAgICAgICBEYXRhID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcGF5bWVudFJlc3VsdCA9IG5ldwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzID0gImZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSAiSW50ZXJuYWwgcHJvY2Vzc2luZyBlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yQ29kZSA9ICJwcm9jZXNzaW5nX2Vycm9yIiwKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JEZXNjcmlwdGlvbiA9IGV4Lk1lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgICAgIGZhaWxlZEF0ID0gRGF0ZVRpbWUuVXRjTm93CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIFRhZ3MgPSBuZXdbXSB7ICJwYXltZW50cyIsICJmYWlsdXJlIiwgImVycm9yIiwgImV4Y2VwdGlvbiIgfQogICAgICAgICAgICB9OwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyAoc3RyaW5nIG1lc3NhZ2UsIHN0cmluZyBjb2RlLCBzdHJpbmcgZGVzY3JpcHRpb24pIEV4dHJhY3RFcnJvckluZm9ybWF0aW9uKFNjcmlwdENvbnRleHQgY29udGV4dCwgaW50IHN0YXR1c0NvZGUpCiAgICB7CiAgICAgICAgdmFyIGVycm9yRGF0YSA9IGNvbnRleHQuQm9keT8uZXJyb3IgPz8gY29udGV4dC5Cb2R5Py5kYXRhPy5lcnJvcjsKCiAgICAgICAgc3RyaW5nIG1lc3NhZ2UgPSAiUGF5bWVudCBwcm9jZXNzaW5nIGZhaWxlZCI7CiAgICAgICAgc3RyaW5nIGNvZGUgPSAicGF5bWVudF9wcm9jZXNzaW5nX2Vycm9yIjsKICAgICAgICBzdHJpbmcgZGVzY3JpcHRpb24gPSAiVW5hYmxlIHRvIHByb2Nlc3MgcGF5bWVudCI7CgogICAgICAgIGlmIChlcnJvckRhdGEgIT0gbnVsbCkKICAgICAgICB7CiAgICAgICAgICAgIG1lc3NhZ2UgPSBlcnJvckRhdGEubWVzc2FnZSA/PyBlcnJvckRhdGEuZXJyb3IgPz8gbWVzc2FnZTsKICAgICAgICAgICAgY29kZSA9IGVycm9yRGF0YS5jb2RlID8/IGVycm9yRGF0YS5lcnJvcl9jb2RlID8/IGNvZGU7CiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gZXJyb3JEYXRhLmRlc2NyaXB0aW9uID8/IGVycm9yRGF0YS5lcnJvcl9kZXNjcmlwdGlvbiA/PyBkZXNjcmlwdGlvbjsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoc3RhdHVzQ29kZSA9PSA0MDApCiAgICAgICAgewogICAgICAgICAgICBjb2RlID0gImludmFsaWRfcmVxdWVzdCI7CiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gIkludmFsaWQgcGF5bWVudCByZXF1ZXN0IjsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoc3RhdHVzQ29kZSA9PSA0MDEpCiAgICAgICAgewogICAgICAgICAgICBjb2RlID0gInVuYXV0aG9yaXplZCI7CiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gIlVuYXV0aG9yaXplZCBwYXltZW50IGF0dGVtcHQiOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChzdGF0dXNDb2RlID09IDQwMikKICAgICAgICB7CiAgICAgICAgICAgIGNvZGUgPSAiaW5zdWZmaWNpZW50X2Z1bmRzIjsKICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAiSW5zdWZmaWNpZW50IGZ1bmRzIGZvciBwYXltZW50IjsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoc3RhdHVzQ29kZSA9PSA0MDMpCiAgICAgICAgewogICAgICAgICAgICBjb2RlID0gImZvcmJpZGRlbiI7CiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gIlBheW1lbnQgZm9yYmlkZGVuIjsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoc3RhdHVzQ29kZSA9PSA0MDQpCiAgICAgICAgewogICAgICAgICAgICBjb2RlID0gInBheW1lbnRfbWV0aG9kX25vdF9mb3VuZCI7CiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gIlBheW1lbnQgbWV0aG9kIG5vdCBmb3VuZCI7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKHN0YXR1c0NvZGUgPT0gNDI5KQogICAgICAgIHsKICAgICAgICAgICAgY29kZSA9ICJ0b29fbWFueV9yZXF1ZXN0cyI7CiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gIlRvbyBtYW55IHBheW1lbnQgcmVxdWVzdHMiOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChzdGF0dXNDb2RlID49IDUwMCkKICAgICAgICB7CiAgICAgICAgICAgIGNvZGUgPSAic2VydmVyX2Vycm9yIjsKICAgICAgICAgICAgZGVzY3JpcHRpb24gPSAiSW50ZXJuYWwgc2VydmVyIGVycm9yIGR1cmluZyBwYXltZW50IHByb2Nlc3NpbmciOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIChtZXNzYWdlLCBjb2RlLCBkZXNjcmlwdGlvbik7CiAgICB9Cn0=\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"payment-success\",\n            \"target\": \"payment-success-state\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Payment Processed\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Ödeme İşlendi\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/PaymentSuccessRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBQYXltZW50U3VjY2Vzc1J1bGUgOiBJQ29uZGl0aW9uTWFwcGluZwp7CiAgICBwdWJsaWMgYXN5bmMgVGFzazxib29sPiBIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICB0cnkKICAgICAgICB7CiAgICAgICAgICAgIHZhciBwYXltZW50UmVzdWx0ID0gY29udGV4dC5JbnN0YW5jZS5EYXRhLnBheW1lbnRSZXN1bHQ7CiAgICAgICAgICAgIGlmIChwYXltZW50UmVzdWx0ID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICByZXR1cm4gcGF5bWVudFJlc3VsdC5zdWNjZXNzID09IHRydWUgJiYgcGF5bWVudFJlc3VsdC5zdGF0dXMgPT0gInN1Y2Nlc3MiOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uKQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KfQo=\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"payment-error\",\n            \"target\": \"payment-failed-state\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Payment Error\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Ödeme Hatası\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/PaymentErrorRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBQYXltZW50RXJyb3JSdWxlIDogSUNvbmRpdGlvbk1hcHBpbmcKewogICAgcHVibGljIGFzeW5jIFRhc2s8Ym9vbD4gSGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgdHJ5CiAgICAgICAgewogICAgICAgICAgICB2YXIgcGF5bWVudFJlc3VsdCA9IGNvbnRleHQuSW5zdGFuY2UuRGF0YS5wYXltZW50UmVzdWx0OwogICAgICAgICAgICBpZiAocGF5bWVudFJlc3VsdCA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgcmV0dXJuIHBheW1lbnRSZXN1bHQuc3VjY2VzcyA9PSBmYWxzZSAmJiBwYXltZW50UmVzdWx0LnN0YXR1cyA9PSAiZmFpbGVkIjsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbikKICAgICAgICB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOyAvLyBEZWZhdWx0IHRvIGVycm9yIGlmIGV4Y2VwdGlvbiBvY2N1cnMKICAgICAgICB9CiAgICB9Cn0K\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"payment-failed-state\",\n        \"stateType\": 2,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Failed\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Başarısız\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"auto-retry-payment\",\n            \"target\": \"payment-retry\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Auto - Retry Payment\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Otomatik - Ödemeyi Tekrar Dene\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/AutoRetryPaymentRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBBdXRvUmV0cnlQYXltZW50UnVsZSA6IElDb25kaXRpb25NYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICAgICAgdmFyIHBheW1lbnRTY2hlZHVsZSA9IGNvbnRleHQuSW5zdGFuY2UuRGF0YS5wYXltZW50U2NoZWR1bGU7CiAgICAgICAgICAgIGlmIChwYXltZW50U2NoZWR1bGUgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAgIC8vIENoZWNrIGlmIGF1dG8tcmV0cnkgaXMgZW5hYmxlZAogICAgICAgICAgICBpZiAocGF5bWVudFNjaGVkdWxlLmlzQXV0b1JldHJ5ICE9IHRydWUpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICAvLyBDaGVjayBtYXggcmV0cmllcwogICAgICAgICAgICB2YXIgY3VycmVudFJldHJ5Q291bnQgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5yZXRyeUNvdW50ID8/IDA7CiAgICAgICAgICAgIHZhciBtYXhSZXRyaWVzID0gcGF5bWVudFNjaGVkdWxlLm1heFJldHJpZXMgPz8gMzsKCiAgICAgICAgICAgIHJldHVybiBjdXJyZW50UmV0cnlDb3VudCA8IG1heFJldHJpZXM7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChFeGNlcHRpb24pCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQp9Cg==\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"manual-user-triggers-retry\",\n            \"target\": \"payment-retry\",\n            \"triggerType\": 0,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Manual - User Triggers Retry\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Manuel - Kullanıcı Yeniden Deneme Tetikler\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": null,\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"max-retries-reached\",\n            \"target\": \"payment-cancelled\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Max Retries Reached\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Maksimum Yeniden Deneme Sayısına Ulaşıldı\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/MaxRetriesReachedRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBNYXhSZXRyaWVzUmVhY2hlZFJ1bGUgOiBJQ29uZGl0aW9uTWFwcGluZwp7CiAgICBwdWJsaWMgYXN5bmMgVGFzazxib29sPiBIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICB0cnkKICAgICAgICB7CiAgICAgICAgICAgIHZhciBwYXltZW50U2NoZWR1bGUgPSBjb250ZXh0Lkluc3RhbmNlLkRhdGEucGF5bWVudFNjaGVkdWxlOwogICAgICAgICAgICBpZiAocGF5bWVudFNjaGVkdWxlID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICB2YXIgY3VycmVudFJldHJ5Q291bnQgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5yZXRyeUNvdW50ID8/IDA7CiAgICAgICAgICAgIHZhciBtYXhSZXRyaWVzID0gcGF5bWVudFNjaGVkdWxlLm1heFJldHJpZXMgPz8gMzsKCiAgICAgICAgICAgIHJldHVybiBjdXJyZW50UmV0cnlDb3VudCA+PSBtYXhSZXRyaWVzOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uKQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIERlZmF1bHQgdG8gdHJ1ZSBpZiBleGNlcHRpb24gb2NjdXJzCiAgICAgICAgfQogICAgfQp9\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          },\n          {\n            \"key\": \"main-workflow-deactivated\",\n            \"target\": \"payment-cancelled\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Main Workflow Deactivated\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Ana İş Akışı Deaktive Edildi\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/MainWorkflowDeactivatedRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBNYWluV29ya2Zsb3dEZWFjdGl2YXRlZFJ1bGUgOiBJQ29uZGl0aW9uTWFwcGluZwp7CiAgICBwdWJsaWMgYXN5bmMgVGFzazxib29sPiBIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICB0cnkKICAgICAgICB7CiAgICAgICAgICAgIHZhciBwYXltZW50U2NoZWR1bGUgPSBjb250ZXh0Lkluc3RhbmNlLkRhdGEucGF5bWVudFNjaGVkdWxlOwogICAgICAgICAgICBpZiAocGF5bWVudFNjaGVkdWxlID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICAvLyBDaGVjayBpZiBwYXltZW50IHNjaGVkdWxlIGlzIGRlYWN0aXZhdGVkIG9yIG5vdCBhY3RpdmUKICAgICAgICAgICAgcmV0dXJuIHBheW1lbnRTY2hlZHVsZS5zdGF0dXMgPT0gImRlYWN0aXZlIiB8fCBwYXltZW50U2NoZWR1bGUuaXNBY3RpdmUgPT0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChFeGNlcHRpb24pCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQp9\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"payment-retry\",\n        \"stateType\": 2,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Retry\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Yeniden Dene\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"increment-retry-counter\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/IncrementRetryCounterMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKcHVibGljIGNsYXNzIEluY3JlbWVudFJldHJ5Q291bnRlck1hcHBpbmcgOiBJTWFwcGluZwp7CiAgICBwdWJsaWMgVGFzazxTY3JpcHRSZXNwb25zZT4gSW5wdXRIYW5kbGVyKFdvcmtmbG93VGFzayB0YXNrLCBTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgdmFyIGh0dHBUYXNrID0gdGFzayBhcyBIdHRwVGFzazsKICAgICAgICBpZiAoaHR0cFRhc2sgPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRPcGVyYXRpb25FeGNlcHRpb24oIlRhc2sgbXVzdCBiZSBhbiBIdHRwVGFzayIpOwoKICAgICAgICB2YXIgY3VycmVudFJldHJ5Q291bnQgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5yZXRyeUNvdW50ID8/IDA7CiAgICAgICAgdmFyIGluY3JlbWVudERhdGEgPSBuZXcKICAgICAgICB7CiAgICAgICAgICAgIHNjaGVkdWxlSWQgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5wYXltZW50U2NoZWR1bGU/LnNjaGVkdWxlSWQsCiAgICAgICAgICAgIHJldHJ5Q291bnQgPSBjdXJyZW50UmV0cnlDb3VudCArIDEsCiAgICAgICAgICAgIHJldHJ5QXQgPSBEYXRlVGltZS5VdGNOb3cKICAgICAgICB9OwoKICAgICAgICBodHRwVGFzay5TZXRCb2R5KGluY3JlbWVudERhdGEpOwogICAgICAgIHZhciBoZWFkZXJzID0gbmV3IERpY3Rpb25hcnk8c3RyaW5nLCBzdHJpbmc/PgogICAgICAgIHsKICAgICAgICAgICAgWyJDb250ZW50LVR5cGUiXSA9ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgWyJYLVNjaGVkdWxlLUlkIl0gPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5wYXltZW50U2NoZWR1bGU/LnNjaGVkdWxlSWQ/LlRvU3RyaW5nKCkKICAgICAgICB9OwogICAgICAgIGh0dHBUYXNrLlNldEhlYWRlcnMoaGVhZGVycyk7CgogICAgICAgIHJldHVybiBUYXNrLkZyb21SZXN1bHQobmV3IFNjcmlwdFJlc3BvbnNlKCkpOwogICAgfQoKICAgIHB1YmxpYyBhc3luYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBPdXRwdXRIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICB2YXIgcmVzcG9uc2UgPSBuZXcgU2NyaXB0UmVzcG9uc2UoKTsKICAgICAgICB2YXIgY3VycmVudFJldHJ5Q291bnQgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5yZXRyeUNvdW50ID8/IDA7CiAgICAgICAgCiAgICAgICAgcmVzcG9uc2UuRGF0YSA9IG5ldwogICAgICAgIHsKICAgICAgICAgICAgcmV0cnlDb3VudCA9IGN1cnJlbnRSZXRyeUNvdW50ICsgMSwKICAgICAgICAgICAgcmV0cnlTY2hlZHVsZWRBdCA9IERhdGVUaW1lLlV0Y05vdwogICAgICAgIH07CgogICAgICAgIHJldHVybiByZXNwb25zZTsKICAgIH0KfQ==\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"retry-logic\",\n            \"target\": \"process-payment\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Auto - Retry Logic\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Otomatik - Yeniden Deneme Mantığı\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/RetryLogicRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBSZXRyeUxvZ2ljUnVsZSA6IElDb25kaXRpb25NYXBwaW5nCnsKICAgIHB1YmxpYyBhc3luYyBUYXNrPGJvb2w+IEhhbmRsZXIoU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIC8vIEFsd2F5cyByZXR1cm4gdHJ1ZSB0byBwcm9jZWVkIHdpdGggcmV0cnkKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQ==\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"payment-success-state\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Success\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Başarılı\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": []\n      },\n      {\n        \"key\": \"payment-cancelled\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Cancelled\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"İptal Edildi\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": []\n      }\n    ]\n  }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Payment Process SubFlow",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Payment Notify SubProcess",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"payment-notification-subflow\",\n  \"flow\": \"sys-flows\",\n  \"domain\": \"{{domain}}\",\n  \"version\": \"1.0.0\",\n  \"tags\": [\n    \"payments\",\n    \"notification\",\n    \"sms\",\n    \"push\",\n    \"subflow\"\n  ],\n  \"attributes\": {\n    \"type\": \"P\",\n    \"timeout\": null,\n    \"labels\": [\n      {\n        \"language\": \"en-US\",\n        \"label\": \"Payment Notification Subflow\"\n      },\n      {\n        \"language\": \"tr-TR\",\n        \"label\": \"Ödeme Bildirim Alt Akışı\"\n      }\n    ],\n    \"functions\": [],\n    \"features\": [],\n    \"extensions\": [],\n    \"sharedTransitions\": [],\n    \"startTransition\": {\n      \"key\": \"start-notification\",\n      \"target\": \"get-user-info\",\n      \"triggerType\": 0,\n      \"versionStrategy\": \"Minor\",\n      \"labels\": [\n        {\n          \"language\": \"en-US\",\n          \"label\": \"Start Notification Process\"\n        },\n        {\n          \"language\": \"tr-TR\",\n          \"label\": \"Bildirim Sürecini Başlat\"\n        }\n      ],\n      \"schema\": null,\n      \"rule\": null,\n      \"timer\": null,\n      \"view\": null,\n      \"onExecutionTasks\": []\n    },\n    \"states\": [\n      {\n        \"key\": \"get-user-info\",\n        \"stateType\": 1,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Get User Information\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Kullanıcı Bilgilerini Al\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"get-user-info\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/GetUserInfoMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKcHVibGljIGNsYXNzIEdldFVzZXJJbmZvTWFwcGluZyA6IElNYXBwaW5nCnsKICAgIHB1YmxpYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBJbnB1dEhhbmRsZXIoV29ya2Zsb3dUYXNrIHRhc2ssIFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICB0cnkKICAgICAgICB7CiAgICAgICAgICAgIHZhciBodHRwVGFzayA9IHRhc2sgYXMgSHR0cFRhc2s7CiAgICAgICAgICAgIGlmIChodHRwVGFzayA9PSBudWxsKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRPcGVyYXRpb25FeGNlcHRpb24oIlRhc2sgbXVzdCBiZSBhbiBIdHRwVGFzayIpOwoKICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGNvbnRleHQuQm9keT8udXNlcklkOwoKICAgICAgICAgICAgLy8gVXBkYXRlIFVSTCB3aXRoIHVzZXJJZAogICAgICAgICAgICBodHRwVGFzay5TZXRVcmwoaHR0cFRhc2suVXJsLlJlcGxhY2UoInt1c2VySWR9IiwgdXNlcklkPy5Ub1N0cmluZygpID8/ICIiKSk7CgogICAgICAgICAgICAvLyBTZXQgSGVhZGVycwogICAgICAgICAgICB2YXIgaGVhZGVycyA9IG5ldyBEaWN0aW9uYXJ5PHN0cmluZywgc3RyaW5nPz4KICAgICAgICAgICAgewogICAgICAgICAgICAgICAgWyJDb250ZW50LVR5cGUiXSA9ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgICAgIFsiQWNjZXB0Il0gPSAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICAgICBbIlgtUmVxdWVzdC1JZCJdID0gR3VpZC5OZXdHdWlkKCkuVG9TdHJpbmcoKQogICAgICAgICAgICB9OwoKICAgICAgICAgICAgaHR0cFRhc2suU2V0SGVhZGVycyhoZWFkZXJzKTsKCiAgICAgICAgICAgIHJldHVybiBUYXNrLkZyb21SZXN1bHQobmV3IFNjcmlwdFJlc3BvbnNlKCkpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChuZXcgU2NyaXB0UmVzcG9uc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgS2V5ID0gInVzZXItaW5mby1lcnJvciIsCiAgICAgICAgICAgICAgICBEYXRhID0gbmV3IHsgZXJyb3IgPSBleC5NZXNzYWdlIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBhc3luYyBUYXNrPFNjcmlwdFJlc3BvbnNlPiBPdXRwdXRIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICB0cnkKICAgICAgICB7CiAgICAgICAgICAgIHZhciBzdGF0dXNDb2RlID0gY29udGV4dC5Cb2R5Py5zdGF0dXNDb2RlID8/IDUwMDsKICAgICAgICAgICAgdmFyIHJlc3BvbnNlRGF0YSA9IGNvbnRleHQuQm9keT8uZGF0YTsKCiAgICAgICAgICAgIGlmIChzdGF0dXNDb2RlID49IDIwMCAmJiBzdGF0dXNDb2RlIDwgMzAwKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFNjcmlwdFJlc3BvbnNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgS2V5ID0gInVzZXItaW5mby1zdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBEYXRhID0gbmV3CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB1c2VyID0gcmVzcG9uc2VEYXRhLAogICAgICAgICAgICAgICAgICAgICAgICBwaG9uZU51bWJlciA9IHJlc3BvbnNlRGF0YT8ucGhvbmVOdW1iZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIGhhc1JlZ2lzdGVyZWREZXZpY2VzID0gKChvYmplY3RbXSlyZXNwb25zZURhdGE/LnJlZ2lzdGVyZWREZXZpY2VzKS5MZW5ndGggPiAwLAogICAgICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZSA9IHJlc3BvbnNlRGF0YT8ubGFuZ3VhZ2UgPz8gInRyLVRSIgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgVGFncyA9IG5ld1tdIHsgInVzZXJzIiwgImxvb2t1cCIsICJzdWNjZXNzIiB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTY3JpcHRSZXNwb25zZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIEtleSA9ICJ1c2VyLWluZm8tZmFpbHVyZSIsCiAgICAgICAgICAgICAgICAgICAgRGF0YSA9IG5ldwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSAiRmFpbGVkIHRvIGdldCB1c2VyIGluZm9ybWF0aW9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JDb2RlID0gInVzZXJfaW5mb19mYWlsZWQiLAogICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNDb2RlID0gc3RhdHVzQ29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgaGFzUmVnaXN0ZXJlZERldmljZXMgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgVGFncyA9IG5ld1tdIHsgInVzZXJzIiwgImxvb2t1cCIsICJmYWlsdXJlIiB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNhdGNoIChFeGNlcHRpb24gZXgpCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gbmV3IFNjcmlwdFJlc3BvbnNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIEtleSA9ICJ1c2VyLWluZm8tZXhjZXB0aW9uIiwKICAgICAgICAgICAgICAgIERhdGEgPSBuZXcKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBlcnJvciA9ICJJbnRlcm5hbCBwcm9jZXNzaW5nIGVycm9yIiwKICAgICAgICAgICAgICAgICAgICBlcnJvckNvZGUgPSAicHJvY2Vzc2luZ19lcnJvciIsCiAgICAgICAgICAgICAgICAgICAgZXJyb3JEZXNjcmlwdGlvbiA9IGV4Lk1lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgaGFzUmVnaXN0ZXJlZERldmljZXMgPSBmYWxzZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIFRhZ3MgPSBuZXdbXSB7ICJ1c2VycyIsICJsb29rdXAiLCAiZXJyb3IiIH0KICAgICAgICAgICAgfTsKICAgICAgICB9CiAgICB9Cn0K\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"user-info-retrieved\",\n            \"target\": \"send-notifications\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Auto - User Info Retrieved\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Otomatik - Kullanıcı Bilgisi Alındı\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/UserInfoRetrievedRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBVc2VySW5mb1JldHJpZXZlZFJ1bGUgOiBJQ29uZGl0aW9uTWFwcGluZwp7CiAgICBwdWJsaWMgYXN5bmMgVGFzazxib29sPiBIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICAvLyBBbHdheXMgY29udGludWUgdG8gc2VuZCBub3RpZmljYXRpb25zLCBldmVuIGlmIHVzZXIgaW5mbyBmYWlsZWQKICAgICAgICByZXR1cm4gY29udGV4dC5JbnN0YW5jZT8uRGF0YT8udXNlciAhPSBudWxsOwogICAgfQp9Cg==\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"send-notifications\",\n        \"stateType\": 1,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Send Notifications (SMS + Push)\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Bildirimler Gönder (SMS + Push)\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [\n          {\n            \"order\": 1,\n            \"task\": {\n              \"key\": \"send-payment-notification-sms\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/SendPaymentNotificationSmsMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKLy8vIDxzdW1tYXJ5PgovLy8gU2VuZCBQYXltZW50IE5vdGlmaWNhdGlvbiBTTVMgTWFwcGluZyAtIFByZXBhcmVzIFNNUyBub3RpZmljYXRpb24gZGF0YQovLy8gPC9zdW1tYXJ5PgpwdWJsaWMgY2xhc3MgU2VuZFBheW1lbnROb3RpZmljYXRpb25TbXNNYXBwaW5nIDogSU1hcHBpbmcKewogICAgcHVibGljIFRhc2s8U2NyaXB0UmVzcG9uc2U+IElucHV0SGFuZGxlcihXb3JrZmxvd1Rhc2sgdGFzaywgU2NyaXB0Q29udGV4dCBjb250ZXh0KQogICAgewogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICAgICAgdmFyIGh0dHBUYXNrID0gdGFzayBhcyBIdHRwVGFzazsKICAgICAgICAgICAgaWYgKGh0dHBUYXNrID09IG51bGwpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXhjZXB0aW9uKCJUYXNrIG11c3QgYmUgYW4gSHR0cFRhc2sgZm9yIFNNUyBub3RpZmljYXRpb24iKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gR2V0IHBheW1lbnQgcmVzdWx0IGZyb20gY29udGV4dAogICAgICAgICAgICB2YXIgcGF5bWVudFJlc3VsdCA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LnBheW1lbnRSZXN1bHQ7CiAgICAgICAgICAgIHZhciBwYXltZW50U2NoZWR1bGUgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5wYXltZW50U2NoZWR1bGU7CiAgICAgICAgICAgIHZhciB1c2VySWQgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy51c2VySWQ7CgogICAgICAgICAgICAvLyBEZXRlcm1pbmUgbWVzc2FnZSBiYXNlZCBvbiBwYXltZW50IHN0YXR1cwogICAgICAgICAgICB2YXIgbWVzc2FnZSA9ICIiOwogICAgICAgICAgICB2YXIgbGFuZ3VhZ2UgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5sYW5ndWFnZSA/PyAidHItVFIiOwoKICAgICAgICAgICAgaWYgKHBheW1lbnRSZXN1bHQ/LnN1Y2Nlc3MgPT0gdHJ1ZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKGxhbmd1YWdlID09ICJlbi1VUyIpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9ICQiUGF5bWVudCBzdWNjZXNzZnVsISBBbW91bnQ6IHtwYXltZW50UmVzdWx0Py5hbW91bnR9IHtwYXltZW50UmVzdWx0Py5jdXJyZW5jeX0uIFJlZmVyZW5jZToge3BheW1lbnRSZXN1bHQ/LnRyYW5zYWN0aW9uSWR9IjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gJCLDlmRlbWUgYmHFn2FyxLFsxLEhIE1pa3Rhcjoge3BheW1lbnRSZXN1bHQ/LmFtb3VudH0ge3BheW1lbnRSZXN1bHQ/LmN1cnJlbmN5fS4gUmVmZXJhbnM6IHtwYXltZW50UmVzdWx0Py50cmFuc2FjdGlvbklkfSI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAobGFuZ3VhZ2UgPT0gImVuLVVTIikKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gJCJQYXltZW50IGZhaWxlZC4gUmVhc29uOiB7cGF5bWVudFJlc3VsdD8uZXJyb3JNZXNzYWdlID8/ICJVbmtub3duIGVycm9yIn0uIFBsZWFzZSBjaGVjayB5b3VyIHBheW1lbnQgZGV0YWlscy4iOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSAkIsOWZGVtZSBiYcWfYXLEsXPEsXouIE5lZGVuOiB7cGF5bWVudFJlc3VsdD8uZXJyb3JNZXNzYWdlID8/ICJCaWxpbm1leWVuIHNlYmVwIn0uIEzDvHRmZW4gw7ZkZW1lIGJpbGdpbGVyaW5pemkga29udHJvbCBlZGluLiI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFByZXBhcmUgU01TIGRhdGEKICAgICAgICAgICAgdmFyIHNtc0RhdGEgPSBuZXcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdG8gPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5waG9uZU51bWJlciA/PyAiW1Bob25lIE5vdCBGb3VuZF0iLCAvLyBTaG91bGQgY29tZSBmcm9tIHVzZXIgZGF0YQogICAgICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UsCiAgICAgICAgICAgICAgICB1c2VySWQgPSB1c2VySWQsCiAgICAgICAgICAgICAgICBzbXNUeXBlID0gInBheW1lbnQtbm90aWZpY2F0aW9uIiwKICAgICAgICAgICAgICAgIHRlbXBsYXRlSWQgPSAicGF5bWVudC1ub3RpZi10ZW1wbGF0ZSIsCiAgICAgICAgICAgICAgICBsYW5ndWFnZSA9IGxhbmd1YWdlLAogICAgICAgICAgICAgICAgc2VuZGVySWQgPSAiUGF5bWVudFN5c3RlbSIsCiAgICAgICAgICAgICAgICB0aW1lc3RhbXAgPSBEYXRlVGltZS5VdGNOb3cuVG9TdHJpbmcoImlzbzgiKQogICAgICAgICAgICB9OwoKICAgICAgICAgICAgaHR0cFRhc2suU2V0Qm9keShzbXNEYXRhKTsKCiAgICAgICAgICAgIC8vIFNldCBIZWFkZXJzCiAgICAgICAgICAgIHZhciBoZWFkZXJzID0gbmV3IERpY3Rpb25hcnk8c3RyaW5nLCBzdHJpbmc/PgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBbIkNvbnRlbnQtVHlwZSJdID0gImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICAgICAgWyJBY2NlcHQiXSA9ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgICAgIFsiWC1QYXltZW50LUluc3RhbmNlIl0gPSBjb250ZXh0Lkluc3RhbmNlPy5JZC5Ub1N0cmluZygpLAogICAgICAgICAgICAgICAgWyJYLVVzZXItSWQiXSA9IHVzZXJJZD8uVG9TdHJpbmcoKQogICAgICAgICAgICB9OwoKICAgICAgICAgICAgaHR0cFRhc2suU2V0SGVhZGVycyhoZWFkZXJzKTsKCiAgICAgICAgICAgIHJldHVybiBUYXNrLkZyb21SZXN1bHQobmV3IFNjcmlwdFJlc3BvbnNlKCkpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChuZXcgU2NyaXB0UmVzcG9uc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgS2V5ID0gInNtcy1ub3RpZmljYXRpb24tZXJyb3IiLAogICAgICAgICAgICAgICAgRGF0YSA9IG5ldyB7IGVycm9yID0gZXguTWVzc2FnZSB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgYXN5bmMgVGFzazxTY3JpcHRSZXNwb25zZT4gT3V0cHV0SGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgdHJ5CiAgICAgICAgewogICAgICAgICAgICB2YXIgc3RhdHVzQ29kZSA9IGNvbnRleHQuQm9keT8uc3RhdHVzQ29kZSA/PyA1MDA7CiAgICAgICAgICAgIHZhciByZXNwb25zZURhdGEgPSBjb250ZXh0LkJvZHk/LmRhdGE7CgogICAgICAgICAgICBpZiAoc3RhdHVzQ29kZSA+PSAyMDAgJiYgc3RhdHVzQ29kZSA8IDMwMCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTY3JpcHRSZXNwb25zZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIEtleSA9ICJzbXMtbm90aWZpY2F0aW9uLXN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIERhdGEgPSBuZXcKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNtc1NlbnQgPSB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlSWQgPSByZXNwb25zZURhdGE/Lm1lc3NhZ2VJZCwKICAgICAgICAgICAgICAgICAgICAgICAgc2VudEF0ID0gRGF0ZVRpbWUuVXRjTm93LAogICAgICAgICAgICAgICAgICAgICAgICBzbXNTdGF0dXMgPSAic2VudCIKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIFRhZ3MgPSBuZXdbXSB7ICJwYXltZW50cyIsICJzbXMiLCAibm90aWZpY2F0aW9uIiwgInN1Y2Nlc3MiIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFNjcmlwdFJlc3BvbnNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgS2V5ID0gInNtcy1ub3RpZmljYXRpb24tZmFpbHVyZSIsCiAgICAgICAgICAgICAgICAgICAgRGF0YSA9IG5ldwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgc21zU2VudCA9IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9ICJGYWlsZWQgdG8gc2VuZCBTTVMgbm90aWZpY2F0aW9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JDb2RlID0gInNtc19zZW5kX2ZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1c0NvZGUgPSBzdGF0dXNDb2RlLAogICAgICAgICAgICAgICAgICAgICAgICBzbXNTdGF0dXMgPSAiZmFpbGVkIgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgVGFncyA9IG5ld1tdIHsgInBheW1lbnRzIiwgInNtcyIsICJub3RpZmljYXRpb24iLCAiZmFpbHVyZSIgfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBTY3JpcHRSZXNwb25zZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBLZXkgPSAic21zLW5vdGlmaWNhdGlvbi1leGNlcHRpb24iLAogICAgICAgICAgICAgICAgRGF0YSA9IG5ldwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHNtc1NlbnQgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBlcnJvciA9ICJJbnRlcm5hbCBwcm9jZXNzaW5nIGVycm9yIiwKICAgICAgICAgICAgICAgICAgICBlcnJvckNvZGUgPSAicHJvY2Vzc2luZ19lcnJvciIsCiAgICAgICAgICAgICAgICAgICAgZXJyb3JEZXNjcmlwdGlvbiA9IGV4Lk1lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgc21zU3RhdHVzID0gImV4Y2VwdGlvbiIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBUYWdzID0gbmV3W10geyAicGF5bWVudHMiLCAic21zIiwgIm5vdGlmaWNhdGlvbiIsICJlcnJvciIgfQogICAgICAgICAgICB9OwogICAgICAgIH0KICAgIH0KfQo=\"\n            }\n          },\n          {\n            \"order\": 2,\n            \"task\": {\n              \"key\": \"send-payment-push-notification\",\n              \"domain\": \"{{domain}}\",\n              \"version\": \"1.0.0\",\n              \"flow\": \"sys-tasks\"\n            },\n            \"mapping\": {\n              \"location\": \"./src/SendPaymentPushNotificationMapping.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKdXNpbmcgQkJULldvcmtmbG93LkRlZmluaXRpb25zOwoKcHVibGljIGNsYXNzIFNlbmRQYXltZW50UHVzaE5vdGlmaWNhdGlvbk1hcHBpbmcgOiBJTWFwcGluZwp7CiAgICBwdWJsaWMgVGFzazxTY3JpcHRSZXNwb25zZT4gSW5wdXRIYW5kbGVyKFdvcmtmbG93VGFzayB0YXNrLCBTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgdHJ5CiAgICAgICAgewogICAgICAgICAgICB2YXIgaHR0cFRhc2sgPSB0YXNrIGFzIEh0dHBUYXNrOwogICAgICAgICAgICBpZiAoaHR0cFRhc2sgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXhjZXB0aW9uKCJUYXNrIG11c3QgYmUgYW4gSHR0cFRhc2siKTsKCiAgICAgICAgICAgIC8vIENoZWNrIGlmIHVzZXIgaGFzIHJlZ2lzdGVyZWQgZGV2aWNlcwogICAgICAgICAgICB2YXIgaGFzUmVnaXN0ZXJlZERldmljZXMgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5oYXNSZWdpc3RlcmVkRGV2aWNlcyA9PSB0cnVlOwogICAgICAgICAgICBpZiAoIWhhc1JlZ2lzdGVyZWREZXZpY2VzKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAvLyBTa2lwIHB1c2ggbm90aWZpY2F0aW9uIGlmIG5vIGRldmljZXMKICAgICAgICAgICAgICAgIHJldHVybiBUYXNrLkZyb21SZXN1bHQobmV3IFNjcmlwdFJlc3BvbnNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgS2V5ID0gInB1c2gtc2tpcHBlZCIsCiAgICAgICAgICAgICAgICAgICAgRGF0YSA9IG5ldyB7IHB1c2hTZW50ID0gZmFsc2UsIHJlYXNvbiA9ICJObyByZWdpc3RlcmVkIGRldmljZXMiIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBHZXQgZGF0YSBmcm9tIGNvbnRleHQKICAgICAgICAgICAgdmFyIHBheW1lbnRSZXN1bHQgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy5wYXltZW50UmVzdWx0OwogICAgICAgICAgICB2YXIgdXNlciA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LnVzZXI7CiAgICAgICAgICAgIHZhciByZWdpc3RlcmVkRGV2aWNlcyA9IGNvbnRleHQuSW5zdGFuY2U/LkRhdGE/LnJlZ2lzdGVyZWREZXZpY2VzOwogICAgICAgICAgICB2YXIgbGFuZ3VhZ2UgPSB1c2VyPy5sYW5ndWFnZSA/PyAidHItVFIiOwoKICAgICAgICAgICAgLy8gR2VuZXJhdGUgcHVzaCBtZXNzYWdlCiAgICAgICAgICAgIHZhciB0aXRsZSA9ICIiOwogICAgICAgICAgICB2YXIgYm9keSA9ICIiOwogICAgICAgICAgICBpZiAocGF5bWVudFJlc3VsdD8uc3VjY2VzcyA9PSB0cnVlKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAobGFuZ3VhZ2UgPT0gImVuLVVTIikKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB0aXRsZSA9ICJQYXltZW50IFN1Y2Nlc3NmdWwiOwogICAgICAgICAgICAgICAgICAgIGJvZHkgPSAkIllvdXIgcGF5bWVudCBvZiB7cGF5bWVudFJlc3VsdD8uYW1vdW50fSB7cGF5bWVudFJlc3VsdD8uY3VycmVuY3l9IGhhcyBiZWVuIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB0aXRsZSA9ICLDlmRlbWUgQmHFn2FyxLFsxLEiOwogICAgICAgICAgICAgICAgICAgIGJvZHkgPSAkIntwYXltZW50UmVzdWx0Py5hbW91bnR9IHtwYXltZW50UmVzdWx0Py5jdXJyZW5jeX0gw7ZkZW1lbml6IGJhxZ9hcsSxeWxhIGnFn2xlbWUgYWzEsW5kxLEuIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChsYW5ndWFnZSA9PSAiZW4tVVMiKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHRpdGxlID0gIlBheW1lbnQgRmFpbGVkIjsKICAgICAgICAgICAgICAgICAgICBib2R5ID0gIllvdXIgcGF5bWVudCBjb3VsZCBub3QgYmUgcHJvY2Vzc2VkLiBQbGVhc2UgdHJ5IGFnYWluLiI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdGl0bGUgPSAiw5ZkZW1lIEJhxZ9hcsSxc8SxeiI7CiAgICAgICAgICAgICAgICAgICAgYm9keSA9ICLDlmRlbWVuaXogZ2Vyw6dla2xlxZ90aXJpbGVtZWRpLiBMw7x0ZmVuIHRla3JhciBkZW5leWluLiI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBwdXNoRGF0YSA9IG5ldwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0aXRsZSA9IHRpdGxlLAogICAgICAgICAgICAgICAgYm9keSA9IGJvZHksCiAgICAgICAgICAgICAgICB1c2VySWQgPSBjb250ZXh0Lkluc3RhbmNlPy5EYXRhPy51c2VySWQsCiAgICAgICAgICAgICAgICBkZXZpY2VzID0gcmVnaXN0ZXJlZERldmljZXMsCiAgICAgICAgICAgICAgICBwdXNoVHlwZSA9ICJwYXltZW50LW5vdGlmaWNhdGlvbiIsCiAgICAgICAgICAgICAgICBkYXRhID0gbmV3CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcGF5bWVudElkID0gcGF5bWVudFJlc3VsdD8udHJhbnNhY3Rpb25JZCwKICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gcGF5bWVudFJlc3VsdD8uc3VjY2VzcwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwoKICAgICAgICAgICAgaHR0cFRhc2suU2V0Qm9keShwdXNoRGF0YSk7CiAgICAgICAgICAgIGh0dHBUYXNrLlNldEhlYWRlcnMobmV3IERpY3Rpb25hcnk8c3RyaW5nLCBzdHJpbmc/PgogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBbIkNvbnRlbnQtVHlwZSJdID0gImFwcGxpY2F0aW9uL2pzb24iCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcmV0dXJuIFRhc2suRnJvbVJlc3VsdChuZXcgU2NyaXB0UmVzcG9uc2UoKSk7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChFeGNlcHRpb24gZXgpCiAgICAgICAgewogICAgICAgICAgICByZXR1cm4gVGFzay5Gcm9tUmVzdWx0KG5ldyBTY3JpcHRSZXNwb25zZSB7IEtleSA9ICJwdXNoLWVycm9yIiwgRGF0YSA9IG5ldyB7IGVycm9yID0gZXguTWVzc2FnZSB9IH0pOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgYXN5bmMgVGFzazxTY3JpcHRSZXNwb25zZT4gT3V0cHV0SGFuZGxlcihTY3JpcHRDb250ZXh0IGNvbnRleHQpCiAgICB7CiAgICAgICAgdmFyIHN0YXR1c0NvZGUgPSBjb250ZXh0LkJvZHk/LnN0YXR1c0NvZGUgPz8gNTAwOwogICAgICAgIHJldHVybiBuZXcgU2NyaXB0UmVzcG9uc2UKICAgICAgICB7CiAgICAgICAgICAgIEtleSA9IHN0YXR1c0NvZGUgPj0gMjAwICYmIHN0YXR1c0NvZGUgPCAzMDAgPyAicHVzaC1zdWNjZXNzIiA6ICJwdXNoLWZhaWx1cmUiLAogICAgICAgICAgICBEYXRhID0gbmV3IHsgcHVzaFNlbnQgPSBzdGF0dXNDb2RlID49IDIwMCAmJiBzdGF0dXNDb2RlIDwgMzAwIH0KICAgICAgICB9OwogICAgfQp9Cg==\"\n            }\n          }\n        ],\n        \"onExits\": [],\n        \"transitions\": [\n          {\n            \"key\": \"notifications-sent\",\n            \"target\": \"notification-complete\",\n            \"triggerType\": 1,\n            \"versionStrategy\": \"Minor\",\n            \"labels\": [\n              {\n                \"language\": \"en-US\",\n                \"label\": \"Auto - Notifications Sent\"\n              },\n              {\n                \"language\": \"tr-TR\",\n                \"label\": \"Otomatik - Bildirimler Gönderildi\"\n              }\n            ],\n            \"schema\": null,\n            \"rule\": {\n              \"location\": \"./src/NotificationsSentRule.csx\",\n              \"code\": \"dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgQkJULldvcmtmbG93LlNjcmlwdGluZzsKCnB1YmxpYyBjbGFzcyBOb3RpZmljYXRpb25zU2VudFJ1bGUgOiBJQ29uZGl0aW9uTWFwcGluZwp7CiAgICBwdWJsaWMgYXN5bmMgVGFzazxib29sPiBIYW5kbGVyKFNjcmlwdENvbnRleHQgY29udGV4dCkKICAgIHsKICAgICAgICAvLyBBbHdheXMgbW92ZSB0byBjb21wbGV0aW9uLCByZWdhcmRsZXNzIG9mIG5vdGlmaWNhdGlvbiByZXN1bHRzCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cn0K\"\n            },\n            \"timer\": null,\n            \"view\": null,\n            \"onExecutionTasks\": []\n          }\n        ]\n      },\n      {\n        \"key\": \"notification-complete\",\n        \"stateType\": 3,\n        \"versionStrategy\": \"Minor\",\n        \"labels\": [\n          {\n            \"language\": \"en-US\",\n            \"label\": \"Notification Process Complete\"\n          },\n          {\n            \"language\": \"tr-TR\",\n            \"label\": \"Bildirim Süreci Tamamlandı\"\n          }\n        ],\n        \"view\": null,\n        \"subFlow\": null,\n        \"onEntries\": [],\n        \"onExits\": [],\n        \"transitions\": []\n      }\n    ]\n  }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Payment Notify SubProcess",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-flows"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								}
							]
						},
						{
							"name": "Tasks",
							"item": [
								{
									"name": "1 - Start - Activate Payment Schedule",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"activate-payment-schedule\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"payments\",\n    \"scheduled\",\n    \"activation\",\n    \"status\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"http://mockoon:3001/api/payments/schedules/{scheduleId}/activate\",\n      \"method\": \"PATCH\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 5,\n      \"validateSsl\": true\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Activate Payment Schedule",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Archive Payment Record",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"archive-payment-record\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"payments\",\n    \"archive\",\n    \"cleanup\",\n    \"completion\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"http://mockoon:3001/api/payments/schedules/{scheduleId}/archive\",\n      \"method\": \"POST\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 10,\n      \"validateSsl\": true\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Archive Payment Record",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Deactivate Payment Schedule",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"deactivate-payment-schedule\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"payments\",\n    \"scheduled\",\n    \"deactivation\",\n    \"status\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"http://mockoon:3001/api/payments/schedules/{scheduleId}/deactivate\",\n      \"method\": \"PATCH\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 5,\n      \"validateSsl\": true\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Deactivate Payment Schedule",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Increment Retry Counter",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"increment-retry-counter\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"payments\",\n    \"retry\",\n    \"counter\",\n    \"tracking\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"http://mockoon:3001/api/payments/schedules/{scheduleId}/retry\",\n      \"method\": \"PATCH\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 5,\n      \"validateSsl\": true\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate -  Increment Retry Counter",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Process Payment",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"process-payment\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"payments\",\n    \"processing\",\n    \"transaction\",\n    \"financial\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"http://mockoon:3001/api/payments/process\",\n      \"method\": \"POST\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 30,\n      \"validateSsl\": true\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate -  Process Payment",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Save Payment Configuration",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"save-payment-configuration\",\n  \"version\": \"1.0.0\",\n  \"domain\": \"{{domain}}\",\n  \"flow\": \"sys-tasks\",\n  \"flowVersion\": \"1.0.0\",\n  \"tags\": [\n    \"payments\",\n    \"scheduled\",\n    \"configuration\",\n    \"setup\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"url\": \"http://mockoon:3001/api/payments/schedules\",\n      \"method\": \"POST\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 10,\n      \"validateSsl\": true\n    }\n  }\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate -  Save Payment Configuration",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Get User Info",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"get-user-info\",\n  \"flow\": \"sys-tasks\",\n  \"domain\": \"{{domain}}\",\n  \"version\": \"1.0.0\",\n  \"tags\": [\n    \"users\",\n    \"lookup\",\n    \"information\",\n    \"devices\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"method\": \"GET\",\n      \"url\": \"http://mockoon:3001/api/payments/users/{userId}\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"timeoutSeconds\": 30,\n      \"validateSsl\": true\n    }\n  }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Get User Info",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Notify Sms",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"send-payment-notification-sms\",\n  \"flow\": \"sys-tasks\",\n  \"domain\": \"{{domain}}\",\n  \"version\": \"1.0.0\",\n  \"tags\": [\n    \"payments\",\n    \"notification\",\n    \"sms\",\n    \"communication\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"method\": \"POST\",\n      \"url\": \"http://mockoon:3001/api/payments/notify/sms\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 30,\n      \"validateSsl\": true\n    }\n  }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Notify Sms",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "1 - Start - Notify Push",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"key\": \"send-payment-push-notification\",\n  \"flow\": \"sys-tasks\",\n  \"domain\": \"{{domain}}\",\n  \"version\": \"1.0.0\",\n  \"tags\": [\n    \"payments\",\n    \"notification\",\n    \"push\",\n    \"mobile\",\n    \"communication\"\n  ],\n  \"attributes\": {\n    \"type\": \"6\",\n    \"config\": {\n      \"method\": \"POST\",\n      \"url\": \"http://mockoon:3001/api/payments/notify/push\",\n      \"headers\": {\n        \"Content-Type\": \"application/json\"\n      },\n      \"body\": {},\n      \"timeoutSeconds\": 30,\n      \"validateSsl\": true\n    }\n  }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Push",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-tasks"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								}
							]
						},
						{
							"name": "Schemas",
							"item": [
								{
									"name": "1 - Start - Start Payment Schema",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"if (pm.response.code === 200 || pm.response.code === 201) {",
													"    var jsonData = pm.response.json();",
													"    pm.collectionVariables.set('instanceId', jsonData.id);",
													"}"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"key\": \"payment-start-validation\",\n    \"version\": \"1.0.0\",\n    \"domain\": \"{{domain}}\",\n    \"flow\": \"sys-schemas\",\n    \"flowVersion\": \"1.0.0\",\n    \"tags\": [\n        \"payments\",\n        \"validation\",\n        \"scheduled-payments\",\n        \"start-transition\"\n    ],\n    \"attributes\": {\n        \"type\": \"transition\",\n        \"$schema\": \"https://json-schema.org/draft/2020-12/schema\",\n        \"$id\": \"https://schemas.vnext.com/payments/payments-start-transition.json\",\n        \"title\": \"Payment Start Transition Definition\",\n        \"description\": \"Payment start transition payload şeması\",\n        \"schema\": {\n            \"type\": \"object\",\n            \"required\": [\n                \"userId\",\n                \"amount\",\n                \"currency\",\n                \"frequency\",\n                \"startDate\",\n                \"endDate\",\n                \"paymentMethodId\",\n                \"recipientId\"\n            ],\n            \"properties\": {\n                \"userId\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 1,\n                    \"description\": \"Unique identifier for the user initiating the payment schedule\"\n                },\n                \"amount\": {\n                    \"type\": \"number\",\n                    \"minimum\": 0.01,\n                    \"multipleOf\": 0.01,\n                    \"description\": \"Payment amount (supports decimal values for cents)\"\n                },\n                \"currency\": {\n                    \"type\": \"string\",\n                    \"enum\": [\n                        \"TL\",\n                        \"USD\",\n                        \"EUR\",\n                        \"GBP\"\n                    ],\n                    \"description\": \"Currency code for the payment\"\n                },\n                \"frequency\": {\n                    \"type\": \"string\",\n                    \"enum\": [\n                        \"daily\",\n                        \"weekly\",\n                        \"monthly\",\n                        \"quarterly\",\n                        \"yearly\"\n                    ],\n                    \"description\": \"Payment frequency schedule\"\n                },\n                \"startDate\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"ISO 8601 date-time when payments should start\"\n                },\n                \"endDate\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"ISO 8601 date-time when payments should end\"\n                },\n                \"paymentMethodId\": {\n                    \"type\": \"string\",\n                    \"minLength\": 1,\n                    \"description\": \"Identifier for the payment method to be used\"\n                },\n                \"description\": {\n                    \"type\": \"string\",\n                    \"maxLength\": 500,\n                    \"description\": \"Optional description for the payment schedule\"\n                },\n                \"recipientId\": {\n                    \"type\": \"string\",\n                    \"minLength\": 1,\n                    \"description\": \"Identifier for the payment recipient\"\n                },\n                \"isAutoRetry\": {\n                    \"type\": \"boolean\",\n                    \"default\": false,\n                    \"description\": \"Whether to automatically retry failed payments\"\n                },\n                \"maxRetries\": {\n                    \"type\": \"integer\",\n                    \"minimum\": 0,\n                    \"maximum\": 10,\n                    \"default\": 3,\n                    \"description\": \"Maximum number of retry attempts for failed payments\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"if\": {\n                \"properties\": {\n                    \"isAutoRetry\": {\n                        \"const\": true\n                    }\n                }\n            },\n            \"then\": {\n                \"properties\": {\n                    \"maxRetries\": {\n                        \"minimum\": 1\n                    }\n                }\n            }\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												"start"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-schemas"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "2 - Activate - Start Payment Schema",
									"request": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instanceId/transitions/activate?sync=true",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												":domain",
												"workflows",
												":flow",
												"instances",
												":instanceId",
												"transitions",
												"activate"
											],
											"query": [
												{
													"key": "sync",
													"value": "true"
												}
											],
											"variable": [
												{
													"key": "domain",
													"value": "{{domain}}"
												},
												{
													"key": "flow",
													"value": "sys-schemas"
												},
												{
													"key": "instanceId",
													"value": "{{instanceId}}"
												}
											]
										}
									},
									"response": []
								}
							]
						}
					]
				},
				{
					"name": "Instance Execute",
					"item": [
						{
							"name": "Get Instance Data",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instance",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										":domain",
										"workflows",
										":flow",
										"instances",
										":instance"
									],
									"variable": [
										{
											"key": "domain",
											"value": "{{domain}}"
										},
										{
											"key": "flow",
											"value": "scheduled-payments"
										},
										{
											"key": "instance",
											"value": "{{instanceId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Step 1: Start Instance",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"if (pm.response.code === 200 || pm.response.code === 201) {",
											"    var jsonData = pm.response.json();",
											"    pm.collectionVariables.set('instanceId', jsonData.id);",
											"}"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"var uuid = require('uuid');",
											"pm.collectionVariables.set(\"requestId\",uuid.v4());"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept-Language",
										"value": "tr-TR",
										"type": "text"
									},
									{
										"key": "X-Request-Id",
										"value": "{{requestId}}",
										"type": "text"
									},
									{
										"key": "X-Device-Id",
										"value": "{{requestId}}",
										"type": "text"
									},
									{
										"key": "X-Token-Id",
										"value": "{{requestId}}",
										"type": "text"
									},
									{
										"key": "X-Device-Info",
										"value": "IOS 16",
										"type": "text"
									},
									{
										"key": "X-Forwarded-For",
										"value": "192.168.2.1",
										"type": "text"
									},
									{
										"key": "user_reference",
										"value": "",
										"type": "text",
										"disabled": true
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"key\": \"34748285793\",\n    \"tags\": [\n        \"test\",\n        \"oauth\",\n        \"authentication\"\n    ],\n    \"attributes\": {\n        \"userId\": 2,\n        \"amount\": 12000,\n        \"currency\": \"TL\",\n        \"frequency\": \"monthly\",\n        \"startDate\": \"2025-10-01T09:02:38.201Z\",\n        \"endDate\": \"2026-10-01T09:02:38.201Z\",\n        \"paymentMethodId\": \"1\",\n        \"description\": \"Tayfun ödeme\",\n        \"recipientId\": \"324324\",\n        \"isAutoRetry\": false,\n        \"maxRetries\": 3\n    }\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/start?sync=true",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										":domain",
										"workflows",
										":flow",
										"instances",
										"start"
									],
									"query": [
										{
											"key": "sync",
											"value": "true"
										}
									],
									"variable": [
										{
											"key": "domain",
											"value": "{{domain}}"
										},
										{
											"key": "flow",
											"value": "scheduled-payments"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Step 2: Pay Now",
							"request": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/:domain/workflows/:flow/instances/:instance/transitions/:transition?sync=true",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										":domain",
										"workflows",
										":flow",
										"instances",
										":instance",
										"transitions",
										":transition"
									],
									"query": [
										{
											"key": "sync",
											"value": "true"
										}
									],
									"variable": [
										{
											"key": "domain",
											"value": "{{domain}}"
										},
										{
											"key": "flow",
											"value": "scheduled-payments"
										},
										{
											"key": "instance",
											"value": "{{instanceId}}"
										},
										{
											"key": "transition",
											"value": "manual-pay-now"
										}
									]
								}
							},
							"response": []
						}
					]
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:4201/api/v1"
		},
		{
			"key": "requestId",
			"value": ""
		},
		{
			"key": "domain",
			"value": "core"
		},
		{
			"key": "instanceId",
			"value": ""
		},
		{
			"key": "mockoonApi",
			"value": ""
		}
	]
}